<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Guillaume Dueymes">

  
  
  
    
  
  <meta name="description" content="Using country shapefiles to create Netcdf mask In this tutorial, we will use shapefiles to create mask over specific countries.
In order to work with the whole globe, we will use gridded dataset ERA5 meteorological data.
I will present a simple solution based on open-source Python modules:
 - xarray: for manipulating &amp; reading gridded data, and – very important – operate out-of-memory thanks to its dask capabilities- regionmask: to mask a gridded file according to a shapefile- numpy: for simple array manipulations- geopandas: to open shapefiles- matplotlib: for plotting 1- Import librairies and create aliases.">

  
  <link rel="alternate" hreflang="en-us" href="/post/shapefiles_country/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/shapefiles_country/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="GDueymes">
  <meta property="og:url" content="/post/shapefiles_country/">
  <meta property="og:title" content="Mask countries using shapefile | GDueymes">
  <meta property="og:description" content="Using country shapefiles to create Netcdf mask In this tutorial, we will use shapefiles to create mask over specific countries.
In order to work with the whole globe, we will use gridded dataset ERA5 meteorological data.
I will present a simple solution based on open-source Python modules:
 - xarray: for manipulating &amp; reading gridded data, and – very important – operate out-of-memory thanks to its dask capabilities- regionmask: to mask a gridded file according to a shapefile- numpy: for simple array manipulations- geopandas: to open shapefiles- matplotlib: for plotting 1- Import librairies and create aliases."><meta property="og:image" content="/post/shapefiles_country/featured.png">
  <meta property="twitter:image" content="/post/shapefiles_country/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-02-04T10:39:49-08:00">
    
    <meta property="article:modified_time" content="2020-02-04T10:39:49-08:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/shapefiles_country/"
  },
  "headline": "Mask countries using shapefile",
  
  "image": [
    "/post/shapefiles_country/featured.png"
  ],
  
  "datePublished": "2020-02-04T10:39:49-08:00",
  "dateModified": "2020-02-04T10:39:49-08:00",
  
  "author": {
    "@type": "Person",
    "name": "Guillaume Dueymes"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "GDueymes",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "Using country shapefiles to create Netcdf mask In this tutorial, we will use shapefiles to create mask over specific countries.\nIn order to work with the whole globe, we will use gridded dataset ERA5 meteorological data.\nI will present a simple solution based on open-source Python modules:\n - xarray: for manipulating \u0026amp; reading gridded data, and – very important – operate out-of-memory thanks to its dask capabilities\r- regionmask: to mask a gridded file according to a shapefile\r- numpy: for simple array manipulations\r- geopandas: to open shapefiles\r- matplotlib: for plotting\r 1- Import librairies and create aliases."
}
</script>

  

  


  


  





  <title>Mask countries using shapefile | GDueymes</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">GDueymes</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Guillaume_Dueymes2019.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Mask countries using shapefile</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Feb 4, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 376px;">
  <div style="position: relative">
    <img src="/post/shapefiles_country/featured_hu9e7980d23f2b10a6ab10f818bc4b8afd_29496_720x0_resize_lanczos_2.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h3 id="using-country-shapefiles-to-create-netcdf-mask">Using country shapefiles to create Netcdf mask</h3>
<p>In this tutorial, we will use shapefiles to create mask over specific countries.</p>
<p>In order to work with the whole globe, we will use gridded dataset ERA5 meteorological data.</p>
<p>I will present a simple solution based on open-source Python modules:</p>
<pre><code>    - xarray: for manipulating &amp; reading gridded data, and – very important – operate out-of-memory thanks to its dask capabilities
    - regionmask: to mask a gridded file according to a shapefile
    - numpy: for simple array manipulations
    - geopandas: to open shapefiles
    - matplotlib: for plotting
</code></pre>
<h3 id="1---import-librairies-and-create-aliases">1-  Import librairies and create aliases.</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> xarray <span style="color:#f92672">as</span> xr 
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> regionmask
<span style="color:#f92672">import</span> geopandas <span style="color:#f92672">as</span> gpd
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> warnings; warnings<span style="color:#f92672">.</span>filterwarnings(action<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ignore&#39;</span>)
<span style="color:#f92672">%</span>matplotlib inline
</code></pre></div><h3 id="working-over-countries">Working over countries</h3>
<p>In this example we will focus on countries in Africa. We will use <a href="https://community.esri.com/external-link.jspa?url=http%3A%2F%2Fwww.maplibrary.org%2Flibrary%2Fstacks%2FAfrica%2Findex.htm">shapefiles developped in ESRI format</a>.</p>
<p>After downloaded the shapefile, we must load it using geopandas library:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">PATH_TO_SHAPEFILE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;./Countries/Africa_Countries.shp&#39;</span>
countries <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>read_file(PATH_TO_SHAPEFILE)
countries<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="left"></th>
<th align="right">ID</th>
<th align="right">CODE</th>
<th align="right">COUNTRY</th>
<th align="left">geometry</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0</td>
<td align="right">1</td>
<td align="right">ALG</td>
<td align="right">Algeria</td>
<td align="left">POLYGON ((-5.7636199999979 25.58624999999302, &hellip;</td>
</tr>
<tr>
<td align="left">1</td>
<td align="right">2</td>
<td align="right">ANG</td>
<td align="right">Angola</td>
<td align="left">POLYGON ((13.36632442474365 -8.32172966003418,&hellip;</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">countries<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]
</code></pre></div><pre><code>762
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">my_list <span style="color:#f92672">=</span> list(countries[<span style="color:#e6db74">&#39;CODE&#39;</span>])
my_list_unique <span style="color:#f92672">=</span> set(list(countries[<span style="color:#e6db74">&#39;CODE&#39;</span>]))
indexes <span style="color:#f92672">=</span> [my_list<span style="color:#f92672">.</span>index(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> my_list_unique]
</code></pre></div><p>Shapes are here a GeoDataFrame containing all polygons illustrating the countries boundaries.</p>
<p>Now we can load the ERA5 gridded data. The parameter chunks is very important, it defines how big are the “pieces” of data moved from the disk to the memory. With this value the entire computation on a workstation with 32 GB takes a couple of minutes.</p>
<p>We will load all the temperature files for the year 2018 using Xarray library.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ERA5_T2m_1h&#39;</span>
t_in <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;J:/REANALYSES/ERA5/T2m_1h/&#39;</span>        
data <span style="color:#f92672">=</span> t_in <span style="color:#f92672">+</span> model <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;_2018*_sfc.nc&#39;</span>
ds <span style="color:#f92672">=</span> xr<span style="color:#f92672">.</span>open_mfdataset(data, chunks <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;time&#39;</span>: <span style="color:#ae81ff">10</span>})
ds
</code></pre></div><pre><code>&lt;xarray.Dataset&gt;
Dimensions:    (latitude: 721, longitude: 1440, time: 8760)
Coordinates:
  * longitude  (longitude) float32 0.0 0.25 0.5 0.75 ... 359.25 359.5 359.75
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 2018-01-01 ... 2018-12-31T23:00:00
Data variables:
    t2m        (time, latitude, longitude) float32 dask.array&lt;shape=(8760, 721, 1440), chunksize=(10, 721, 1440)&gt;
Attributes:
    Conventions:  CF-1.6
    history:      2019-11-11 13:33:07 GMT by grib_to_netcdf-2.14.0: /opt/ecmw...
</code></pre>
<p>The next function <!-- raw HTML omitted -->assign_coords<!-- raw HTML omitted --> will convert the longitude from the 0-360 range to -180,180</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ds <span style="color:#f92672">=</span> ds<span style="color:#f92672">.</span>assign_coords(longitude<span style="color:#f92672">=</span>(((ds<span style="color:#f92672">.</span>longitude <span style="color:#f92672">+</span> <span style="color:#ae81ff">180</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">360</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">180</span>))<span style="color:#f92672">.</span>sortby(<span style="color:#e6db74">&#39;longitude&#39;</span>)
ds
</code></pre></div><pre><code>&lt;xarray.Dataset&gt;
Dimensions:    (latitude: 721, longitude: 1440, time: 8760)
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.75 -179.5 ... 179.25 179.5 179.75
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 2018-01-01 ... 2018-12-31T23:00:00
Data variables:
    t2m        (time, latitude, longitude) float32 dask.array&lt;shape=(8760, 721, 1440), chunksize=(10, 721, 1440)&gt;
Attributes:
    Conventions:  CF-1.6
    history:      2019-11-11 13:33:07 GMT by grib_to_netcdf-2.14.0: /opt/ecmw...
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">len(list(countries<span style="color:#f92672">.</span>geometry<span style="color:#f92672">.</span>values[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indexes))
len(list(countries<span style="color:#f92672">.</span>COUNTRY[indexes]))
len(indexes)
</code></pre></div><pre><code>52
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>,countries<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>])
np<span style="color:#f92672">.</span>shape(a)
</code></pre></div><pre><code>(762,)
</code></pre>
<p>Our xarray Dataset contains a single variable (t2m) which is stored as a dask.array. This is the result of loading files with open_mfdataset.</p>
<p>Now we will use regionmask module to create a gridded mask with the 
<a href="https://regionmask.readthedocs.io/en/stable/generated/regionmask.Regions_cls.html#regionmask.Regions_cls">function regions_cls</a>.</p>
<p>With this function we will create an object able to mask ERA5 gridded data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">countries_mask_poly <span style="color:#f92672">=</span> regionmask<span style="color:#f92672">.</span>Regions_cls(name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;COUNTRY&#39;</span>, numbers <span style="color:#f92672">=</span> indexes, names <span style="color:#f92672">=</span> countries<span style="color:#f92672">.</span>COUNTRY[indexes], abbrevs <span style="color:#f92672">=</span> countries<span style="color:#f92672">.</span>COUNTRY[indexes], outlines <span style="color:#f92672">=</span> list(countries<span style="color:#f92672">.</span>geometry<span style="color:#f92672">.</span>values[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,countries<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>])))
countries_mask_poly
</code></pre></div><pre><code>52 'COUNTRY' Regions ()
Burkina Faso Senegal Botswana Liberia Chad Equatorial Guinea Djibouti Ghana Nigeria Sao Tome and Principe Swaziland Uganda Tanzania Comoros Guinea Algeria Niger Madagascar Burundi Cameroon Mali Zimbabwe Cote d`Ivoire Tunisia Sierra Leone Libya Rwanda Benin Malawi Gabon South Africa Western Sahara Zambia Central African Republic Togo Namibia Gambia Congo-Brazzaville Democratic Republic of Congo Morocco Eritrea Cape Verde Angola Ethiopia Lesotho Egypt Guinea-Bissau Kenya Mozambique Sudan Mauritania Somalia
</code></pre>
<p>Now we are ready to apply the mask on the gridded dataset xarray ERA5.</p>
<p>We select only the first timestep to speed up the process.</p>
<p>This step could take few minutes because of ERA5 resolution and grid : Dimensions:    (latitude: 721, longitude: 1440)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mask <span style="color:#f92672">=</span> countries_mask_poly<span style="color:#f92672">.</span>mask(ds<span style="color:#f92672">.</span>isel(time <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>), lat_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;latitude&#39;</span>, lon_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;longitude&#39;</span>)
mask
</code></pre></div><pre><code>&lt;xarray.DataArray 'region' (latitude: 721, longitude: 1440)&gt;
array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])
Coordinates:
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * longitude  (longitude) float32 -180.0 -179.75 -179.5 ... 179.25 179.5 179.75
</code></pre>
<p>Mask can be saved (for example as a NetCDF) for a later use.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mask<span style="color:#f92672">.</span>to_netcdf(<span style="color:#e6db74">&#39;./mask_Africa_by_countries.nc&#39;</span>) 
</code></pre></div><p>We can use  <a href="https://www.giss.nasa.gov/tools/panoply/">Panoply</a> free software to plot our netcdf file.</p>
<p>Here&rsquo;s a quick visualisation using Matplotlib:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">8</span>))
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
mask<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax)
countries<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>, facecolor <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span>, lw <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0xbdf0d68&gt;
</code></pre>
<p><img src="./output1.png" alt="png"></p>
<p>Let&rsquo;s now extract one specific country from our mask. We will for example extract informations only over Algeria.
Remember, index for Algeria is: 0  .</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">mask_algeria <span style="color:#f92672">=</span> mask<span style="color:#f92672">.</span>where(mask <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> )
mask_algeria<span style="color:#f92672">.</span>to_netcdf(<span style="color:#e6db74">&#39;./mask_Algeria.nc&#39;</span>) 

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">8</span>))
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
mask_algeria<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax)
countries<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>, facecolor <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span>, lw <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7528278&gt;
</code></pre>
<p><img src="./output2.png" alt="png"></p>
<h3 id="2--extract-time-series">2- Extract time-series</h3>
<p>We can now for each country aggregate the grid cells in the national borders. 
We will first develop two methods to mask our area. Then, we will extract the time series.</p>
<h3 id="--method-1">- Method 1:</h3>
<p>I will focus on Algeria.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ID_COUNTRY <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">print</span>(countries<span style="color:#f92672">.</span>COUNTRY[ID_COUNTRY])
</code></pre></div><pre><code>Algeria
</code></pre>
<p>As first step, I will save the latitude and longitude vectors because I will use it later. Then, I select the mask points where the value is equal to target value (the ID_COUNTRY code). In the numpy array sel_mask all the values are nan except for the selected ones.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">lat <span style="color:#f92672">=</span> mask<span style="color:#f92672">.</span>latitude<span style="color:#f92672">.</span>values
lon <span style="color:#f92672">=</span> mask<span style="color:#f92672">.</span>longitude<span style="color:#f92672">.</span>values

sel_mask <span style="color:#f92672">=</span> mask<span style="color:#f92672">.</span>where(mask <span style="color:#f92672">==</span> ID_COUNTRY)<span style="color:#f92672">.</span>values
sel_mask
</code></pre></div><pre><code>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])
</code></pre>
<p>To speed-up the process I want to crop the xarray Dataset selecting the smallest box containing the entire mask. To do this I store in id_lon and id_lat the coordinate points where the mask has at least a non-nan value.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">id_lon <span style="color:#f92672">=</span> lon[np<span style="color:#f92672">.</span>where(<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>all(np<span style="color:#f92672">.</span>isnan(sel_mask), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))]
id_lat <span style="color:#f92672">=</span> lat[np<span style="color:#f92672">.</span>where(<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>all(np<span style="color:#f92672">.</span>isnan(sel_mask), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))]
id_lat
</code></pre></div><pre><code>array([37.  , 36.75, 36.5 , 36.25, 36.  , 35.75, 35.5 , 35.25, 35.  ,
       34.75, 34.5 , 34.25, 34.  , 33.75, 33.5 , 33.25, 33.  , 32.75,
       32.5 , 32.25, 32.  , 31.75, 31.5 , 31.25, 31.  , 30.75, 30.5 ,
       30.25, 30.  , 29.75, 29.5 , 29.25, 29.  , 28.75, 28.5 , 28.25,
       28.  , 27.75, 27.5 , 27.25, 27.  , 26.75, 26.5 , 26.25, 26.  ,
       25.75, 25.5 , 25.25, 25.  , 24.75, 24.5 , 24.25, 24.  , 23.75,
       23.5 , 23.25, 23.  , 22.75, 22.5 , 22.25, 22.  , 21.75, 21.5 ,
       21.25, 21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25,
       19.  ], dtype=float32)
</code></pre>
<p>The Xarray dataset is reduced selecting only the target year and the coordinates containing the target region. Then the dataset is load from the dask array using compute and then filtered using the mask.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">out_sel1 <span style="color:#f92672">=</span> ds<span style="color:#f92672">.</span>sel(latitude <span style="color:#f92672">=</span> slice(id_lat[<span style="color:#ae81ff">0</span>], id_lat[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]), longitude <span style="color:#f92672">=</span> slice(id_lon[<span style="color:#ae81ff">0</span>], id_lon[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]))<span style="color:#f92672">.</span>compute()<span style="color:#f92672">.</span>where(mask <span style="color:#f92672">==</span> ID_COUNTRY)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">out_sel1
</code></pre></div><pre><code>&lt;xarray.Dataset&gt;
Dimensions:    (latitude: 73, longitude: 82, time: 8760)
Coordinates:
  * latitude   (latitude) float64 37.0 36.75 36.5 36.25 ... 19.5 19.25 19.0
  * longitude  (longitude) float64 -8.5 -8.25 -8.0 -7.75 ... 11.25 11.5 11.75
  * time       (time) datetime64[ns] 2018-01-01 ... 2018-12-31T23:00:00
Data variables:
    t2m        (time, latitude, longitude) float32 nan nan nan ... nan nan nan
Attributes:
    Conventions:  CF-1.6
    history:      2019-11-11 13:33:07 GMT by grib_to_netcdf-2.14.0: /opt/ecmw...
</code></pre>
<h3 id="--method-2">- Method 2:</h3>
<p>We can directly use xarray library to apply netcdf mask with using .where() method and DataArray mask:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">out_sel2 <span style="color:#f92672">=</span> ds<span style="color:#f92672">.</span>where(mask <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">out_sel2
</code></pre></div><pre><code>&lt;xarray.Dataset&gt;
Dimensions:    (latitude: 721, longitude: 1440, time: 8760)
Coordinates:
  * longitude  (longitude) float32 -180.0 -179.75 -179.5 ... 179.25 179.5 179.75
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * time       (time) datetime64[ns] 2018-01-01 ... 2018-12-31T23:00:00
Data variables:
    t2m        (time, latitude, longitude) float32 dask.array&lt;shape=(8760, 721, 1440), chunksize=(10, 721, 1440)&gt;
Attributes:
    Conventions:  CF-1.6
    history:      2019-11-11 13:33:07 GMT by grib_to_netcdf-2.14.0: /opt/ecmw...
</code></pre>
<p>Quick visualisation, we will display the first step of our DataArray masked.</p>
<p>For out_sel2 array :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
out_sel2<span style="color:#f92672">.</span>t2m<span style="color:#f92672">.</span>isel(time <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax)
countries<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>, facecolor <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span>)
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0xe73e550&gt;
</code></pre>
<p><img src="./output3.png" alt="png"></p>
<p>For out_sel1 array :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">8</span>))
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
out_sel1<span style="color:#f92672">.</span>t2m<span style="color:#f92672">.</span>isel(time <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax)
countries<span style="color:#f92672">.</span>plot(ax <span style="color:#f92672">=</span> ax, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>, facecolor <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span>)
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0xe8024a8&gt;
</code></pre>
<p><img src="./output4.png" alt="png"></p>
<p>Finally we can aggregate by the arithmetic mean using the groupby function to obtain a time-series of national average temperatures.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> out_sel1<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;time&#39;</span>)<span style="color:#f92672">.</span>mean()
x
</code></pre></div><pre><code>&lt;xarray.Dataset&gt;
Dimensions:  (time: 8760)
Coordinates:
  * time     (time) datetime64[ns] 2018-01-01 ... 2018-12-31T23:00:00
Data variables:
    t2m      (time) float32 285.01346 284.65833 283.95526 ... 282.03668 281.461
</code></pre>
<p>Then we plot the time-series…</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x<span style="color:#f92672">.</span>t2m<span style="color:#f92672">.</span>plot()
</code></pre></div><pre><code>[&lt;matplotlib.lines.Line2D at 0xe9dc518&gt;]
</code></pre>
<p><img src="./output5.png" alt="png"></p>
<ul>
<li>Let&rsquo;s resample our dataset by day and then compute a daily mean.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> out_sel1<span style="color:#f92672">.</span>resample(time <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1D&#39;</span>)<span style="color:#f92672">.</span>mean()<span style="color:#f92672">-</span><span style="color:#ae81ff">273.15</span>
x
</code></pre></div><pre><code>&lt;xarray.Dataset&gt;
Dimensions:    (latitude: 73, longitude: 82, time: 365)
Coordinates:
  * longitude  (longitude) float64 -8.5 -8.25 -8.0 -7.75 ... 11.25 11.5 11.75
  * latitude   (latitude) float64 37.0 36.75 36.5 36.25 ... 19.5 19.25 19.0
  * time       (time) datetime64[ns] 2018-01-01 2018-01-02 ... 2018-12-31
Data variables:
    t2m        (time, latitude, longitude) float32 nan nan nan ... nan nan nan
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_mean <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>t2m<span style="color:#f92672">.</span>mean(dim<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#39;longitude&#39;</span>,<span style="color:#e6db74">&#39;latitude&#39;</span>))
daily_mean
</code></pre></div><pre><code>&lt;xarray.DataArray 't2m' (time: 365)&gt;
array([14.550091, 13.812102, 13.700798, ..., 10.975014, 11.182918, 10.956429],
      dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 2018-01-01 2018-01-02 ... 2018-12-31
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_mean<span style="color:#f92672">.</span>plot()
</code></pre></div><pre><code>[&lt;matplotlib.lines.Line2D at 0xe243f98&gt;]
</code></pre>
<p><img src="./output6.png" alt="png"></p>
<p>And we save it as a csv</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">daily_mean<span style="color:#f92672">.</span>to_pandas()<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#39;average-temperature-algeria.csv&#39;</span>, header <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;t2m&#39;</span>])
</code></pre></div><h3 id="2--extract-time-series-for-one-specific-localisation">2- Extract time-series for one specific localisation</h3>
<p>In this example, we eant to extract time-series for Alger:</p>
<p>With:
- longitude = 3.04
- latitude = 36.75</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">lati <span style="color:#f92672">=</span> <span style="color:#ae81ff">36.75</span>
loni <span style="color:#f92672">=</span> <span style="color:#ae81ff">3.04</span>
data  <span style="color:#f92672">=</span> out_sel1<span style="color:#f92672">.</span>sel(longitude<span style="color:#f92672">=</span>loni  , latitude<span style="color:#f92672">=</span>lati  , method<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nearest&#39;</span>) 
data<span style="color:#f92672">.</span>t2m
</code></pre></div><pre><code>&lt;xarray.DataArray 't2m' (time: 8760)&gt;
array([289.91342, 289.63348, 289.2745 , ..., 285.62613, 284.9182 , 284.80624],
      dtype=float32)
Coordinates:
    latitude   float64 36.75
    longitude  float64 3.0
  * time       (time) datetime64[ns] 2018-01-01 ... 2018-12-31T23:00:00
Attributes:
    units:      K
    long_name:  2 metre temperature
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data[<span style="color:#e6db74">&#39;t2m&#39;</span>] <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;t2m&#39;</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">273.15</span>
df <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>t2m<span style="color:#f92672">.</span>to_dataframe()
fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">8</span>))
df[<span style="color:#e6db74">&#39;t2m&#39;</span>]<span style="color:#f92672">.</span>plot()
</code></pre></div><pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x20773fd0&gt;
</code></pre>
<p><img src="./output7.png" alt="png"></p>
<p>Let&rsquo;s plot montlhy temperature distribution for Alger:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;month&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#34;%b&#34;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="left">time</th>
<th align="right">latitude</th>
<th align="right">longitude</th>
<th align="right">t2m</th>
<th align="left">month</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">2018-01-01 00:00:00</td>
<td align="right">36.75</td>
<td align="right">3</td>
<td align="right">16.7634</td>
<td align="left">Jan</td>
</tr>
<tr>
<td align="left">2018-01-01 01:00:00</td>
<td align="right">36.75</td>
<td align="right">3</td>
<td align="right">16.4835</td>
<td align="left">Jan</td>
</tr>
<tr>
<td align="left">2018-01-01 02:00:00</td>
<td align="right">36.75</td>
<td align="right">3</td>
<td align="right">16.1245</td>
<td align="left">Jan</td>
</tr>
<tr>
<td align="left">2018-01-01 03:00:00</td>
<td align="right">36.75</td>
<td align="right">3</td>
<td align="right">16.197</td>
<td align="left">Jan</td>
</tr>
<tr>
<td align="left">2018-01-01 04:00:00</td>
<td align="right">36.75</td>
<td align="right">3</td>
<td align="right">16.0389</td>
<td align="left">Jan</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
sns<span style="color:#f92672">.</span>boxplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;month&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;t2m&#34;</span>, data<span style="color:#f92672">=</span>df, palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Set1&#34;</span>)  
figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>) 
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="./output8.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div>
    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/shapefiles_country/&amp;text=Mask%20countries%20using%20shapefile" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/shapefiles_country/&amp;t=Mask%20countries%20using%20shapefile" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Mask%20countries%20using%20shapefile&amp;body=/post/shapefiles_country/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/shapefiles_country/&amp;title=Mask%20countries%20using%20shapefile" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Mask%20countries%20using%20shapefile%20/post/shapefiles_country/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/shapefiles_country/&amp;title=Mask%20countries%20using%20shapefile" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hued2496a182fbb6fc8c711157078d29a6_5348924_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Guillaume Dueymes</a></h5>
      <h6 class="card-subtitle">Data Scientist and Research Assistant</h6>
      <p class="card-text">My research interests include data science, data management and climate science.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Guillaume_Dueymes" target="_blank" rel="noopener">
        <i class="fab fa-researchgate"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/guimeto" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
