<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Guillaume Dueymes">

  
  
  
    
  
  <meta name="description" content="Courte analyse sur DAYMET / ANUSPLIN et une station d&#39;ECCC Objectifs:
- Travail sur les données ANUSPLIN et Daymet pour les années 2000 à 2010 (précipitation totale) autour des latitudes 50,66°N et 71,25°W  On importe les librairies et on définit nos conditions initiales.
from netCDF4 import Dataset,num2date import numpy as np import pandas as pd import datetime from datetime import date, timedelta from dateutil.relativedelta import relativedelta import Indices_Precipitation from codes_station import get_closed_station_precip as get_Stat import plot_grids import matplotlib.">

  
  <link rel="alternate" hreflang="en-us" href="/post/tuto/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/tuto/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="GDueymes">
  <meta property="og:url" content="/post/tuto/">
  <meta property="og:title" content="ANUSPLIN | GDueymes">
  <meta property="og:description" content="Courte analyse sur DAYMET / ANUSPLIN et une station d&#39;ECCC Objectifs:
- Travail sur les données ANUSPLIN et Daymet pour les années 2000 à 2010 (précipitation totale) autour des latitudes 50,66°N et 71,25°W  On importe les librairies et on définit nos conditions initiales.
from netCDF4 import Dataset,num2date import numpy as np import pandas as pd import datetime from datetime import date, timedelta from dateutil.relativedelta import relativedelta import Indices_Precipitation from codes_station import get_closed_station_precip as get_Stat import plot_grids import matplotlib."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-12-01T16:44:51-08:00">
    
    <meta property="article:modified_time" content="2019-12-01T16:44:51-08:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/tuto/"
  },
  "headline": "ANUSPLIN",
  
  "datePublished": "2019-12-01T16:44:51-08:00",
  "dateModified": "2019-12-01T16:44:51-08:00",
  
  "author": {
    "@type": "Person",
    "name": "Guillaume Dueymes"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "GDueymes",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "Courte analyse sur DAYMET / ANUSPLIN et une station d'ECCC Objectifs:\n- Travail sur les données ANUSPLIN et Daymet pour les années 2000 à 2010 (précipitation totale) autour des latitudes 50,66°N et 71,25°W  On importe les librairies et on définit nos conditions initiales.\nfrom netCDF4 import Dataset,num2date import numpy as np import pandas as pd import datetime from datetime import date, timedelta from dateutil.relativedelta import relativedelta import Indices_Precipitation from codes_station import get_closed_station_precip as get_Stat import plot_grids import matplotlib."
}
</script>

  

  


  


  





  <title>ANUSPLIN | GDueymes</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">GDueymes</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Guillaume_Dueymes2019.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>ANUSPLIN</h1>

  
  <p class="page-subtitle">blablabla</p>
  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Dec 1, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="courte-analyse-sur-daymet--anusplin-et-une-station-deccc">Courte analyse sur DAYMET / ANUSPLIN et une station d'ECCC</h2>
<p>Objectifs:</p>
<pre><code>- Travail sur les données ANUSPLIN et Daymet pour les années 2000 à 2010 (précipitation totale) autour des latitudes 50,66°N et 71,25°W 
</code></pre>
<p>On importe les librairies et on définit nos conditions initiales.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> netCDF4 <span style="color:#f92672">import</span> Dataset,num2date
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> datetime
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> date, timedelta
<span style="color:#f92672">from</span> dateutil.relativedelta <span style="color:#f92672">import</span> relativedelta
<span style="color:#f92672">import</span> Indices_Precipitation
<span style="color:#f92672">from</span> codes_station <span style="color:#f92672">import</span> get_closed_station_precip <span style="color:#66d9ef">as</span> get_Stat
<span style="color:#f92672">import</span> plot_grids
<span style="color:#f92672">import</span> matplotlib.pylab <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> warnings; warnings<span style="color:#f92672">.</span>filterwarnings(action<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">once</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> gridspec
<span style="color:#f92672">import</span> warnings
warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">ignore</span><span style="color:#e6db74">&#34;</span>)

rep_anus <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">J:/DONNEES_AMERIQUE_DU_NORD/ANUSPLIN_10km/Netcdf/all_domaine/Daily/</span><span style="color:#e6db74">&#39;</span>
rep_daymet <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">K:/PROJETS/PROJET_NAWRES/DAYMET_full_BOX/</span><span style="color:#e6db74">&#39;</span>
rep_station <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">K:/PROJETS/PROJET_NAWRES/DAYMET_full_BOX/</span><span style="color:#e6db74">&#39;</span>

yeari<span style="color:#f92672">=</span><span style="color:#ae81ff">1980</span>
monthi<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
yearf <span style="color:#f92672">=</span> <span style="color:#ae81ff">2017</span>
monthf <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>
lati <span style="color:#f92672">=</span> <span style="color:#ae81ff">50.66</span>
loni <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">71.25</span>
</code></pre></div><p>Les fonctions suivantes nous permettrons d'extraire le point de grille le plus proche d'un fichier Netcdf et d'incrémenter sur les mois.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getclosest_ij</span>(lats,lons,latpt,lonpt):
     <span style="color:#75715e"># find squared distance of every point on grid</span>
     dist_sq <span style="color:#f92672">=</span> (lats<span style="color:#f92672">-</span>latpt)<span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> (lons<span style="color:#f92672">-</span>lonpt)<span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> 
     <span style="color:#75715e"># 1D index of minimum dist_sq element</span>
     minindex_flattened <span style="color:#f92672">=</span> dist_sq<span style="color:#f92672">.</span>argmin()
     <span style="color:#75715e"># Get 2D index for latvals and lonvals arrays from 1D index</span>
     <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>unravel_index(minindex_flattened, lats<span style="color:#f92672">.</span>shape)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_month</span>(now):
    <span style="color:#66d9ef">try</span>:
        then <span style="color:#f92672">=</span> (now <span style="color:#f92672">+</span> relativedelta(months<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">.</span>replace(day<span style="color:#f92672">=</span>now<span style="color:#f92672">.</span>day)
    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ValueError</span>:
        then <span style="color:#f92672">=</span> (now <span style="color:#f92672">+</span> relativedelta(months<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>))<span style="color:#f92672">.</span>replace(day<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">return</span> then

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">day_start<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
day_end <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{}-{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(yearf, monthf), periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>day<span style="color:#f92672">.</span>tolist()[<span style="color:#ae81ff">0</span>]
start<span style="color:#f92672">=</span>datetime<span style="color:#f92672">.</span>datetime(yeari,monthi,day_start)
end<span style="color:#f92672">=</span>datetime<span style="color:#f92672">.</span>datetime(yearf,monthf,day_end)
d0 <span style="color:#f92672">=</span> date(yeari, monthi, day_start)
d1 <span style="color:#f92672">=</span> date(yearf, monthf, day_end)
delta <span style="color:#f92672">=</span> d1 <span style="color:#f92672">-</span> d0
nb_days <span style="color:#f92672">=</span> delta<span style="color:#f92672">.</span>days<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</code></pre></div><p>On travaille sur les points de grille d'ANUSPLIN.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Début de notre boucle temporelle sur anusplin</span>
i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
IND <span style="color:#f92672">=</span> []
incr<span style="color:#f92672">=</span>start
<span style="color:#66d9ef">while</span> incr <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> end:
    filename<span style="color:#f92672">=</span> rep_anus <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ANUSPLIN_10km_preacc_</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> str(incr<span style="color:#f92672">.</span>year) <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_{:02d}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(incr<span style="color:#f92672">.</span>month) <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.nc</span><span style="color:#e6db74">&#39;</span>   
    f <span style="color:#f92672">=</span> Dataset(filename)
   <span style="color:#75715e"># print(f.variables.keys()) # get all variable names</span>
    var <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>variables[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">daily_precipitation_accumulation</span><span style="color:#e6db74">&#39;</span>] 
    <span style="color:#75715e">#print(temp) </span>
    <span style="color:#75715e">#temp.dimensions</span>
    <span style="color:#75715e">#temp.shape</span>
    lat, lon <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>variables[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">latitude</span><span style="color:#e6db74">&#39;</span>], f<span style="color:#f92672">.</span>variables[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">longitude</span><span style="color:#e6db74">&#39;</span>]
    <span style="color:#75715e">#print(lat)</span>
    <span style="color:#75715e">#print(lon)</span>
    <span style="color:#75715e">#print(lat[:])</span>
    <span style="color:#75715e"># extract lat/lon values (in degrees) to numpy arrays</span>
    latvals <span style="color:#f92672">=</span> lat[:]; lonvals <span style="color:#f92672">=</span> lon[:] 
    <span style="color:#75715e"># a function to find the index of the point closest pt</span>
    <span style="color:#75715e"># (in squared distance) to give lat/lon value.    </span>
    iy_min, ix_min <span style="color:#f92672">=</span> getclosest_ij(latvals, lonvals, lati, loni)
    <span style="color:#75715e">#print(iy_min)</span>
    <span style="color:#75715e">#print(ix_min)</span>
    IND<span style="color:#f92672">.</span>append(var[:,iy_min,ix_min])
    lat_a, lon_a <span style="color:#f92672">=</span> float(lat[iy_min,ix_min]), float(lon[iy_min,ix_min])
    incr<span style="color:#f92672">=</span>add_month(incr)
    
flattened_list <span style="color:#f92672">=</span> []    
flattened_list <span style="color:#f92672">=</span> [y <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> IND <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> x]
start<span style="color:#f92672">=</span>datetime<span style="color:#f92672">.</span>datetime(yeari,monthi,day_start)
TIME<span style="color:#f92672">=</span>[]
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,nb_days,<span style="color:#ae81ff">1</span>): 
 <span style="color:#75715e">#   TIME.append((start+timedelta(days=i)).strftime(&#34;%Y-%m-%d&#34;))</span>
    TIME<span style="color:#f92672">.</span>append((start<span style="color:#f92672">+</span>timedelta(days<span style="color:#f92672">=</span>i)))
dataFrame_ANUSPLIN <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>: TIME, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Preacc</span><span style="color:#e6db74">&#39;</span>: flattened_list}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Preacc</span><span style="color:#e6db74">&#39;</span>]) 
dataFrame_ANUSPLIN <span style="color:#f92672">=</span> dataFrame_ANUSPLIN<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>)  
</code></pre></div><p>On fait de même sur les données de DAYMET.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Début de notre boucle temporelle sur daymet</span>
i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
IND <span style="color:#f92672">=</span> []
TIME<span style="color:#f92672">=</span>[]
<span style="color:#66d9ef">for</span> year <span style="color:#f92672">in</span> range(yeari,yearf<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
    
    filename<span style="color:#f92672">=</span> rep_daymet <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">prcp_</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> str(year) <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_DAYMET_subset.nc4</span><span style="color:#e6db74">&#39;</span> 
    f <span style="color:#f92672">=</span> Dataset(filename)
   <span style="color:#75715e"># print(f.variables.keys()) # get all variable names</span>
    var <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>variables[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">prcp</span><span style="color:#e6db74">&#39;</span>] 
    <span style="color:#75715e">#var.dimensions</span>
    <span style="color:#75715e">#var.shape</span>
    lat, lon <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>variables[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">lat</span><span style="color:#e6db74">&#39;</span>], f<span style="color:#f92672">.</span>variables[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">lon</span><span style="color:#e6db74">&#39;</span>]
    <span style="color:#75715e">#print(lat)</span>
    <span style="color:#75715e">#print(lon)</span>
    <span style="color:#75715e">#print(lat[:])</span>
    <span style="color:#75715e"># extract lat/lon values (in degrees) to numpy arrays</span>
    latvals <span style="color:#f92672">=</span> lat[:]; lonvals <span style="color:#f92672">=</span> lon[:] 
    <span style="color:#75715e"># a function to find the index of the point closest pt</span>
    <span style="color:#75715e"># (in squared distance) to give lat/lon value.    </span>
    iy_min, ix_min <span style="color:#f92672">=</span> getclosest_ij(latvals, lonvals, lati, loni)
    lat_d, lon_d <span style="color:#f92672">=</span> float(lat[iy_min,ix_min]), float(lon[iy_min,ix_min])
    
    <span style="color:#75715e">#print(iy_min)</span>
    <span style="color:#75715e">#print(ix_min)</span>
    IND<span style="color:#f92672">.</span>append(var[:,iy_min,ix_min])
    nctime <span style="color:#f92672">=</span> f[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">time</span><span style="color:#e6db74">&#39;</span>]
    test <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DateTime</span><span style="color:#e6db74">&#39;</span>: num2date(nctime[:], nctime<span style="color:#f92672">.</span>units, nctime<span style="color:#f92672">.</span>calendar)})
    test <span style="color:#f92672">=</span> test[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DateTime</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>mask(test[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DateTime</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year <span style="color:#f92672">==</span> <span style="color:#ae81ff">2011</span>, 
                             test[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DateTime</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">+</span> pd<span style="color:#f92672">.</span>offsets<span style="color:#f92672">.</span>DateOffset(year<span style="color:#f92672">=</span>year))        
    TIME<span style="color:#f92672">.</span>append(test)
    
    
flattened_list <span style="color:#f92672">=</span> []    
flattened_list <span style="color:#f92672">=</span> [y <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> IND <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> x]
flattened_time <span style="color:#f92672">=</span> []    
flattened_time <span style="color:#f92672">=</span> [y <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> TIME <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> x]

dataFrame_DAYMET <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>: flattened_time, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Preacc</span><span style="color:#e6db74">&#39;</span>: flattened_list}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Preacc</span><span style="color:#e6db74">&#39;</span>]) 
dataFrame_DAYMET <span style="color:#f92672">=</span> dataFrame_DAYMET<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>)  
</code></pre></div><p>On va chercher la station d'ECCC la plus proche et extraire les données en utilisant la fonction get_closed_station_precip.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Données de la station la plus proche </span>

dataFrame_STATION, df_station <span style="color:#f92672">=</span> get_Stat(lati, loni, yeari, yearf)
</code></pre></div><p>Visualisation des sites:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">####################</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">La station suivant sera extraire: </span><span style="color:#e6db74">&#34;</span>)
<span style="color:#66d9ef">print</span>(df_station)
lat_s <span style="color:#f92672">=</span> float(df_station<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">7</span>]<span style="color:#f92672">.</span>values)
lon_s <span style="color:#f92672">=</span> float(df_station<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">8</span>]<span style="color:#f92672">.</span>values)
dataFrame_STATION <span style="color:#f92672">=</span> dataFrame_STATION<span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">variable</span><span style="color:#e6db74">&#39;</span>] 

grids_lat <span style="color:#f92672">=</span> []
grids_lon <span style="color:#f92672">=</span> []
grids_name <span style="color:#f92672">=</span> []
grids_lat<span style="color:#f92672">.</span>append(lati)
grids_lat<span style="color:#f92672">.</span>append(lat_a)
grids_lat<span style="color:#f92672">.</span>append(lat_d)
grids_lat<span style="color:#f92672">.</span>append(lat_s)

grids_lon<span style="color:#f92672">.</span>append(loni)
grids_lon<span style="color:#f92672">.</span>append(lon_a)
grids_lon<span style="color:#f92672">.</span>append(lon_d)
grids_lon<span style="color:#f92672">.</span>append(lon_s)

grids_name<span style="color:#f92672">.</span>append(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Point référence</span><span style="color:#e6db74">&#39;</span>)
grids_name<span style="color:#f92672">.</span>append(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Anusplin10km</span><span style="color:#e6db74">&#39;</span>)
grids_name<span style="color:#f92672">.</span>append(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Daymet</span><span style="color:#e6db74">&#39;</span>)
grids_name<span style="color:#f92672">.</span>append(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Station</span><span style="color:#e6db74">&#39;</span>)

plot_grids<span style="color:#f92672">.</span>plot_closed_points(grids_lat, grids_lon, grids_name, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Precipitation</span><span style="color:#e6db74">&#39;</span>)
</code></pre></div><pre><code>####################
La station suivant sera extraire: 
                                     64
Prov                                 QC
nom de la station           BAGOTVILLE 
stnid              7060400             
année déb.                         1876
mois déb.                             1
année fin.                         2017
mois fin.                            12
lat (deg)                       48.3333
long (deg)                          -71
élév (m)                            159
stns jointes                        Yes
50.66
-71.25
50.625
-71.20833587646484
50.66544723510742
-71.25354766845703
48.333333333333336
-71.0
</code></pre>
<p><img src="./Analyse_12_1.png" alt="png"></p>
<p>On va calculer les indices de précipitation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#################################### Calcul des indices mensuels     </span>
resamp_preacc_A <span style="color:#f92672">=</span> dataFrame_ANUSPLIN<span style="color:#f92672">.</span>resample(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>agg([Indices_Precipitation<span style="color:#f92672">.</span>PrecTOT, Indices_Precipitation<span style="color:#f92672">.</span>MOY])   
resamp_preacc_A <span style="color:#f92672">=</span> resamp_preacc_A<span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Preacc</span><span style="color:#e6db74">&#39;</span>] 
resamp_preacc_A<span style="color:#f92672">.</span>head()

resamp_preacc_D <span style="color:#f92672">=</span> dataFrame_DAYMET<span style="color:#f92672">.</span>resample(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>agg([Indices_Precipitation<span style="color:#f92672">.</span>PrecTOT, Indices_Precipitation<span style="color:#f92672">.</span>MOY])   
resamp_preacc_D <span style="color:#f92672">=</span> resamp_preacc_D<span style="color:#f92672">.</span>loc[:,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Preacc</span><span style="color:#e6db74">&#39;</span>] 
resamp_preacc_D<span style="color:#f92672">.</span>head()

resamp_preacc_S <span style="color:#f92672">=</span> dataFrame_STATION<span style="color:#f92672">.</span>resample(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>agg([Indices_Precipitation<span style="color:#f92672">.</span>PrecTOT, Indices_Precipitation<span style="color:#f92672">.</span>MOY])   
resamp_preacc_S<span style="color:#f92672">.</span>head()
<span style="color:#75715e">#################################### Calcul des indices annuels   </span>
TIME<span style="color:#f92672">=</span>[]
<span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(yeari,yearf<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>):
    TIME<span style="color:#f92672">.</span>append(y)
    
annual1 <span style="color:#f92672">=</span> []
annual2 <span style="color:#f92672">=</span> []
df_annual_A <span style="color:#f92672">=</span> []
incr<span style="color:#f92672">=</span> date(yeari, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
end <span style="color:#f92672">=</span> date(yearf, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
<span style="color:#66d9ef">while</span> incr <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> end:
     current_year <span style="color:#f92672">=</span> str(incr<span style="color:#f92672">.</span>year)
     annual1<span style="color:#f92672">.</span>append(Indices_Precipitation<span style="color:#f92672">.</span>PrecTOT(dataFrame_ANUSPLIN[current_year]<span style="color:#f92672">.</span>values))  
     annual2<span style="color:#f92672">.</span>append(Indices_Precipitation<span style="color:#f92672">.</span>MOY(dataFrame_ANUSPLIN[current_year]<span style="color:#f92672">.</span>values))    
     incr <span style="color:#f92672">=</span> incr <span style="color:#f92672">+</span> relativedelta(years<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
               
df_annual_A <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>: TIME,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>: annual1, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>: annual2}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>]) 
df_annual_A<span style="color:#f92672">.</span>head()

annual1 <span style="color:#f92672">=</span> []
annual2 <span style="color:#f92672">=</span> []
df_annual_D <span style="color:#f92672">=</span> []
incr<span style="color:#f92672">=</span> date(yeari, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
end <span style="color:#f92672">=</span> date(yearf, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
<span style="color:#66d9ef">while</span> incr <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> end:
     current_year <span style="color:#f92672">=</span> str(incr<span style="color:#f92672">.</span>year)
     annual1<span style="color:#f92672">.</span>append(Indices_Precipitation<span style="color:#f92672">.</span>PrecTOT(dataFrame_DAYMET[current_year]<span style="color:#f92672">.</span>values))  
     annual2<span style="color:#f92672">.</span>append(Indices_Precipitation<span style="color:#f92672">.</span>MOY(dataFrame_DAYMET[current_year]<span style="color:#f92672">.</span>values))    
     incr <span style="color:#f92672">=</span> incr <span style="color:#f92672">+</span> relativedelta(years<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
               
df_annual_D <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>: TIME,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>: annual1, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>: annual2}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>]) 
df_annual_D<span style="color:#f92672">.</span>head()

annual1 <span style="color:#f92672">=</span> []
annual2 <span style="color:#f92672">=</span> []
df_annual_S <span style="color:#f92672">=</span> []
incr<span style="color:#f92672">=</span> date(yeari, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
end <span style="color:#f92672">=</span> date(yearf, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
<span style="color:#66d9ef">while</span> incr <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> end:
     current_year <span style="color:#f92672">=</span> str(incr<span style="color:#f92672">.</span>year)
     annual1<span style="color:#f92672">.</span>append(Indices_Precipitation<span style="color:#f92672">.</span>PrecTOT(dataFrame_STATION[current_year]<span style="color:#f92672">.</span>values))  
     annual2<span style="color:#f92672">.</span>append(Indices_Precipitation<span style="color:#f92672">.</span>MOY(dataFrame_STATION[current_year]<span style="color:#f92672">.</span>values))    
     incr <span style="color:#f92672">=</span> incr <span style="color:#f92672">+</span> relativedelta(years<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
               
df_annual_S <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>: TIME,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>: annual1, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>: annual2}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>]) 
df_annual_S<span style="color:#f92672">.</span>head()



</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>On peut maintenant visualiser nos résultats.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#################################### tracé des séries temporelles</span>

color <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">blue</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">red</span><span style="color:#e6db74">&#39;</span>]
fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>)) 
gs <span style="color:#f92672">=</span> gridspec<span style="color:#f92672">.</span>GridSpec(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, width_ratios<span style="color:#f92672">=</span>[<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>]) 
gs<span style="color:#f92672">.</span>update( wspace<span style="color:#f92672">=</span><span style="color:#ae81ff">0.04</span>)
ax1 <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot(gs[<span style="color:#ae81ff">0</span>])

plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">figure.figsize</span><span style="color:#e6db74">&#34;</span>]<span style="color:#f92672">=</span>[<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">9</span>]       <span style="color:#75715e">#  </span>
plt<span style="color:#f92672">.</span>plot(df_annual_A[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>values, df_annual_A[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>][:],  label<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ANUSPLIN</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span>color[<span style="color:#ae81ff">0</span>])
plt<span style="color:#f92672">.</span>plot(df_annual_D[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>values, df_annual_D[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>][:],  label<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DAYMET</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span>color[<span style="color:#ae81ff">1</span>])
plt<span style="color:#f92672">.</span>plot(df_annual_S[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>values, df_annual_S[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual PrecTOT</span><span style="color:#e6db74">&#39;</span>][:],  label<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Station ECCC</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span>color[<span style="color:#ae81ff">2</span>])

ax1<span style="color:#f92672">.</span>grid(axis <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">x</span><span style="color:#e6db74">&#34;</span>, linestyle <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">--</span><span style="color:#e6db74">&#34;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
ax1<span style="color:#f92672">.</span>grid(axis <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">y</span><span style="color:#e6db74">&#34;</span>, linestyle <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">--</span><span style="color:#e6db74">&#34;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)

plt<span style="color:#f92672">.</span>setp(plt<span style="color:#f92672">.</span>gca()<span style="color:#f92672">.</span>get_xticklabels(), rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>, ha<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">right</span><span style="color:#e6db74">&#34;</span>)

plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">mm</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual total precipitation: lat = 50.66N , lon = 71.25 W</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
 
ax1<span style="color:#f92672">.</span>set_facecolor(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">white</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>yticks( fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
plt<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">upper left</span><span style="color:#e6db74">&#39;</span>, ncol<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),fontsize <span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Annual_precipitation_Time_serie_</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>str(yeari)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">-</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>str(yearf)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">.png</span><span style="color:#e6db74">&#34;</span>, dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>, bbox_inches<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tight</span><span style="color:#e6db74">&#39;</span>)   <span style="color:#75715e"># bbox_inches= : option qui permet de propostionner le graphique lors de l&#39;enregistrement</span>
plt<span style="color:#f92672">.</span>show()

color <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">blue</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">red</span><span style="color:#e6db74">&#39;</span>]
fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>)) 
gs <span style="color:#f92672">=</span> gridspec<span style="color:#f92672">.</span>GridSpec(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, width_ratios<span style="color:#f92672">=</span>[<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>]) 
gs<span style="color:#f92672">.</span>update( wspace<span style="color:#f92672">=</span><span style="color:#ae81ff">0.04</span>)
ax1 <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot(gs[<span style="color:#ae81ff">0</span>])

plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">figure.figsize</span><span style="color:#e6db74">&#34;</span>]<span style="color:#f92672">=</span>[<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">9</span>]       <span style="color:#75715e">#  </span>
plt<span style="color:#f92672">.</span>plot(df_annual_A[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>values, df_annual_A[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>][:],  label<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ANUSPLIN</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span>color[<span style="color:#ae81ff">0</span>])
plt<span style="color:#f92672">.</span>plot(df_annual_D[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>values, df_annual_D[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>][:],  label<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">DAYMET</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span>color[<span style="color:#ae81ff">1</span>])
plt<span style="color:#f92672">.</span>plot(df_annual_S[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>values, df_annual_S[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annual Mean</span><span style="color:#e6db74">&#39;</span>][:],  label<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Station ECCC</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span>color[<span style="color:#ae81ff">2</span>])

ax1<span style="color:#f92672">.</span>grid(axis <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">x</span><span style="color:#e6db74">&#34;</span>, linestyle <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">--</span><span style="color:#e6db74">&#34;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
ax1<span style="color:#f92672">.</span>grid(axis <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">y</span><span style="color:#e6db74">&#34;</span>, linestyle <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">--</span><span style="color:#e6db74">&#34;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)

plt<span style="color:#f92672">.</span>setp(plt<span style="color:#f92672">.</span>gca()<span style="color:#f92672">.</span>get_xticklabels(), rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>, ha<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">right</span><span style="color:#e6db74">&#34;</span>)

plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Date</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">mm / Jour</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Monthly mean of daily precipitation: lat = 50.66N , lon = 71.25 W</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
 
ax1<span style="color:#f92672">.</span>set_facecolor(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">white</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>yticks( fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
plt<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">upper left</span><span style="color:#e6db74">&#39;</span>, ncol<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, bbox_to_anchor<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),fontsize <span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Monthly_mean_precipitation_ANUSPLIN_</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>str(yeari)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">-</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">+</span>str(yearf)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">.png</span><span style="color:#e6db74">&#34;</span>, dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>, bbox_inches<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tight</span><span style="color:#e6db74">&#39;</span>)   <span style="color:#75715e"># bbox_inches= : option qui permet de propostionner le graphique lors de l&#39;enregistrement</span>
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="./Analyse_16_0.png" alt="png"></p>
<p><img src="./Analyse_16_1.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">### heat map</span>

resamp_preacc_A[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">year</span><span style="color:#e6db74">&#39;</span>]  <span style="color:#f92672">=</span> resamp_preacc_A<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year
resamp_preacc_A[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">MonthNo</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> resamp_preacc_A<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month
resamp_preacc_A <span style="color:#f92672">=</span> resamp_preacc_A<span style="color:#f92672">.</span>pivot_table(values<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PrecTOT</span><span style="color:#e6db74">&#39;</span>,index<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">year</span><span style="color:#e6db74">&#39;</span>,columns<span style="color:#f92672">=</span>[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">MonthNo</span><span style="color:#e6db74">&#39;</span>])
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
sns<span style="color:#f92672">.</span>heatmap(resamp_preacc_A, cmap<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">RdBu</span><span style="color:#e6db74">&#39;</span>, linewidths<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, annot<span style="color:#f92672">=</span>True , ax <span style="color:#f92672">=</span> ax,vmin<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, vmax<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,center<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.1f</span><span style="color:#e6db74">&#39;</span>,yticklabels<span style="color:#f92672">=</span>True, cbar_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">label</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">mm</span><span style="color:#e6db74">&#39;</span>})
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Month cumulative precipitation: Anusplin</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bold</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">x-large</span><span style="color:#e6db74">&#34;</span>)
figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">15</span>) 
plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Month_cumulative_precipitation_Anusplin.png</span><span style="color:#e6db74">&#34;</span>, dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>, bbox_inches<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tight</span><span style="color:#e6db74">&#39;</span>)   <span style="color:#75715e"># bbox_inches= : option qui permet de propostionner le graphique lors de l&#39;enregistrement</span>
plt<span style="color:#f92672">.</span>show()

resamp_preacc_D[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">year</span><span style="color:#e6db74">&#39;</span>]  <span style="color:#f92672">=</span> resamp_preacc_D<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year
resamp_preacc_D[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">MonthNo</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> resamp_preacc_D<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month
resamp_preacc_D <span style="color:#f92672">=</span> resamp_preacc_D<span style="color:#f92672">.</span>pivot_table(values<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PrecTOT</span><span style="color:#e6db74">&#39;</span>,index<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">year</span><span style="color:#e6db74">&#39;</span>,columns<span style="color:#f92672">=</span>[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">MonthNo</span><span style="color:#e6db74">&#39;</span>])
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
sns<span style="color:#f92672">.</span>heatmap(resamp_preacc_D, cmap<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">RdBu</span><span style="color:#e6db74">&#39;</span>, linewidths<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, annot<span style="color:#f92672">=</span>True , ax <span style="color:#f92672">=</span> ax,vmin<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, vmax<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,center<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.1f</span><span style="color:#e6db74">&#39;</span>,yticklabels<span style="color:#f92672">=</span>True, cbar_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">label</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">mm</span><span style="color:#e6db74">&#39;</span>})
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Month cumulative precipitation: Daymet</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bold</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">x-large</span><span style="color:#e6db74">&#34;</span>)
figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">15</span>) 
plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Month_cumulative_precipitation_Daymet.png</span><span style="color:#e6db74">&#34;</span>, dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>, bbox_inches<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tight</span><span style="color:#e6db74">&#39;</span>)   <span style="color:#75715e"># bbox_inches= : option qui permet de propostionner le graphique lors de l&#39;enregistrement</span>
plt<span style="color:#f92672">.</span>show()


resamp_preacc_S[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">year</span><span style="color:#e6db74">&#39;</span>]  <span style="color:#f92672">=</span> resamp_preacc_S<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year
resamp_preacc_S[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">MonthNo</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> resamp_preacc_S<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month
resamp_preacc_S[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PrecTOT</span><span style="color:#e6db74">&#39;</span>]
resamp_preacc_S <span style="color:#f92672">=</span> resamp_preacc_S<span style="color:#f92672">.</span>pivot_table(values<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">PrecTOT</span><span style="color:#e6db74">&#39;</span>,index<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">year</span><span style="color:#e6db74">&#39;</span>,columns<span style="color:#f92672">=</span>[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">MonthNo</span><span style="color:#e6db74">&#39;</span>])
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
sns<span style="color:#f92672">.</span>heatmap(resamp_preacc_S, cmap<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">RdBu</span><span style="color:#e6db74">&#39;</span>, linewidths<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, annot<span style="color:#f92672">=</span>True , ax <span style="color:#f92672">=</span> ax,vmin<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, vmax<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,center<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.1f</span><span style="color:#e6db74">&#39;</span>,yticklabels<span style="color:#f92672">=</span>True, cbar_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">label</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">mm</span><span style="color:#e6db74">&#39;</span>})
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Month cumulative precipitation: Station ECCC</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">bold</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">x-large</span><span style="color:#e6db74">&#34;</span>)
figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">15</span>) 
plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Month_cumulative_precipitation_Station.png</span><span style="color:#e6db74">&#34;</span>, dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>, bbox_inches<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">tight</span><span style="color:#e6db74">&#39;</span>)   <span style="color:#75715e"># bbox_inches= : option qui permet de propostionner le graphique lors de l&#39;enregistrement</span>
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="./Analyse_17_0.png" alt="png"></p>
<p><img src="./Analyse_17_1.png" alt="png"></p>
<p><img src="./Analyse_17_2.png" alt="png"></p>

    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/tuto/&amp;text=ANUSPLIN" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/tuto/&amp;t=ANUSPLIN" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=ANUSPLIN&amp;body=/post/tuto/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/tuto/&amp;title=ANUSPLIN" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=ANUSPLIN%20/post/tuto/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/tuto/&amp;title=ANUSPLIN" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu52a603635ecebd45650b162dadabb4e5_12861_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Guillaume Dueymes</a></h5>
      <h6 class="card-subtitle">Data Scientist and Research Assistant</h6>
      <p class="card-text">My research interests include data science, data management and climate science.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=sIwtMXoAAAAJ" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/guimeto" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
