<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Guillaume Dueymes">

  
  
  
    
  
  <meta name="description" content="Compute extreme temperature indices Evaluation of extreme indices In order to provide some insight into changes in extreme climate events (e.g., dry or wet spells or cold/warm spells, etc.), a set of descriptive indices of extremes could be developed.
These indices are helpful for monitoring climate change itself and can be used as benchmarks for evaluating climate change scenarios (see the STARDEX project, 2004; Gachon et al., 2005). The indices describe particular characteristics of extremes, including frequency, amplitude/intensity and persistence/duration.">

  
  <link rel="alternate" hreflang="en-us" href="/post/extreme_temperature/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/extreme_temperature/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="GDueymes">
  <meta property="og:url" content="/post/extreme_temperature/">
  <meta property="og:title" content="Extreme_Temperature | GDueymes">
  <meta property="og:description" content="Compute extreme temperature indices Evaluation of extreme indices In order to provide some insight into changes in extreme climate events (e.g., dry or wet spells or cold/warm spells, etc.), a set of descriptive indices of extremes could be developed.
These indices are helpful for monitoring climate change itself and can be used as benchmarks for evaluating climate change scenarios (see the STARDEX project, 2004; Gachon et al., 2005). The indices describe particular characteristics of extremes, including frequency, amplitude/intensity and persistence/duration."><meta property="og:image" content="/post/extreme_temperature/featured.png">
  <meta property="twitter:image" content="/post/extreme_temperature/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-03-10T15:02:28-05:00">
    
    <meta property="article:modified_time" content="2021-03-10T15:02:28-05:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/extreme_temperature/"
  },
  "headline": "Extreme_Temperature",
  
  "image": [
    "/post/extreme_temperature/featured.png"
  ],
  
  "datePublished": "2021-03-10T15:02:28-05:00",
  "dateModified": "2021-03-10T15:02:28-05:00",
  
  "author": {
    "@type": "Person",
    "name": "Guillaume Dueymes"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "GDueymes",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "Compute extreme temperature indices Evaluation of extreme indices In order to provide some insight into changes in extreme climate events (e.g., dry or wet spells or cold/warm spells, etc.), a set of descriptive indices of extremes could be developed.\nThese indices are helpful for monitoring climate change itself and can be used as benchmarks for evaluating climate change scenarios (see the STARDEX project, 2004; Gachon et al., 2005). The indices describe particular characteristics of extremes, including frequency, amplitude/intensity and persistence/duration."
}
</script>

  

  


  


  





  <title>Extreme_Temperature | GDueymes</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">GDueymes</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Guillaume_Dueymes2019.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  


<div class="article-container pt-3">
  <h1>Extreme_Temperature</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Mar 10, 2021
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 564px; max-height: 376px;">
  <div style="position: relative">
    <img src="/post/extreme_temperature/featured.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="compute-extreme-temperature-indices">Compute extreme temperature indices</h2>
<!-- raw HTML omitted -->
<h3 id="evaluation-of-extreme-indices">Evaluation of extreme indices</h3>
<p>In order to provide some insight into changes in extreme climate events (e.g., dry or wet spells or
cold/warm spells, etc.), a set of descriptive indices of extremes could be developed.</p>
<p>These indices are helpful for monitoring climate change itself and can be used as benchmarks for evaluating
climate change scenarios (see the STARDEX project, 2004; Gachon et al., 2005).
The indices describe particular characteristics of extremes, including frequency, amplitude/intensity and
persistence/duration.</p>
<p>In the present post, some air temperature indices describe cold/warm events (ex. Tmax10pb and Tmin10pb/Tmax90p and Tmin90p,), the frost season length, the frost/thaw cycle, or the growing season length (GSL).
The GSL is defined as the number of days between the last and first frost (within an approximately 5°C range), calculated on an annual basis, and describes a period roughly between May and October. Other temperature indices are based on a distribution based, period-fixed, thresholds, such as the 10th and 90th percentiles of daily minimum and maximum temperature.</p>
<!-- raw HTML omitted -->
<h3 id="datasets-used">Datasets used</h3>
<p>We will compute these extreme temperature indices using daily temperature data from the second generation homogenized dataset of Environment and Climate Change Canada developed by Vincent et al. 2012.</p>
<p>We will first load and clean precipitation timeseries folowing this post:  <a href="https://www.guillaumedueymes.com/post/eccc_temp/">https://www.guillaumedueymes.com/post/eccc_temp/</a></p>
<h2 id="1---lets-import-python-librairies">1-  Let&rsquo;s import Python librairies</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> os
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> date
<span style="color:#f92672">import</span> calendar
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">from</span> dateutil.relativedelta <span style="color:#f92672">import</span> relativedelta
<span style="color:#f92672">import</span> warnings
warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#34;ignore&#34;</span>)
</code></pre></div><p>We will first work with one station from this document:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dataframe <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#34;./Homog_Temperature_Stations.xls&#34;</span>, skiprows <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">station <span style="color:#f92672">=</span> dataframe<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>]
station
</code></pre></div><pre><code>Prov                   BC
Nom de station    AGASSIZ
stnid             1100120
année déb.           1893
mois déb.               1
année fin.           2018
mois fin.               9
lat (deg)           49.25
long (deg)        -121.77
élév (m)               15
stns jointes            n
RCS                     n
%Miss                 1.6
Name: 0, dtype: object
</code></pre>
<h2 id="2---loading-source-file">2 - Loading source file</h2>
<p>Let&rsquo;s load time serie ofr AGASSIZ&rsquo;s station and clean the data. We will load daily temperature from 1981 to 2017:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stnid <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1100120&#39;</span>   
path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;F:/DATA/Donnees_Stations/2nd_generation_V2019/Homog_daily_mean_temp_v2019&#39;</span>
varin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;dm&#39;</span>  
f1 <span style="color:#f92672">=</span> open(path<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;/&#39;</span><span style="color:#f92672">+</span>str(varin)<span style="color:#f92672">+</span>str(stnid)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)
f2 <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;./tmp.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f1:
    <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> line:
            <span style="color:#66d9ef">if</span> word <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;M&#39;</span>:
                f2<span style="color:#f92672">.</span>write(word<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;M&#39;</span>, <span style="color:#e6db74">&#39; &#39;</span>))
            <span style="color:#66d9ef">elif</span> word <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;a&#39;</span>:
                f2<span style="color:#f92672">.</span>write(word<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39; &#39;</span>))                    
            <span style="color:#66d9ef">else</span>:
                f2<span style="color:#f92672">.</span>write(word)
f1<span style="color:#f92672">.</span>close()
f2<span style="color:#f92672">.</span>close()      
df_station <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./tmp.txt&#39;</span>, delim_whitespace<span style="color:#f92672">=</span>True, skiprows <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>))
df_station<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Year&#39;</span>, <span style="color:#e6db74">&#39;Month&#39;</span>, <span style="color:#e6db74">&#39;D1&#39;</span>,<span style="color:#e6db74">&#39;D2&#39;</span>,<span style="color:#e6db74">&#39;D3&#39;</span>,<span style="color:#e6db74">&#39;D4&#39;</span>,<span style="color:#e6db74">&#39;D5&#39;</span>,<span style="color:#e6db74">&#39;D6&#39;</span>,<span style="color:#e6db74">&#39;D7&#39;</span>,<span style="color:#e6db74">&#39;D8&#39;</span>,<span style="color:#e6db74">&#39;D9&#39;</span>,<span style="color:#e6db74">&#39;D10&#39;</span>,
                                  <span style="color:#e6db74">&#39;D11&#39;</span>,<span style="color:#e6db74">&#39;D12&#39;</span>,<span style="color:#e6db74">&#39;D13&#39;</span>,<span style="color:#e6db74">&#39;D14&#39;</span>,<span style="color:#e6db74">&#39;D15&#39;</span>,<span style="color:#e6db74">&#39;D16&#39;</span>,<span style="color:#e6db74">&#39;D17&#39;</span>,<span style="color:#e6db74">&#39;D18&#39;</span>,<span style="color:#e6db74">&#39;D19&#39;</span>,<span style="color:#e6db74">&#39;D20&#39;</span>,
                                  <span style="color:#e6db74">&#39;D21&#39;</span>,<span style="color:#e6db74">&#39;D22&#39;</span>,<span style="color:#e6db74">&#39;D23&#39;</span>,<span style="color:#e6db74">&#39;D24&#39;</span>,<span style="color:#e6db74">&#39;D25&#39;</span>,<span style="color:#e6db74">&#39;D26&#39;</span>,<span style="color:#e6db74">&#39;D27&#39;</span>,<span style="color:#e6db74">&#39;D28&#39;</span>,<span style="color:#e6db74">&#39;D29&#39;</span>,<span style="color:#e6db74">&#39;D30&#39;</span>,<span style="color:#e6db74">&#39;D31&#39;</span>]
     
<span style="color:#75715e">#os.remove(&#34;./tmp.txt&#34;)</span>
   
   <span style="color:#75715e"># nettoyage des valeurs manquantes </span>
<span style="color:#66d9ef">try</span>:  
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74">&#39;E&#39;</span>:<span style="color:#e6db74">&#39;&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">try</span>: 
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74">&#39;a&#39;</span>:<span style="color:#e6db74">&#39;&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">try</span>:     
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74">&#39;-9999.9&#39;</span>:<span style="color:#e6db74">&#39;&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">try</span>:     
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#f92672">-</span><span style="color:#ae81ff">9999.9</span>:<span style="color:#e6db74">&#39;&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>    
    
<span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span>  df_station<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">2</span>:]:
       df_station[col] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_numeric(df_station[col], errors<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;coerce&#39;</span>)  
</code></pre></div><!-- raw HTML omitted -->
<p>We will clean this dataset in order to only have daly values timeserie:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">yearmin <span style="color:#f92672">=</span> <span style="color:#ae81ff">1980</span>                               
yearmax <span style="color:#f92672">=</span> <span style="color:#ae81ff">2017</span>                                   
m_start <span style="color:#f92672">=</span>  df_station[<span style="color:#e6db74">&#39;Month&#39;</span>]<span style="color:#f92672">.</span>loc[(df_station[<span style="color:#e6db74">&#39;Year&#39;</span>] <span style="color:#f92672">==</span> yearmin)]<span style="color:#f92672">.</span>min()
m_end   <span style="color:#f92672">=</span>  df_station[<span style="color:#e6db74">&#39;Month&#39;</span>]<span style="color:#f92672">.</span>loc[(df_station[<span style="color:#e6db74">&#39;Year&#39;</span>] <span style="color:#f92672">==</span> yearmax)]<span style="color:#f92672">.</span>max()
d_end <span style="color:#f92672">=</span> calendar<span style="color:#f92672">.</span>monthrange(yearmax, m_end)[<span style="color:#ae81ff">1</span>]                     

tmp_tt <span style="color:#f92672">=</span> [ ] 
<span style="color:#66d9ef">for</span> year <span style="color:#f92672">in</span> range(yearmin,yearmax<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):    <span style="color:#75715e">### Loop over years</span>
    <span style="color:#66d9ef">for</span> month <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>):
        df <span style="color:#f92672">=</span> []
        last_day <span style="color:#f92672">=</span> calendar<span style="color:#f92672">.</span>monthrange(year, month)[<span style="color:#ae81ff">1</span>] 
        tmin <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>loc[(df_station[<span style="color:#e6db74">&#34;Year&#34;</span>] <span style="color:#f92672">==</span> year) <span style="color:#f92672">&amp;</span> (df_station[<span style="color:#e6db74">&#34;Month&#34;</span>] <span style="color:#f92672">==</span> month)]<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">2</span>:last_day<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>values
           
        <span style="color:#66d9ef">if</span> len(tmin) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty((calendar<span style="color:#f92672">.</span>monthrange(year,month)[<span style="color:#ae81ff">1</span>]))
            a[:] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
            df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(a)
        <span style="color:#66d9ef">else</span>:
            df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(tmin<span style="color:#f92672">.</span>T)
               
        start <span style="color:#f92672">=</span> date(year, month, <span style="color:#ae81ff">1</span>)
        end <span style="color:#f92672">=</span>   date(year, month, last_day)
        delta<span style="color:#f92672">=</span>(end<span style="color:#f92672">-</span>start) 
        nb_days <span style="color:#f92672">=</span> delta<span style="color:#f92672">.</span>days <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> 
        rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(start, periods<span style="color:#f92672">=</span>nb_days, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>)          
        df[<span style="color:#e6db74">&#39;datetime&#39;</span>] <span style="color:#f92672">=</span> rng
        df<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;datetime&#39;</span>]
        tmp_tt<span style="color:#f92672">.</span>append(df)
           
tmp_tt <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(tmp_tt) 
tmoy <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;datetime&#39;</span>: tmp_tt[<span style="color:#e6db74">&#39;datetime&#39;</span>], <span style="color:#e6db74">&#39;Tmoy&#39;</span>: tmp_tt<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>]}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;datetime&#39;</span>,<span style="color:#e6db74">&#39;Tmoy&#39;</span>]) 
tmoy<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> tmoy[<span style="color:#e6db74">&#39;datetime&#39;</span>]
tmoy <span style="color:#f92672">=</span> tmoy<span style="color:#f92672">.</span>drop([<span style="color:#e6db74">&#34;datetime&#34;</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><!-- raw HTML omitted -->
<p>Quick plot:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pylab <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> datetime
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#34;figure.figsize&#34;</span>]<span style="color:#f92672">=</span>[<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>]        
plt<span style="color:#f92672">.</span>plot(tmoy<span style="color:#f92672">.</span>index, tmoy[:],  label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Temerature Station&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;b&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Daily mean temperature: from &#39;</span> <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>date(yearmin, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y&#39;</span>)<span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; et &#39;</span>  <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>date(yearmax, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y&#39;</span>), fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;semibold&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Time&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;semibold&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Celcius&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;semibold&#39;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_13_0.png" alt="png"></p>
<h2 id="3---compute-monthly-extreme-temperature-indices">3 - Compute monthly extreme temperature indices</h2>
<p>We will compute  extreme temperature indices presented in previous table.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Tmax90p</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     ind_tmax90p<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
<span style="color:#75715e"># Nom: 90eme centile de la temperature maximale quotidienne</span>
     <span style="color:#66d9ef">try</span>:
         <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
             ind_tmax90p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
             ind_tmax90p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
         <span style="color:#66d9ef">else</span>:    
            s_sorted <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sort(S_no_nan)
     <span style="color:#75715e">#  La formule de Blom&#39;s pour le calculer de la probabilite empirique afin dobtenir m(=rang ou index de la matrice) </span>
            m <span style="color:#f92672">=</span> (N2<span style="color:#f92672">+</span><span style="color:#ae81ff">0.25</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">0.9</span> <span style="color:#f92672">+</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>) 
            <span style="color:#66d9ef">if</span> np<span style="color:#f92672">.</span>remainder(m,<span style="color:#ae81ff">1</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
                m_floor<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>floor(m)
                m_ceil<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>ceil(m)
                slope<span style="color:#f92672">=</span>(s_sorted[int(m_ceil)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>s_sorted[int(m_floor)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">/</span>(m_ceil<span style="color:#f92672">-</span>m_floor)
                ind_tmax90p<span style="color:#f92672">=</span>s_sorted[int(m_floor)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>slope<span style="color:#f92672">*</span>(m<span style="color:#f92672">-</span>m_floor)
            <span style="color:#66d9ef">else</span>: 
                ind_tmax90p<span style="color:#f92672">=</span>s_sorted[int(m)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>];
     <span style="color:#66d9ef">except</span>:
         ind_tmax90p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_tmax90p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">return</span> ind_tmax90p


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Tmin10p</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     ind_tmin10p<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
<span style="color:#75715e"># Nom: 90eme centile de la temperature maximale quotidienne</span>
     <span style="color:#66d9ef">try</span>:
         <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
             ind_tmin10p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
             ind_tmin10p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
         <span style="color:#66d9ef">else</span>:    
            s_sorted <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sort(S_no_nan)
     <span style="color:#75715e">#  La formule de Blom&#39;s pour le calculer de la probabilite empirique afin dobtenir m(=rang ou index de la matrice) </span>
            m <span style="color:#f92672">=</span> (N2<span style="color:#f92672">+</span><span style="color:#ae81ff">0.25</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">0.1</span> <span style="color:#f92672">+</span>(<span style="color:#ae81ff">3</span><span style="color:#f92672">/</span><span style="color:#ae81ff">8</span>) 
            <span style="color:#66d9ef">if</span>  np<span style="color:#f92672">.</span>remainder(m,<span style="color:#ae81ff">1</span>)<span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
                m_floor<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>floor(m)
                m_ceil<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>ceil(m)
                slope<span style="color:#f92672">=</span>(s_sorted[int(m_ceil)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>s_sorted[int(m_floor)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">/</span>(m_ceil<span style="color:#f92672">-</span>m_floor)
                ind_tmin10p<span style="color:#f92672">=</span>s_sorted[int(m_floor)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>slope<span style="color:#f92672">*</span>(m<span style="color:#f92672">-</span>m_floor)
            <span style="color:#66d9ef">else</span>: 
                ind_tmin10p<span style="color:#f92672">=</span>s_sorted[int(m)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>];
     <span style="color:#66d9ef">except</span>:
         ind_tmin10p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_tmin10p <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">return</span> ind_tmin10p            

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">DGJ</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     temp_ref <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>
     ind_DGJ<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
<span style="color:#75715e"># Nom: Calcul du DGJ par rapport à une température de référence temp_ref</span>
     <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
         ind_DGJ <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_DGJ <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">else</span>:    
         SS <span style="color:#f92672">=</span> S[S <span style="color:#f92672">&gt;=</span> temp_ref]        
         ind_DGJ <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nansum(SS)  
     <span style="color:#66d9ef">return</span> ind_DGJ  
    
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GSL</span>(s):
    N<span style="color:#f92672">=</span> len(s)
    i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
    B_1<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
    B_2<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">while</span>(i<span style="color:#f92672">&lt;</span>N<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>):
        <span style="color:#66d9ef">if</span> (s[i]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[i<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[i<span style="color:#f92672">+</span><span style="color:#ae81ff">5</span>]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">5</span>):
            B_1<span style="color:#f92672">=</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">5</span>
            <span style="color:#66d9ef">break</span>
        
        i<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
    g<span style="color:#f92672">=</span><span style="color:#ae81ff">212</span>
    <span style="color:#66d9ef">while</span>(g<span style="color:#f92672">&lt;</span>N<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>):       
        <span style="color:#66d9ef">if</span>(s[g]<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[g<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[g<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[g<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[g<span style="color:#f92672">+</span><span style="color:#ae81ff">4</span>]<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">and</span> s[g<span style="color:#f92672">+</span><span style="color:#ae81ff">5</span>]<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">5</span> ):
            B_2<span style="color:#f92672">=</span>g<span style="color:#f92672">+</span><span style="color:#ae81ff">5</span>
            <span style="color:#66d9ef">break</span>      
        g<span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>  
         
    <span style="color:#66d9ef">if</span>(B_1<span style="color:#f92672">&gt;=</span>B_2):
        gsl<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">else</span>:
        gsl<span style="color:#f92672">=</span>B_2<span style="color:#f92672">-</span>B_1
    <span style="color:#66d9ef">return</span> gsl

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">MOY</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     ind_moy<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
<span style="color:#75715e"># Nom: 90eme centile de la temperature maximale quotidienne</span>
     <span style="color:#66d9ef">try</span>:         
         <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
             ind_moy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
             ind_moy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
         <span style="color:#66d9ef">else</span>:    
             ind_moy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nanmean(S_no_nan)  
     <span style="color:#66d9ef">except</span>:
         ind_moy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_moy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">return</span> ind_moy      
</code></pre></div><p>We can put all this fonctions in a common module, it will be easier to load an apply functions:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> Indices_Temperatures
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">list_indices <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Tmax90p&#39;</span>,<span style="color:#e6db74">&#39;Tmin10p&#39;</span>]   
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">resamp_temp <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> ind <span style="color:#f92672">in</span> list_indices:   
    <span style="color:#66d9ef">if</span> ind <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;MOY&#39;</span>:
       indice <span style="color:#f92672">=</span> Indices_Temperatures<span style="color:#f92672">.</span>MOY  
       indice_out <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;MOY&#39;</span>     
    <span style="color:#66d9ef">elif</span> ind <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Tmax90p&#39;</span>:
       indice <span style="color:#f92672">=</span> Indices_Temperatures<span style="color:#f92672">.</span>Tmax90p
       indice_out <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Tmax90p&#39;</span>
    <span style="color:#66d9ef">elif</span> ind <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;Tmin10p&#39;</span>:
       indice <span style="color:#f92672">=</span> Indices_Temperatures<span style="color:#f92672">.</span>Tmin10p
       indice_out <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Tmin10p&#39;</span>
    <span style="color:#66d9ef">elif</span> ind <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;DGJ&#39;</span>:
       indice <span style="color:#f92672">=</span> Indices_Temperatures<span style="color:#f92672">.</span>DGJ
       indice_out <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DGJ&#39;</span>
    <span style="color:#66d9ef">elif</span> ind <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;GSL&#39;</span>:
       indice <span style="color:#f92672">=</span> Indices_Temperatures<span style="color:#f92672">.</span>GSL
       indice_out <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;GSL&#39;</span>         
    resamp_temp<span style="color:#f92672">.</span>append(tmoy<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;M&#39;</span>)<span style="color:#f92672">.</span>agg([indice]))
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">monthly_indices <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(resamp_temp, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
monthly_indices<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> monthly_indices<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>droplevel(<span style="color:#ae81ff">0</span>)
</code></pre></div><!-- raw HTML omitted -->
<ul>
<li>We now can make some quick plots:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pylab <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> datetime
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#34;figure.figsize&#34;</span>]<span style="color:#f92672">=</span>[<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>]        
plt<span style="color:#f92672">.</span>plot(monthly_indices<span style="color:#f92672">.</span>index, monthly_indices[<span style="color:#e6db74">&#39;Tmax90p&#39;</span>],  label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;90th percentile of daily mean temperature&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>)
plt<span style="color:#f92672">.</span>plot(monthly_indices<span style="color:#f92672">.</span>index, monthly_indices[<span style="color:#e6db74">&#39;Tmin10p&#39;</span>],  label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;10th percentile of daily mean temperature&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;b&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Monthly indices: from &#39;</span> <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>date(yearmin, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y&#39;</span>)<span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; et &#39;</span>  <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>date(yearmax, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%Y&#39;</span>), fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;semibold&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Time&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;semibold&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Celcius&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;semibold&#39;</span>)
plt<span style="color:#f92672">.</span>legend()
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_23_0.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt 
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
sns<span style="color:#f92672">.</span>boxplot(x<span style="color:#f92672">=</span>monthly_indices<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Tmax90p&#34;</span>, data<span style="color:#f92672">=</span>monthly_indices, palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Set1&#34;</span>) 
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;90th percentile of daily mean temperature in AGASSIZ from 1980 to 2017&#39;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Celcius&#39;</span>)

figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>) 
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_24_0.png" alt="png"></p>
<h2 id="4---compute-saisonal-extreme-precipitation-indices">4 - Compute saisonal extreme precipitation indices</h2>
<p>In this section, we will compute seasonal mean temperature for each year from 1981 to 2017 using Indices_Temperatures.MOY fonction.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#################################### Calcul des indices saisonniers  </span>
djf <span style="color:#f92672">=</span> []
mam <span style="color:#f92672">=</span> []
son<span style="color:#f92672">=</span>[]
jja<span style="color:#f92672">=</span>[]
incr<span style="color:#f92672">=</span> date(<span style="color:#ae81ff">1981</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
end <span style="color:#f92672">=</span> date(<span style="color:#ae81ff">2017</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
<span style="color:#66d9ef">while</span> incr <span style="color:#f92672">&lt;=</span> end:
    current_year <span style="color:#f92672">=</span> str(incr<span style="color:#f92672">.</span>year)
    last_year <span style="color:#f92672">=</span> str(incr<span style="color:#f92672">.</span>year<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">try</span>:
        dec <span style="color:#f92672">=</span> tmoy[last_year][np<span style="color:#f92672">.</span>in1d(tmoy[last_year]<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, [<span style="color:#ae81ff">12</span>])]
    <span style="color:#66d9ef">except</span>:
        rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(last_year, periods<span style="color:#f92672">=</span><span style="color:#ae81ff">31</span>, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>)
        dec <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;datetime&#39;</span>: rng, <span style="color:#e6db74">&#39;variable&#39;</span>: [np<span style="color:#f92672">.</span>nan]<span style="color:#f92672">*</span><span style="color:#ae81ff">31</span>}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;datetime&#39;</span>,<span style="color:#e6db74">&#39;variable&#39;</span>]) 
                
    j_f <span style="color:#f92672">=</span> tmoy[current_year][np<span style="color:#f92672">.</span>in1d(tmoy[current_year]<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>])]
            
    djf<span style="color:#f92672">.</span>append(Indices_Temperatures<span style="color:#f92672">.</span>MOY(dec<span style="color:#f92672">.</span>append(j_f)))            
    mam<span style="color:#f92672">.</span>append(Indices_Temperatures<span style="color:#f92672">.</span>MOY((tmoy[current_year][np<span style="color:#f92672">.</span>in1d(tmoy[current_year]<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, [<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>])])))
    jja<span style="color:#f92672">.</span>append(Indices_Temperatures<span style="color:#f92672">.</span>MOY((tmoy[current_year][np<span style="color:#f92672">.</span>in1d(tmoy[current_year]<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, [<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">8</span>])])))
    son<span style="color:#f92672">.</span>append(Indices_Temperatures<span style="color:#f92672">.</span>MOY((tmoy[current_year][np<span style="color:#f92672">.</span>in1d(tmoy[current_year]<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month, [<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>])])))            
    
    incr <span style="color:#f92672">=</span> incr <span style="color:#f92672">+</span> relativedelta(years<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">TIME<span style="color:#f92672">=</span>[]
<span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1981</span>,<span style="color:#ae81ff">2017</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>):
    TIME<span style="color:#f92672">.</span>append(y)
df_season <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Date&#39;</span>: TIME,<span style="color:#e6db74">&#39;Winter&#39;</span>: djf, <span style="color:#e6db74">&#39;Spring&#39;</span>:mam, <span style="color:#e6db74">&#39;Summer&#39;</span>:jja, <span style="color:#e6db74">&#39;Autumn&#39;</span>:son}, 
                         columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Date&#39;</span>,<span style="color:#e6db74">&#39;Winter&#39;</span>, <span style="color:#e6db74">&#39;Spring&#39;</span>, <span style="color:#e6db74">&#39;Summer&#39;</span>, <span style="color:#e6db74">&#39;Autumn&#39;</span>]) 

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df_season<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#34;Date&#34;</span>, inplace <span style="color:#f92672">=</span> True)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df_season[[<span style="color:#e6db74">&#34;Winter&#34;</span>, <span style="color:#e6db74">&#34;Spring&#34;</span>, <span style="color:#e6db74">&#34;Summer&#34;</span>, <span style="color:#e6db74">&#34;Autumn&#34;</span>]]<span style="color:#f92672">.</span>plot(kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;line&#34;</span>)
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#34; Season mean temperature / season: Agassiz&#34;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Celcius&#39;</span>)
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Time&#39;</span>) 
figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>) 
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_29_0.png" alt="png"></p>
<h2 id="5---compute-annual-extreme-temperature-indices">5 - Compute annual extreme temperature indices</h2>
<p>In this last exemple, we will compute the growing season length (GSL) for each year in our Agassiz&rsquo;s daily mean temperature time serie. The GSL is defined as the number of days between the last and first frost for each year.</p>
<p>We will call Indices_Temperatures.GSL fonction.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">annual <span style="color:#f92672">=</span> []
df_annual <span style="color:#f92672">=</span> []
incr<span style="color:#f92672">=</span> date(<span style="color:#ae81ff">1980</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
end <span style="color:#f92672">=</span> date(<span style="color:#ae81ff">2017</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
<span style="color:#66d9ef">while</span> incr <span style="color:#f92672">&lt;=</span> end:
    current_year <span style="color:#f92672">=</span> str(incr<span style="color:#f92672">.</span>year)
    annual<span style="color:#f92672">.</span>append(Indices_Temperatures<span style="color:#f92672">.</span>GSL(tmoy[current_year]<span style="color:#f92672">.</span>values))         
    incr <span style="color:#f92672">=</span> incr <span style="color:#f92672">+</span> relativedelta(years<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">TIME<span style="color:#f92672">=</span>[]
<span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1980</span>,<span style="color:#ae81ff">2017</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>):
    TIME<span style="color:#f92672">.</span>append(y) 
df_annual <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Date&#39;</span>: TIME,<span style="color:#e6db74">&#39;Growing season length&#39;</span>: annual}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Date&#39;</span>,<span style="color:#e6db74">&#39;Growing season length&#39;</span>]) 
df_annual<span style="color:#f92672">=</span> df_annual[df_annual <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>]
</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
plt<span style="color:#f92672">.</span>plot( <span style="color:#e6db74">&#39;Date&#39;</span>, <span style="color:#e6db74">&#39;Growing season length&#39;</span>, data<span style="color:#f92672">=</span>df_annual, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;o&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mediumvioletred&#39;</span>)
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Annual growing season length in AGASSIZ from 1980 to 2017&#39;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Number of days&#39;</span>)
figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>) 
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_35_0.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div>
    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/extreme_temperature/&amp;text=Extreme_Temperature" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/extreme_temperature/&amp;t=Extreme_Temperature" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Extreme_Temperature&amp;body=/post/extreme_temperature/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/extreme_temperature/&amp;title=Extreme_Temperature" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Extreme_Temperature%20/post/extreme_temperature/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/extreme_temperature/&amp;title=Extreme_Temperature" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hued2496a182fbb6fc8c711157078d29a6_5348924_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Guillaume Dueymes</a></h5>
      <h6 class="card-subtitle">Data Scientist and Research Assistant</h6>
      <p class="card-text">My research interests include data science, data management and climate science.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Guillaume_Dueymes" target="_blank" rel="noopener">
        <i class="fab fa-researchgate"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/guimeto" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
