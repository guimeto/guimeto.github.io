<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Guillaume Dueymes">

  
  
  
    
  
  <meta name="description" content="﻿In this post, we will show how to work with Surface Weather Observation from ECCC in XML language (Extensible Markup Language)
SW-OB-XML For xml files, we will use a package called xml which will allow us to decrypt the xml file.
Pandas does not directly have tools to transform xml into DataFrame because the semi-structured aspect of xml forces us to perform a few steps before filling out a DataFrame.">

  
  <link rel="alternate" hreflang="en-us" href="/post/ecc_swob_stations/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/ecc_swob_stations/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="GDueymes">
  <meta property="og:url" content="/post/ecc_swob_stations/">
  <meta property="og:title" content="ECCC SWOB Stations | GDueymes">
  <meta property="og:description" content="﻿In this post, we will show how to work with Surface Weather Observation from ECCC in XML language (Extensible Markup Language)
SW-OB-XML For xml files, we will use a package called xml which will allow us to decrypt the xml file.
Pandas does not directly have tools to transform xml into DataFrame because the semi-structured aspect of xml forces us to perform a few steps before filling out a DataFrame."><meta property="og:image" content="/post/ecc_swob_stations/featured.png">
  <meta property="twitter:image" content="/post/ecc_swob_stations/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-02-18T13:06:38-08:00">
    
    <meta property="article:modified_time" content="2020-02-18T13:06:38-08:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/ecc_swob_stations/"
  },
  "headline": "ECCC SWOB Stations",
  
  "image": [
    "/post/ecc_swob_stations/featured.png"
  ],
  
  "datePublished": "2020-02-18T13:06:38-08:00",
  "dateModified": "2020-02-18T13:06:38-08:00",
  
  "author": {
    "@type": "Person",
    "name": "Guillaume Dueymes"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "GDueymes",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "﻿In this post, we will show how to work with Surface Weather Observation from ECCC in XML language (Extensible Markup Language)\nSW-OB-XML For xml files, we will use a package called xml which will allow us to decrypt the xml file.\nPandas does not directly have tools to transform xml into DataFrame because the semi-structured aspect of xml forces us to perform a few steps before filling out a DataFrame."
}
</script>

  

  


  


  





  <title>ECCC SWOB Stations | GDueymes</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">GDueymes</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Guillaume_Dueymes2019.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>ECCC SWOB Stations</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Feb 18, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 363px;">
  <div style="position: relative">
    <img src="/post/ecc_swob_stations/featured_hueb1ef7be24307b6a71225edb5c6880af_518287_720x0_resize_lanczos_2.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      

<p>﻿In this post, we will show how to work with Surface Weather Observation from ECCC in XML language (Extensible Markup Language)</p>

<h3 id="sw-ob-xml">SW-OB-XML</h3>

<p>For xml files, we will use a package called xml which will allow us to decrypt the xml file.</p>

<p>Pandas does not directly have tools to transform xml into DataFrame because the semi-structured aspect of xml forces us to perform a few steps before filling out a DataFrame.</p>

<p>We will first download <a href="https://dd.weather.gc.ca/observations/doc/" target="_blank">an xml file</a>.</p>

<p>We are going to work here with the meteorological ground (SWOB-ML) and marine observations data found on the ECCC Datamart.</p>

<hr />

<p>Data are available at the following links:</p>

<ul>
<li>Earth observations:
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</li>
</ul>

<p><a href="https://dd.meteo.gc.ca/observations/swob-ml/AAAAMMJJ/XXXX/" target="_blank">https://dd.meteo.gc.ca/observations/swob-ml/AAAAMMJJ/XXXX/</a></p>

<p>Where:</p>

<ul>
<li>AAAAMMJJ: observations date, UTC</li>

<li><p>XXXX: station ID (OMM ID)</p></li>

<li><h2 id="marine-observations">Marine observations:</h2></li>
</ul>

<p><a href="https://dd.meteo.gc.ca/observations/swob-ml/marine/moored-buoys/YYYMMDD/XXXXXXX" target="_blank">https://dd.meteo.gc.ca/observations/swob-ml/marine/moored-buoys/YYYMMDD/XXXXXXX</a></p>

<p>Where:
* AAAAMMJJ: observations date, UTC
* XXXXXXX: station ID (OMM ID), can be 5 or 7 digits</p>

<ul>
<li>Partner observations:
&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-
<br /></li>
</ul>

<p><a href="https://dd.meteo.gc.ca/observations/swob-ml/partners/NETWORK/YYYMMDD/MSC-ID" target="_blank">https://dd.meteo.gc.ca/observations/swob-ml/partners/NETWORK/YYYMMDD/MSC-ID</a></p>

<p>Where:
 - NETWORK: acronym of the partner network
 - YYYYMMDD: observations date, UTC
 - MSC-ID: ID</p>

<p>################################################</p>

<h3 id="description">Description</h3>

<p>################################################</p>

<p>The markup language for ground weather (SWOB Met-ML) and marine observations is an XML format for the distribution of weather data observed by Environment and Climate Change Canada and its partners.</p>

<p>The list of observation stations is available here:</p>

<p><a href="https://dd.meteo.gc.ca/observations/doc/swob-xml_station_list.csv" target="_blank">https://dd.meteo.gc.ca/observations/doc/swob-xml_station_list.csv</a></p>

<p>The list of marine observation stations is available here:</p>

<p><a href="https://dd.meteo.gc.ca/observations/doc/swob-xml_marine_station_list.csv" target="_blank">https://dd.meteo.gc.ca/observations/doc/swob-xml_marine_station_list.csv</a></p>

<p>The list of partner stations is available here:</p>

<p><a href="https://dd.meteo.gc.ca/observations/doc/swob-xml_partner_station_list.csv" target="_blank">https://dd.meteo.gc.ca/observations/doc/swob-xml_partner_station_list.csv</a></p>

<p>The format specification is available in the following directory:
<a href="https://dd.meteo.gc.ca/observations/doc/" target="_blank">https://dd.meteo.gc.ca/observations/doc/</a></p>

<p>Here is the structure of a SWOB file:</p>

<p><img src="./struc_swob.png" alt="Indentation" width="100%" height="100%"></p>

<p>First, we import python librairies and define the date we want to extract:</p>

<pre><code class="language-python"># importations des librairies 
from datetime import datetime, timedelta
import pandas as pd 
import xml.etree.ElementTree as ET
import wget
import warnings
warnings.filterwarnings(&quot;ignore&quot;)
import os 
from os.path import exists
now = datetime.utcnow() - timedelta(hours=1)

year = str(now.year)
month = str(now.month)
day = str(now.day)
hour = f'{now.hour:02d}'
day = f'{now.day:02d}'
month = f'{now.month:02d}'
date = year+month+day
date
</code></pre>

<pre><code>'20200212'
</code></pre>

<p>We will list the stations we want to extract: example for the province of Quebec and Ontario.</p>

<pre><code class="language-python">stations = pd.read_table(&quot;swob-xml_station_list.csv&quot;, sep=&quot;,&quot;)
stations_quebec = stations.loc[(stations[&quot;Province/Territory&quot;]=='Quebec')  ,:]
stations_ontario = stations.loc[(stations[&quot;Province/Territory&quot;]=='Ontario')  ,:]
stations_mask=pd.concat([stations_quebec,stations_ontario],axis=0)
stations_mask_sans_NaN = stations_mask.dropna() 
#stations_mask_sans_NaN_AUTO = stations_mask_sans_NaN.loc[stations_mask_sans_NaN[&quot;AUTO/MAN&quot;]=='AUTO',:]
stations_mask_sans_NaN.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">IATA_ID</th>
<th align="left">Name</th>
<th align="right">WMO_ID</th>
<th align="left">MSC_ID</th>
<th align="right">Latitude</th>
<th align="right">Longitude</th>
<th align="right">Elevation(m)</th>
<th align="left">Data_Provider</th>
<th align="left">Dataset/Network</th>
<th align="left">AUTO/MAN</th>
<th align="left">Province/Territory</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">48</td>
<td align="left">CGAH</td>
<td align="left">LA GRANDE IV</td>
<td align="right">71823</td>
<td align="left">7093GJ5</td>
<td align="right">53.75</td>
<td align="right">-73.6828</td>
<td align="right">306.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">49</td>
<td align="left">CGBC</td>
<td align="left">BAIE-COMEAU</td>
<td align="right">71890</td>
<td align="left">7040442</td>
<td align="right">49.1351</td>
<td align="right">-68.2024</td>
<td align="right">22.6</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">50</td>
<td align="left">CGCH</td>
<td align="left">CHIBOUGAMAU-CHAPAIS</td>
<td align="right">73011</td>
<td align="left">7091410</td>
<td align="right">49.7773</td>
<td align="right">-74.5304</td>
<td align="right">389.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">51</td>
<td align="left">CGCL</td>
<td align="left">CAUSAPSCAL AIRPORT</td>
<td align="right">73005</td>
<td align="left">7051201</td>
<td align="right">48.3088</td>
<td align="right">-67.2528</td>
<td align="right">123</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">52</td>
<td align="left">CGGA</td>
<td align="left">GASPE AIRPORT</td>
<td align="right">73116</td>
<td align="left">7052603</td>
<td align="right">48.7833</td>
<td align="right">-64.4833</td>
<td align="right">40</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>

<h2 id="1-working-with-one-station">1- Working with one station</h2>

<p>Let&rsquo;s work with  CWTQ station ID:</p>

<pre><code class="language-python">import requests
stid = 'CWTQ'
tmp_file = 'https://dd.weather.gc.ca/observations/swob-ml/'+date+'/'+stid+'/'+year+'-'+month+'-'+day+'-'+hour+'00-'+stid+'-AUTO-swob.xml'
tmp_file
</code></pre>

<pre><code>'https://dd.weather.gc.ca/observations/swob-ml/20200212/CWTQ/2020-02-12-1900-CWTQ-AUTO-swob.xml'
</code></pre>

<pre><code class="language-python">wget.download(tmp_file)
</code></pre>

<pre><code>100% [............................................................] 9408 / 9408




'2020-02-12-1900-CWTQ-AUTO-swob.xml'
</code></pre>

<pre><code class="language-python">tree = ET.parse(year+'-'+month+'-'+day+'-'+hour+'00-'+stid+'-AUTO-swob.xml')
root=tree.getroot()
children = root.getchildren()
</code></pre>

<p>Here is the root of our data to extract:</p>

<pre><code class="language-python">root
</code></pre>

<pre><code>&lt;Element '{http://www.opengis.net/om/1.0}ObservationCollection' at 0x000000000950ED18&gt;
</code></pre>

<pre><code class="language-python">children
</code></pre>

<pre><code>[&lt;Element '{http://www.opengis.net/om/1.0}member' at 0x000000000950EE08&gt;]
</code></pre>

<p>Number of elements in our file:</p>

<pre><code class="language-python"># total amount of items
print(len(root))
</code></pre>

<pre><code>1
</code></pre>

<p>for child in root.iter(&rsquo;*&lsquo;):</p>

<pre><code>print(child.items())

#print(child.keys())
</code></pre>

<p>for child in root.iter(&rsquo;*&lsquo;):</p>

<pre><code>print(child)

print(child.attrib)

print(child.attrib.get('value'))

print(child.attrib.get('name'))
</code></pre>

<p>The list of variables is available on page 40 of the document:
&mdash; SWOB-ML_Product_User_Guide_v8.2_f.pdf</p>

<pre><code class="language-python">data=[]
date_tm=[] 
avg_air_temp_pst1hr=[]
max_air_temp_pst1hr=[]
min_air_temp_pst1hr=[]
max_rel_hum_pst1hr=[]
min_rel_hum_pst1hr=[]
stn_pres=[]
mslp=[]
pcpn_amt_pst1hr=[]
wnd_dir_10m_pst1hr_max_spd=[]
max_wnd_spd_10m_pst1hr=[]
avg_wnd_spd_10m_pst10mts=[]
avg_snw_dpth_pst5mts_1=[]
avg_snw_dpth_pst5mts_2=[]
avg_snw_dpth_pst5mts_3=[]


for child in root.iter('*'):  
    if child.attrib.get('name') == 'date_tm':           # date of actual observation
        date_tm.append(child.get('value'))
    if child.attrib.get('name') == 'avg_air_temp_pst1hr':  # average air temperature in the last hour 
        avg_air_temp_pst1hr.append(child.get('value'))    
    if child.attrib.get('name') == 'min_air_temp_pst1hr': # minimum air temperature in the last hour
        min_air_temp_pst1hr.append(child.get('value'))    
    if child.attrib.get('name') == 'max_air_temp_pst1hr': # maximum air temperature in the last hour 
        max_air_temp_pst1hr.append(child.get('value'))    
    if child.attrib.get('name') == 'max_rel_hum_pst1hr': # maximum relative humidity in the past hour
        max_rel_hum_pst1hr.append(child.get('value'))    
    if child.attrib.get('name') == 'min_rel_hum_pst1hr': # minimum relative humidity in the past hour
        min_rel_hum_pst1hr.append(child.get('value')) 
    if child.attrib.get('name') == 'stn_pres':         # pressure at the station (start of the hour)
        stn_pres.append(child.get('value'))
    if child.attrib.get('name') == 'pcpn_amt_pst1hr':   # amount of precipitation in the past hour
        pcpn_amt_pst1hr.append(child.get('value'))  
    if child.attrib.get('name') == 'avg_wnd_spd_10m_pst10mts': # average wind speed at 10 m for 10 min
        avg_wnd_spd_10m_pst10mts.append(child.get('value'))      
    if child.attrib.get('name') == 'max_wnd_spd_10m_pst1hr': #  maximum wind speed at 10 m for one hour
        max_wnd_spd_10m_pst1hr.append(child.get('value'))      
    if child.attrib.get('name') == 'wnd_dir_10m_pst1hr_max_spd': # Instant wind direction at 10 m for maximum hourly wind speed, min 0 to 60
        wnd_dir_10m_pst1hr_max_spd.append(child.get('value'))          
    if child.attrib.get('name') == 'mslp':   # average sea level pressure
        mslp.append(child.get('value'))      
    if child.attrib.get('name') == 'avg_snw_dpth_pst5mts_1':
            avg_snw_dpth_pst5mts_1.append(child.get('value'))
    if child.attrib.get('name') == 'avg_snw_dpth_pst5mts_2':
            avg_snw_dpth_pst5mts_2.append(child.get('value'))
    if child.attrib.get('name') == 'avg_snw_dpth_pst5mts_3':
            avg_snw_dpth_pst5mts_3.append(child.get('value'))
            
            
data_dict = {'date_tm':date_tm, 
        'avg_air_temp_pst1hr':avg_air_temp_pst1hr, 
        'min_air_temp_pst1hr':min_air_temp_pst1hr,
        'max_air_temp_pst1hr': max_air_temp_pst1hr, 
        'max_rel_hum_pst1hr':max_rel_hum_pst1hr,
        'min_rel_hum_pst1hr':min_rel_hum_pst1hr,
        'stn_pres':stn_pres,
         'mslp':mslp,
        'pcpn_amt_pst1hr':pcpn_amt_pst1hr,
        'avg_wnd_spd_10m_pst10mts':avg_wnd_spd_10m_pst10mts,
        'wnd_dir_10m_pst1hr_max_spd':wnd_dir_10m_pst1hr_max_spd,
        'max_wnd_spd_10m_pst1hr':max_wnd_spd_10m_pst1hr,
        'avg_snw_dpth_pst5mts_1':avg_snw_dpth_pst5mts_1,
        'avg_snw_dpth_pst5mts_2':avg_snw_dpth_pst5mts_2,
        'avg_snw_dpth_pst5mts_3':avg_snw_dpth_pst5mts_3
        
       } 

data= pd.DataFrame(data_dict)           
</code></pre>

<pre><code class="language-python">data
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">date_tm</th>
<th align="right">avg_air_temp_pst1hr</th>
<th align="right">min_air_temp_pst1hr</th>
<th align="right">max_air_temp_pst1hr</th>
<th align="right">max_rel_hum_pst1hr</th>
<th align="right">min_rel_hum_pst1hr</th>
<th align="right">stn_pres</th>
<th align="right">mslp</th>
<th align="right">pcpn_amt_pst1hr</th>
<th align="right">avg_wnd_spd_10m_pst10mts</th>
<th align="right">wnd_dir_10m_pst1hr_max_spd</th>
<th align="right">max_wnd_spd_10m_pst1hr</th>
<th align="right">avg_snw_dpth_pst5mts_1</th>
<th align="right">avg_snw_dpth_pst5mts_2</th>
<th align="right">avg_snw_dpth_pst5mts_3</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="left">2020-02-18T20:00:00.000Z</td>
<td align="right">-0.7</td>
<td align="right">-1.2</td>
<td align="right">-0.3</td>
<td align="right">86</td>
<td align="right">83</td>
<td align="right">1006.6</td>
<td align="right">1010.7</td>
<td align="right">0</td>
<td align="right">40.8</td>
<td align="right">151</td>
<td align="right">56.4</td>
<td align="right">37</td>
<td align="right">33</td>
<td align="right">37</td>
</tr>
</tbody>
</table>

<h2 id="2-reading-the-station-list">2- Reading the station list</h2>

<pre><code class="language-python">stations = pd.read_table(&quot;swob-xml_station_list.csv&quot;, sep=&quot;,&quot;)
stations.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">IATA_ID</th>
<th align="left">Name</th>
<th align="right">WMO_ID</th>
<th align="right">MSC_ID</th>
<th align="right">Latitude</th>
<th align="right">Longitude</th>
<th align="right">Elevation(m)</th>
<th align="right">Data_Provider</th>
<th align="right">Dataset/Network</th>
<th align="left">AUTO/MAN</th>
<th align="right">Province/Territory</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">4400488</td>
<td align="left">East Chedabucto Bay</td>
<td align="right">44488</td>
<td align="right">9302000</td>
<td align="right">45.445</td>
<td align="right">-60.9538</td>
<td align="right">0</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="left">AUTO</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">4400489</td>
<td align="left">West Chedabucto Bay</td>
<td align="right">44489</td>
<td align="right">9302001</td>
<td align="right">45.4869</td>
<td align="right">-61.141</td>
<td align="right">0</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="left">AUTO</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">4400490</td>
<td align="left">West Bay of Fundy</td>
<td align="right">44490</td>
<td align="right">9300300</td>
<td align="right">44.6606</td>
<td align="right">-66.3686</td>
<td align="right">0</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="left">AUTO</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4600303</td>
<td align="left">Southern Georgia Strait</td>
<td align="right">46303</td>
<td align="right">9102000</td>
<td align="right">49.025</td>
<td align="right">-123.43</td>
<td align="right">0</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="left">AUTO</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">4600304</td>
<td align="left">Entrance to English Bay</td>
<td align="right">46304</td>
<td align="right">9102001</td>
<td align="right">49.3017</td>
<td align="right">-123.357</td>
<td align="right">0</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="left">AUTO</td>
<td align="right">nan</td>
</tr>
</tbody>
</table>

<h2 id="3-filter-stations-over-a-specific-province">3- Filter stations over  a specific province</h2>

<pre><code class="language-python">stations_mask = stations.loc[stations[&quot;Province/Territory&quot;]=='Quebec',:]
</code></pre>

<pre><code class="language-python">stations_mask.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">IATA_ID</th>
<th align="left">Name</th>
<th align="right">WMO_ID</th>
<th align="left">MSC_ID</th>
<th align="right">Latitude</th>
<th align="right">Longitude</th>
<th align="right">Elevation(m)</th>
<th align="left">Data_Provider</th>
<th align="left">Dataset/Network</th>
<th align="left">AUTO/MAN</th>
<th align="left">Province/Territory</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">48</td>
<td align="left">CGAH</td>
<td align="left">LA GRANDE IV</td>
<td align="right">71823</td>
<td align="left">7093GJ5</td>
<td align="right">53.75</td>
<td align="right">-73.6828</td>
<td align="right">306.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">49</td>
<td align="left">CGBC</td>
<td align="left">BAIE-COMEAU</td>
<td align="right">71890</td>
<td align="left">7040442</td>
<td align="right">49.1351</td>
<td align="right">-68.2024</td>
<td align="right">22.6</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">50</td>
<td align="left">CGCH</td>
<td align="left">CHIBOUGAMAU-CHAPAIS</td>
<td align="right">73011</td>
<td align="left">7091410</td>
<td align="right">49.7773</td>
<td align="right">-74.5304</td>
<td align="right">389.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">51</td>
<td align="left">CGCL</td>
<td align="left">CAUSAPSCAL AIRPORT</td>
<td align="right">73005</td>
<td align="left">7051201</td>
<td align="right">48.3088</td>
<td align="right">-67.2528</td>
<td align="right">123</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">52</td>
<td align="left">CGGA</td>
<td align="left">GASPE AIRPORT</td>
<td align="right">73116</td>
<td align="left">7052603</td>
<td align="right">48.7833</td>
<td align="right">-64.4833</td>
<td align="right">40</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">#stations_mask_sans_NaN = stations_mask.dropna() 
</code></pre>

<pre><code class="language-python">#stations_mask_sans_NaN
</code></pre>

<p>We want to work with only stations with automatic recording:</p>

<pre><code class="language-python">stations_mask_AUTO = stations_mask.loc[stations_mask[&quot;AUTO/MAN&quot;]=='AUTO',:]
</code></pre>

<pre><code class="language-python">stations_mask_AUTO.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">IATA_ID</th>
<th align="left">Name</th>
<th align="right">WMO_ID</th>
<th align="left">MSC_ID</th>
<th align="right">Latitude</th>
<th align="right">Longitude</th>
<th align="right">Elevation(m)</th>
<th align="left">Data_Provider</th>
<th align="left">Dataset/Network</th>
<th align="left">AUTO/MAN</th>
<th align="left">Province/Territory</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">48</td>
<td align="left">CGAH</td>
<td align="left">LA GRANDE IV</td>
<td align="right">71823</td>
<td align="left">7093GJ5</td>
<td align="right">53.75</td>
<td align="right">-73.6828</td>
<td align="right">306.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">49</td>
<td align="left">CGBC</td>
<td align="left">BAIE-COMEAU</td>
<td align="right">71890</td>
<td align="left">7040442</td>
<td align="right">49.1351</td>
<td align="right">-68.2024</td>
<td align="right">22.6</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">50</td>
<td align="left">CGCH</td>
<td align="left">CHIBOUGAMAU-CHAPAIS</td>
<td align="right">73011</td>
<td align="left">7091410</td>
<td align="right">49.7773</td>
<td align="right">-74.5304</td>
<td align="right">389.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">51</td>
<td align="left">CGCL</td>
<td align="left">CAUSAPSCAL AIRPORT</td>
<td align="right">73005</td>
<td align="left">7051201</td>
<td align="right">48.3088</td>
<td align="right">-67.2528</td>
<td align="right">123</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">52</td>
<td align="left">CGGA</td>
<td align="left">GASPE AIRPORT</td>
<td align="right">73116</td>
<td align="left">7052603</td>
<td align="right">48.7833</td>
<td align="right">-64.4833</td>
<td align="right">40</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>
</tbody>
</table>

<p>Example of a loop on all stations in Quebec:</p>

<pre><code class="language-python">for index, row in stations_mask_AUTO.iterrows():
    stid = row['IATA_ID']
    tmp_file = 'https://dd.weather.gc.ca/observations/swob-ml/'+date+'/'+stid+'/'+year+'-'+month+'-'+day+'-'+hour+'00-'+stid+'-AUTO-swob.xml'
    r = requests.get(tmp_file)
   
    if r.status_code != 200:
        continue
    
    root = ET.fromstring(r.content)
    data=[]
    date_tm=[] 
    avg_air_temp_pst1hr=[]
    max_air_temp_pst1hr=[]
    min_air_temp_pst1hr=[]
    max_rel_hum_pst1hr=[]
    min_rel_hum_pst1hr=[]
    stn_pres=[]
    mslp=[]
    pcpn_amt_pst1hr=[]
    wnd_dir_10m_pst1hr_max_spd=[]
    max_wnd_spd_10m_pst1hr=[]
    avg_wnd_spd_10m_pst10mts=[]
    avg_snw_dpth_pst5mts_1=[]
    avg_snw_dpth_pst5mts_2=[]
    avg_snw_dpth_pst5mts_3=[]

    for child in root.iter('*'):  
        if child.attrib.get('name') == 'date_tm':                   # date-heure d’observation réelle
            date_tm.append(child.get('value'))
        if child.attrib.get('name') == 'avg_air_temp_pst1hr':  # température de l'air moyenne au cours de la dernière heure (minutes 00 à 60)
            avg_air_temp_pst1hr.append(child.get('value'))    
        if child.attrib.get('name') == 'min_air_temp_pst1hr': # température de l'air minimale au cours de la dernière heure (minutes 00 à 60)
            min_air_temp_pst1hr.append(child.get('value'))    
        if child.attrib.get('name') == 'max_air_temp_pst1hr': # température de l'air maximale au cours de la dernière heure (minutes 00 à 60) 
            max_air_temp_pst1hr.append(child.get('value'))    
        if child.attrib.get('name') == 'max_rel_hum_pst1hr': # humidité relative maximale au cours de la dernière heure 
            max_rel_hum_pst1hr.append(child.get('value'))    
        if child.attrib.get('name') == 'min_rel_hum_pst1hr':# humidité relative minimale au cours de la dernière heure
            min_rel_hum_pst1hr.append(child.get('value')) 
        if child.attrib.get('name') == 'stn_pres':         # pression à la station (début de l’heure)
            stn_pres.append(child.get('value'))
        if child.attrib.get('name') == 'pcpn_amt_pst1hr':   # quantité de précipitation au cours de la dernière heure
            pcpn_amt_pst1hr.append(child.get('value'))  
        if child.attrib.get('name') == 'avg_wnd_spd_10m_pst10mts': # vitesse moyenne du vent à 10 m pendant 10 min
            avg_wnd_spd_10m_pst10mts.append(child.get('value'))      
        if child.attrib.get('name') == 'max_wnd_spd_10m_pst1hr': #  vitesse maximale du vent à 10 m pendant une heure
            max_wnd_spd_10m_pst1hr.append(child.get('value'))      
        if child.attrib.get('name') == 'wnd_dir_10m_pst1hr_max_spd': #Direction instantanée du vent à 10 m pour une vitesse horaire maximale du vent, min 0 à 60
            wnd_dir_10m_pst1hr_max_spd.append(child.get('value'))          
        if child.attrib.get('name') == 'mslp':   # pression moyenne au niveau de la mer
            mslp.append(child.get('value'))      
        if child.attrib.get('name') == 'avg_snw_dpth_pst5mts_1':
                avg_snw_dpth_pst5mts_1.append(child.get('value'))
        if child.attrib.get('name') == 'avg_snw_dpth_pst5mts_2':
                avg_snw_dpth_pst5mts_2.append(child.get('value'))
        if child.attrib.get('name') == 'avg_snw_dpth_pst5mts_3':
                avg_snw_dpth_pst5mts_3.append(child.get('value'))


    data_dict = {'date_tm':date_tm, 
            'avg_air_temp_pst1hr':avg_air_temp_pst1hr, 
            'min_air_temp_pst1hr':min_air_temp_pst1hr,
            'max_air_temp_pst1hr': max_air_temp_pst1hr, 
            'max_rel_hum_pst1hr':max_rel_hum_pst1hr,
            'min_rel_hum_pst1hr':min_rel_hum_pst1hr,
            'stn_pres':stn_pres,
             'mslp':mslp,
            'pcpn_amt_pst1hr':pcpn_amt_pst1hr,
            'avg_wnd_spd_10m_pst10mts':avg_wnd_spd_10m_pst10mts,
            'wnd_dir_10m_pst1hr_max_spd':wnd_dir_10m_pst1hr_max_spd,
            'max_wnd_spd_10m_pst1hr':max_wnd_spd_10m_pst1hr,
            'avg_snw_dpth_pst5mts_1':avg_snw_dpth_pst5mts_1,
            'avg_snw_dpth_pst5mts_2':avg_snw_dpth_pst5mts_2,
            'avg_snw_dpth_pst5mts_3':avg_snw_dpth_pst5mts_3

           } 

    
    for key,value in data_dict.items(): 
        if not value:
            data_dict[key] = 'NaN'
            
    data= pd.DataFrame(data_dict)
    os.makedirs('D:/Utilisateurs/guillaume/Documents/GitHub/Python_XML/SWOB/'+now.strftime(&quot;%Y%m&quot;)+'/', exist_ok=True)  

       # file = 'D:/Utilisateurs/guillaume/Documents/GitHub/Python_XML/SWOB/'+now.strftime(&quot;%Y%m&quot;)+'/'+str(int(row['WMO_ID']))+'_'+now.strftime(&quot;%Y%m&quot;)+'.csv'
    file = 'D:/Utilisateurs/guillaume/Documents/GitHub/Python_XML/SWOB/'+now.strftime(&quot;%Y%m&quot;)+'/'+str(row['MSC_ID'])+'_'+now.strftime(&quot;%Y%m&quot;)+'.csv'
    if exists(file):
        #print (&quot;File exist&quot;)
        data.to_csv(r'D:/Utilisateurs/guillaume/Documents/GitHub/Python_XML/SWOB/'+now.strftime(&quot;%Y%m&quot;)+'/'+str(row['MSC_ID'])+'_'+now.strftime(&quot;%Y%m&quot;)+'.csv',mode='a',index=False,header=False) 
    else:
        #print (&quot;File not exist&quot;)
        pd.DataFrame(row).T.to_csv(r'D:/Utilisateurs/guillaume/Documents/GitHub/Python_XML/SWOB/'+now.strftime(&quot;%Y%m&quot;)+'/'+str(row['MSC_ID'])+'_'+now.strftime(&quot;%Y%m&quot;)+'.csv',index=False)  
        data.to_csv(r'D:/Utilisateurs/guillaume/Documents/GitHub/Python_XML/SWOB/'+now.strftime(&quot;%Y%m&quot;)+'/'+str(row['MSC_ID'])+'_'+now.strftime(&quot;%Y%m&quot;)+'.csv',mode='a',index=False)  
</code></pre>

<h3 id="4-we-will-trace-the-location-of-the-stations">4- We will trace the location of the stations:</h3>

<p>We will start by extracting the latitudes and longitudes:</p>

<pre><code class="language-python">list_lat = stations.loc[stations[&quot;AUTO/MAN&quot;]=='AUTO',:]['Latitude'].values
list_lon = stations.loc[stations[&quot;AUTO/MAN&quot;]=='AUTO',:]['Longitude'].values
</code></pre>

<pre><code class="language-python">import cartopy.crs as ccrs
import cartopy.feature as cfeature
import matplotlib.pylab as plt
import numpy as np

fig = plt.figure(figsize=(28,16))   
ax = plt.axes(projection=ccrs.PlateCarree())
ax.set_extent((-150.0, -50, 40, 90))

ax.add_feature(cfeature.OCEAN.with_scale('50m'))      # couche ocean
ax.add_feature(cfeature.LAND.with_scale('50m'))       # couche land
ax.add_feature(cfeature.LAKES.with_scale('50m'))      # couche lac

ax.add_feature(cfeature.BORDERS.with_scale('50m'))    # couche frontieres
ax.add_feature(cfeature.RIVERS.with_scale('50m'))     # couche rivières      
coast = cfeature.NaturalEarthFeature(category='physical', scale='10m',     # ajout de la couche cotière 
                    facecolor='none', name='coastline')
ax.add_feature(coast, edgecolor='black')
states_provinces = cfeature.NaturalEarthFeature(
    category='cultural',
    name='admin_1_states_provinces_lines',
    scale='10m',
    facecolor='none')

ax.add_feature(states_provinces, edgecolor='gray')  

ax.gridlines()           
mm = ax.scatter(list_lon, list_lat, c='red', s=100, label='SWOB Met-ML MSC')
#mm = ax.scatter(dfstat['lon'].values, dfstat['lat'].values, c='green', s=400, label='Site')

plt.legend(loc=&quot;best&quot;, markerscale=1., scatterpoints=1, fontsize=40)
          
# Define gridline locations and draw the lines using cartopy's built-in gridliner:
xticks = np.arange(-150.0,-40.0,20)
yticks =np.arange(10,80,10)     
fig.canvas.draw()
 
plt.savefig('Localisation_SWOB_CANADA.png', bbox_inches='tight', pad_inches=0.1)
plt.show()  
plt.close()
</code></pre>

<p><img src="output_32_0.png" alt="png" /></p>

<h3 id="5-just-over-quebec">5-  Just over Quebec:</h3>

<pre><code class="language-python">list_lat = stations.loc[(stations[&quot;AUTO/MAN&quot;]=='AUTO') &amp; (stations[&quot;Province/Territory&quot;]=='Quebec'),:]['Latitude'].values
list_lon = stations.loc[(stations[&quot;AUTO/MAN&quot;]=='AUTO') &amp; (stations[&quot;Province/Territory&quot;]=='Quebec'),:]['Longitude'].values
</code></pre>

<pre><code class="language-python">import cartopy.crs as ccrs
import cartopy.feature as cfeature
import matplotlib.pylab as plt
import numpy as np

fig = plt.figure(figsize=(28,16))   
ax = plt.axes(projection=ccrs.PlateCarree())
ax.set_extent((-80.0, -50, 40, 70))

ax.add_feature(cfeature.OCEAN.with_scale('50m'))      # couche ocean
ax.add_feature(cfeature.LAND.with_scale('50m'))       # couche land
ax.add_feature(cfeature.LAKES.with_scale('50m'))      # couche lac

ax.add_feature(cfeature.BORDERS.with_scale('50m'))    # couche frontieres
ax.add_feature(cfeature.RIVERS.with_scale('50m'))     # couche rivières      
coast = cfeature.NaturalEarthFeature(category='physical', scale='10m',     # ajout de la couche cotière 
                    facecolor='none', name='coastline')
ax.add_feature(coast, edgecolor='black')
states_provinces = cfeature.NaturalEarthFeature(
    category='cultural',
    name='admin_1_states_provinces_lines',
    scale='10m',
    facecolor='none')

ax.add_feature(states_provinces, edgecolor='gray')  

ax.gridlines()           
mm = ax.scatter(list_lon, list_lat, c='red', s=100, label='SWOB Met-ML MSC')
#mm = ax.scatter(dfstat['lon'].values, dfstat['lat'].values, c='green', s=400, label='Site')

plt.legend(loc=&quot;best&quot;, markerscale=1., scatterpoints=1, fontsize=40)
          
# Define gridline locations and draw the lines using cartopy's built-in gridliner:
xticks = np.arange(-150.0,-40.0,20)
yticks =np.arange(10,80,10)     
fig.canvas.draw()
 
plt.savefig('Localisation_SWOB_Quebec.png', bbox_inches='tight', pad_inches=0.1)
plt.show()  
plt.close()
</code></pre>

<p><img src="output_35_0.png" alt="png" /></p>

<h3 id="6-if-we-want-to-plot-by-grouping-by-province">6-  If we want to plot by grouping by province:</h3>

<p>We only want the &ldquo;Automatic&rdquo; stations and group them by province.</p>

<pre><code class="language-python">grouped_dataframe = stations.loc[stations[&quot;AUTO/MAN&quot;]=='AUTO',:].groupby('Province/Territory')
grouped_dataframe.count()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Province/Territory</th>
<th align="right">IATA_ID</th>
<th align="right">Name</th>
<th align="right">WMO_ID</th>
<th align="right">MSC_ID</th>
<th align="right">Latitude</th>
<th align="right">Longitude</th>
<th align="right">Elevation(m)</th>
<th align="right">Data_Provider</th>
<th align="right">Dataset/Network</th>
<th align="right">AUTO/MAN</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">Alberta</td>
<td align="right">240</td>
<td align="right">240</td>
<td align="right">196</td>
<td align="right">240</td>
<td align="right">240</td>
<td align="right">240</td>
<td align="right">240</td>
<td align="right">240</td>
<td align="right">240</td>
<td align="right">240</td>
</tr>

<tr>
<td align="left">British Columbia</td>
<td align="right">119</td>
<td align="right">119</td>
<td align="right">101</td>
<td align="right">119</td>
<td align="right">119</td>
<td align="right">119</td>
<td align="right">119</td>
<td align="right">119</td>
<td align="right">119</td>
<td align="right">119</td>
</tr>

<tr>
<td align="left">Manitoba</td>
<td align="right">47</td>
<td align="right">47</td>
<td align="right">44</td>
<td align="right">47</td>
<td align="right">47</td>
<td align="right">47</td>
<td align="right">47</td>
<td align="right">47</td>
<td align="right">47</td>
<td align="right">47</td>
</tr>

<tr>
<td align="left">New Brunswick</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="right">20</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="right">21</td>
</tr>

<tr>
<td align="left">Newfoundland and Labrador</td>
<td align="right">36</td>
<td align="right">36</td>
<td align="right">34</td>
<td align="right">36</td>
<td align="right">36</td>
<td align="right">36</td>
<td align="right">36</td>
<td align="right">36</td>
<td align="right">36</td>
<td align="right">36</td>
</tr>

<tr>
<td align="left">Northwest Territories</td>
<td align="right">49</td>
<td align="right">49</td>
<td align="right">34</td>
<td align="right">49</td>
<td align="right">49</td>
<td align="right">49</td>
<td align="right">49</td>
<td align="right">49</td>
<td align="right">49</td>
<td align="right">49</td>
</tr>

<tr>
<td align="left">Nova Scotia</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">39</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">42</td>
</tr>

<tr>
<td align="left">Nunavut</td>
<td align="right">63</td>
<td align="right">63</td>
<td align="right">52</td>
<td align="right">63</td>
<td align="right">63</td>
<td align="right">63</td>
<td align="right">63</td>
<td align="right">63</td>
<td align="right">63</td>
<td align="right">63</td>
</tr>

<tr>
<td align="left">Ontario</td>
<td align="right">111</td>
<td align="right">111</td>
<td align="right">103</td>
<td align="right">111</td>
<td align="right">111</td>
<td align="right">111</td>
<td align="right">111</td>
<td align="right">111</td>
<td align="right">111</td>
<td align="right">111</td>
</tr>

<tr>
<td align="left">Prince Edward Island</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
</tr>

<tr>
<td align="left">Quebec</td>
<td align="right">122</td>
<td align="right">122</td>
<td align="right">103</td>
<td align="right">122</td>
<td align="right">122</td>
<td align="right">122</td>
<td align="right">122</td>
<td align="right">122</td>
<td align="right">122</td>
<td align="right">122</td>
</tr>

<tr>
<td align="left">Saskatchewan</td>
<td align="right">57</td>
<td align="right">57</td>
<td align="right">56</td>
<td align="right">57</td>
<td align="right">57</td>
<td align="right">57</td>
<td align="right">57</td>
<td align="right">57</td>
<td align="right">57</td>
<td align="right">57</td>
</tr>

<tr>
<td align="left">Yukon</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">17</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">23</td>
<td align="right">23</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">for name,group in grouped_dataframe:
   print(name) 
</code></pre>

<pre><code>Alberta
British Columbia
Manitoba
New Brunswick
Newfoundland and Labrador
Northwest Territories
Nova Scotia
Nunavut
Ontario
Prince Edward Island
Quebec
Saskatchewan
Yukon
</code></pre>

<pre><code class="language-python">grouped_dataframe.get_group('Quebec').head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">IATA_ID</th>
<th align="left">Name</th>
<th align="right">WMO_ID</th>
<th align="left">MSC_ID</th>
<th align="right">Latitude</th>
<th align="right">Longitude</th>
<th align="right">Elevation(m)</th>
<th align="left">Data_Provider</th>
<th align="left">Dataset/Network</th>
<th align="left">AUTO/MAN</th>
<th align="left">Province/Territory</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">48</td>
<td align="left">CGAH</td>
<td align="left">LA GRANDE IV</td>
<td align="right">71823</td>
<td align="left">7093GJ5</td>
<td align="right">53.75</td>
<td align="right">-73.6828</td>
<td align="right">306.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">49</td>
<td align="left">CGBC</td>
<td align="left">BAIE-COMEAU</td>
<td align="right">71890</td>
<td align="left">7040442</td>
<td align="right">49.1351</td>
<td align="right">-68.2024</td>
<td align="right">22.6</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">50</td>
<td align="left">CGCH</td>
<td align="left">CHIBOUGAMAU-CHAPAIS</td>
<td align="right">73011</td>
<td align="left">7091410</td>
<td align="right">49.7773</td>
<td align="right">-74.5304</td>
<td align="right">389.3</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">51</td>
<td align="left">CGCL</td>
<td align="left">CAUSAPSCAL AIRPORT</td>
<td align="right">73005</td>
<td align="left">7051201</td>
<td align="right">48.3088</td>
<td align="right">-67.2528</td>
<td align="right">123</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>

<tr>
<td align="right">52</td>
<td align="left">CGGA</td>
<td align="left">GASPE AIRPORT</td>
<td align="right">73116</td>
<td align="left">7052603</td>
<td align="right">48.7833</td>
<td align="right">-64.4833</td>
<td align="right">40</td>
<td align="left">MSC</td>
<td align="left">CA</td>
<td align="left">AUTO</td>
<td align="left">Quebec</td>
</tr>
</tbody>
</table>

<p>We create a random color list for all of our provinces.</p>

<pre><code class="language-python">import random
number_of_colors = len(grouped_dataframe)
color = [&quot;#&quot;+''.join([random.choice('0123456789ABCDEF') for j in range(6)])
             for i in range(number_of_colors)]
</code></pre>

<pre><code class="language-python">import cartopy.crs as ccrs
import cartopy.feature as cfeature
import matplotlib.pylab as plt
import numpy as np


fig = plt.figure(figsize=(28,16))   
ax = plt.axes(projection=ccrs.PlateCarree())
ax.set_extent((-150.0, -50, 40, 90))

ax.add_feature(cfeature.OCEAN.with_scale('50m'))      # couche ocean
ax.add_feature(cfeature.LAND.with_scale('50m'))       # couche land
ax.add_feature(cfeature.LAKES.with_scale('50m'))      # couche lac

ax.add_feature(cfeature.BORDERS.with_scale('50m'))    # couche frontieres
ax.add_feature(cfeature.RIVERS.with_scale('50m'))     # couche rivières      
coast = cfeature.NaturalEarthFeature(category='physical', scale='10m',     # ajout de la couche cotière 
                    facecolor='none', name='coastline')
ax.add_feature(coast, edgecolor='black')
states_provinces = cfeature.NaturalEarthFeature(
    category='cultural',
    name='admin_1_states_provinces_lines',
    scale='10m',
    facecolor='none')

ax.add_feature(states_provinces, edgecolor='gray')  

ax.gridlines()
i = 0 
for name,group in grouped_dataframe:
    list_lon= grouped_dataframe.get_group(name)['Longitude'].values
    list_lat= grouped_dataframe.get_group(name)['Latitude'].values
    
    mm = ax.scatter(list_lon, list_lat, c=color[i], s=100, label='SWOB Met-ML MSC: '+ name  )
    plt.legend(loc=&quot;best&quot;, markerscale=1., scatterpoints=1, fontsize=10)
    i+=1

# Define gridline locations and draw the lines using cartopy's built-in gridliner:
xticks = np.arange(-150.0,-40.0,20)
yticks =np.arange(10,80,10)     
fig.canvas.draw()
 
plt.savefig('Localisation_SWOB_CANADA.png', bbox_inches='tight', pad_inches=0.1)
plt.show()  
plt.close()
</code></pre>

<p><img src="output_42_0.png" alt="png" /></p>

<pre><code class="language-python">
</code></pre>

<pre><code class="language-python">
</code></pre>

<pre><code class="language-python">
</code></pre>

    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/ecc_swob_stations/&amp;text=ECCC%20SWOB%20Stations" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/ecc_swob_stations/&amp;t=ECCC%20SWOB%20Stations" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=ECCC%20SWOB%20Stations&amp;body=/post/ecc_swob_stations/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/ecc_swob_stations/&amp;title=ECCC%20SWOB%20Stations" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=ECCC%20SWOB%20Stations%20/post/ecc_swob_stations/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/ecc_swob_stations/&amp;title=ECCC%20SWOB%20Stations" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hued2496a182fbb6fc8c711157078d29a6_5348924_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Guillaume Dueymes</a></h5>
      <h6 class="card-subtitle">Data Scientist and Research Assistant</h6>
      <p class="card-text">My research interests include data science, data management and climate science.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Guillaume_Dueymes" target="_blank" rel="noopener">
        <i class="fab fa-researchgate"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/guimeto" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
