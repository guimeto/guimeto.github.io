<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Guillaume Dueymes">

  
  
  
    
  
  <meta name="description" content="Extract daily temperature from Environment Canada using Python The objective of this product is to retrieve daily temperature data from the second generation homogenized dataset of Environment and Climate Change Canada developed by Vincent et al. 2012.
Adjusted and homogenized Canadian climate dataset (DCCAH) were prepared to provide a better spatial and temporal representation of the climate trends in Canada.
In the Second Generation of Homogenized Temperature, new adjustments were applied to the daily minimum temperatures at synoptic stations (mainly airports) to address the bias due to the change in observing time in July 1961 (Vincent et al.">

  
  <link rel="alternate" hreflang="en-us" href="/post/eccc_temp/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/eccc_temp/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="GDueymes">
  <meta property="og:url" content="/post/eccc_temp/">
  <meta property="og:title" content="ECCC homogenized dataset | GDueymes">
  <meta property="og:description" content="Extract daily temperature from Environment Canada using Python The objective of this product is to retrieve daily temperature data from the second generation homogenized dataset of Environment and Climate Change Canada developed by Vincent et al. 2012.
Adjusted and homogenized Canadian climate dataset (DCCAH) were prepared to provide a better spatial and temporal representation of the climate trends in Canada.
In the Second Generation of Homogenized Temperature, new adjustments were applied to the daily minimum temperatures at synoptic stations (mainly airports) to address the bias due to the change in observing time in July 1961 (Vincent et al."><meta property="og:image" content="/post/eccc_temp/featured.jpg">
  <meta property="twitter:image" content="/post/eccc_temp/featured.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-12-06T19:50:39-08:00">
    
    <meta property="article:modified_time" content="2019-12-06T19:50:39-08:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/eccc_temp/"
  },
  "headline": "ECCC homogenized dataset",
  
  "image": [
    "/post/eccc_temp/featured.jpg"
  ],
  
  "datePublished": "2019-12-06T19:50:39-08:00",
  "dateModified": "2019-12-06T19:50:39-08:00",
  
  "author": {
    "@type": "Person",
    "name": "Guillaume Dueymes"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "GDueymes",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/icon-512.png"
    }
  },
  "description": "Extract daily temperature from Environment Canada using Python The objective of this product is to retrieve daily temperature data from the second generation homogenized dataset of Environment and Climate Change Canada developed by Vincent et al. 2012.\nAdjusted and homogenized Canadian climate dataset (DCCAH) were prepared to provide a better spatial and temporal representation of the climate trends in Canada.\nIn the Second Generation of Homogenized Temperature, new adjustments were applied to the daily minimum temperatures at synoptic stations (mainly airports) to address the bias due to the change in observing time in July 1961 (Vincent et al."
}
</script>

  

  


  


  





  <title>ECCC homogenized dataset | GDueymes</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">GDueymes</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Guillaume_Dueymes2019.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>ECCC homogenized dataset</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Dec 6, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  

  
  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 360px;">
  <div style="position: relative">
    <img src="/post/eccc_temp/featured_hud8ea7a49e8a1f32c574d7de110b22f60_104695_720x0_resize_q90_lanczos.jpg" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h2 id="extract-daily-temperature-from-environment-canada-using-python">Extract daily temperature from Environment Canada using Python</h2>
<p>The objective of this product is to retrieve daily temperature data from the second generation homogenized dataset of Environment and Climate Change Canada developed by Vincent et al. 2012.</p>
<p>Adjusted and homogenized Canadian climate dataset (DCCAH) were prepared to provide a better spatial and temporal representation of the climate trends in Canada.</p>
<p>In the Second Generation of Homogenized Temperature, new adjustments were applied to the daily minimum temperatures at synoptic stations (mainly airports) to address the bias due to the change in observing time in July 1961 (Vincent et al. 2009).</p>
<p>Daily homogenized temperatures (minimum, maximum and mean) can be dowloaded on this <a href="ftp://ccrp.tor.ec.gc.ca/pub/EC_data/AHCCD_daily/">link</a>.</p>
<p>Raw dataset can be downloaded <a href="http://climate.weather.gc.ca/historical_data/search_historic_data_f.html">here</a>.</p>
<p>In this post, we will work on a specific province in Canada (using filters). To do this, we will use  Temperature_Stations.xls available on ftp site. This file provide us a list of all stations available.</p>
<p>We first need to import our librairies:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> os
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> date
<span style="color:#f92672">import</span> calendar
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pathlib
<span style="color:#f92672">import</span> warnings
warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">ignore</span><span style="color:#e6db74">&#34;</span>)
<span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> islice
</code></pre></div><p>We will work with daily minimum temperature data only for the Northwest Territories of Canada.</p>
<p>Referring to the document Temperature_Stations.xls, we see that the acronym for this province is: NWT.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dataframe <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">./Temperature_Stations.xls</span><span style="color:#e6db74">&#34;</span>, skiprows <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>))
dataframe<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2018</td>
<td align="right">9</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="right">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>
<p>Using this Dataframe we can define some input parameters to filter our data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">varin <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dn</span><span style="color:#e6db74">&#39;</span>                          <span style="color:#75715e"># variable acronym                                                                  </span>
path <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Homog_daily_min_temp_v2018</span><span style="color:#e6db74">&#39;</span>   <span style="color:#75715e"># path to get data                                       </span>
varout <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Tasmin</span><span style="color:#e6db74">&#39;</span>                      
province <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">NWT</span><span style="color:#e6db74">&#39;</span>                      <span style="color:#75715e"># Province to work with</span>
</code></pre></div><p>We can now filter our dataset.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">globals()[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dataframe_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province] <span style="color:#f92672">=</span> dataframe<span style="color:#f92672">.</span>loc[(dataframe[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Prov</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">==</span> province),:]
globals()[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dataframe_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province]
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">65</td>
<td align="left">NWT</td>
<td align="left">CAPE PARRY</td>
<td align="left">2200675</td>
<td align="right">1957</td>
<td align="right">5</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">70.17</td>
<td align="right">-124.72</td>
<td align="right">87</td>
<td align="left">N</td>
</tr>
<tr>
<td align="right">66</td>
<td align="left">NWT</td>
<td align="left">FORT GOOD HOPE</td>
<td align="left">2201450</td>
<td align="right">1944</td>
<td align="right">8</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">66.23</td>
<td align="right">-128.65</td>
<td align="right">82</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">68</td>
<td align="left">NWT</td>
<td align="left">FORT RELIANCE</td>
<td align="left">2201903</td>
<td align="right">1948</td>
<td align="right">10</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">62.72</td>
<td align="right">-109.17</td>
<td align="right">168</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">69</td>
<td align="left">NWT</td>
<td align="left">FORT SIMPSON</td>
<td align="left">2202103</td>
<td align="right">1895</td>
<td align="right">11</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">61.77</td>
<td align="right">-121.23</td>
<td align="right">169</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">70</td>
<td align="left">NWT</td>
<td align="left">FORT SMITH</td>
<td align="left">2202201</td>
<td align="right">1913</td>
<td align="right">7</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">60.02</td>
<td align="right">-111.97</td>
<td align="right">205</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">71</td>
<td align="left">NWT</td>
<td align="left">HAY RIVER</td>
<td align="left">2202401</td>
<td align="right">1893</td>
<td align="right">9</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">60.83</td>
<td align="right">-115.78</td>
<td align="right">166</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">72</td>
<td align="left">NWT</td>
<td align="left">INUVIK</td>
<td align="left">2202578</td>
<td align="right">1957</td>
<td align="right">3</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">68.3</td>
<td align="right">-133.48</td>
<td align="right">103</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">73</td>
<td align="left">NWT</td>
<td align="left">MOULD BAY</td>
<td align="left">250M001</td>
<td align="right">1948</td>
<td align="right">5</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">76.23</td>
<td align="right">-119.35</td>
<td align="right">2</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">74</td>
<td align="left">NWT</td>
<td align="left">NORMAN WELLS</td>
<td align="left">2202801</td>
<td align="right">1943</td>
<td align="right">5</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">65.28</td>
<td align="right">-126.8</td>
<td align="right">73</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">75</td>
<td align="left">NWT</td>
<td align="left">SACHS HARBOUR</td>
<td align="left">2503648</td>
<td align="right">1955</td>
<td align="right">11</td>
<td align="right">2018</td>
<td align="right">8</td>
<td align="right">72</td>
<td align="right">-125.27</td>
<td align="right">86</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">76</td>
<td align="left">NWT</td>
<td align="left">TUKTOYAKTUK</td>
<td align="left">2203914</td>
<td align="right">1957</td>
<td align="right">6</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">69.45</td>
<td align="right">-133</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="right">77</td>
<td align="left">NWT</td>
<td align="left">YELLOWKNIFE</td>
<td align="left">2204101</td>
<td align="right">1942</td>
<td align="right">7</td>
<td align="right">2018</td>
<td align="right">12</td>
<td align="right">62.47</td>
<td align="right">-114.43</td>
<td align="right">206</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>
<p>We found 13 stations for this province.</p>
<p>We want to work with YELLOWKNIFE station:  stnid = 2204101.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stnid <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">2204101</span><span style="color:#e6db74">&#39;</span>   
f1 <span style="color:#f92672">=</span> open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>path<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>str(varin)<span style="color:#f92672">+</span>str(stnid)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.txt</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> islice(f1, <span style="color:#ae81ff">7</span>):
        <span style="color:#66d9ef">print</span>(line)
</code></pre></div><pre><code>2204101,    YELLOWKNIFE    ,  NWT, station joined    , Homogenized daily minimum temperature        , Deg Celcius,          Updated to December 2018

2204101,    YELLOWKNIFE    ,  NWT, station jointe    , Temperature quotidienne minimale homogeneisee, Deg Celcius, Mise a jour jusqu a decembre 2018

 Year Mo  Day 01  Day 02  Day 03  Day 04  Day 05  Day 06  Day 07  Day 08  Day 09  Day 10  Day 11  Day 12  Day 13  Day 14  Day 15  Day 16  Day 17  Day 18  Day 19  Day 20  Day 21  Day 22  Day 23  Day 24  Day 25  Day 26  Day 27  Day 28  Day 29  Day 30  Day 31

Annee Mo Jour 01 Jour 02 Jour 03 Jour 04 Jour 05 Jour 06 Jour 07 Jour 08 Jour 09 Jour 10 Jour 11 Jour 12 Jour 13 Jour 14 Jour 15 Jour 16 Jour 17 Jour 18 Jour 19 Jour 20 Jour 21 Jour 22 Jour 23 Jour 24 Jour 25 Jour 26 Jour 27 Jour 28 Jour 29 Jour 30 Jour 31

 1942  7    12.2    13.3    11.7    10.0     9.4    11.7    14.4    14.4    13.3    12.2    10.6    11.7    11.1    12.8    14.4    15.0    13.9    14.4    13.9    14.4    13.9    13.3    11.7    12.2    11.1    12.2    13.3    10.0    10.6    11.7     8.3 

 1942  8     7.8     5.0     9.4    12.8     9.4     9.4    10.0    10.6    12.8    10.6    12.2    12.2     9.4    15.0    12.8    11.7    14.4    14.4    11.7     8.3     9.4     7.8    12.2     8.9     3.9     7.2    10.6    11.1     7.2     5.0     3.3 

 1942  9     3.9     6.1     6.1     8.3     9.4    11.1    11.1     6.7     6.1     9.4     5.0     9.4     7.2     4.4     5.0     4.4     3.3     1.1     2.2    -0.6    -2.2     0.0    -1.7     1.1    -4.4    -0.6     0.0    -0.6     1.7     1.1 -9999.9M
</code></pre>
<h3 id="cleaning-data">Cleaning data:</h3>
<p>We see that in our dataset we have for each line the daily data by year and by month according to the structure:</p>
<!-- raw HTML omitted -->
<p>There is a 4 rows header. We will delete this header and also delete the alphanumeric characters, clean the missing values and create a dataframe.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f1 <span style="color:#f92672">=</span> open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>path<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>str(varin)<span style="color:#f92672">+</span>str(stnid)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.txt</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;</span>)
f2 <span style="color:#f92672">=</span> open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./tmp.txt</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">w</span><span style="color:#e6db74">&#39;</span>)
<span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f1:
    <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> line:
            <span style="color:#66d9ef">if</span> word <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>:
                f2<span style="color:#f92672">.</span>write(word<span style="color:#f92672">.</span>replace(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#39;</span>))
            <span style="color:#66d9ef">elif</span> word <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span>:
                f2<span style="color:#f92672">.</span>write(word<span style="color:#f92672">.</span>replace(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#39;</span>))                    
            <span style="color:#66d9ef">else</span>:
                f2<span style="color:#f92672">.</span>write(word)
f1<span style="color:#f92672">.</span>close()
f2<span style="color:#f92672">.</span>close()      
df_station <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./tmp.txt</span><span style="color:#e6db74">&#39;</span>, delim_whitespace<span style="color:#f92672">=</span>True, skiprows <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>))
df_station<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="right">1942</th>
<th align="right">7</th>
<th align="right">12.2</th>
<th align="right">13.3</th>
<th align="right">11.7</th>
<th align="right">10.0</th>
<th align="right">9.4</th>
<th align="right">11.7.1</th>
<th align="right">14.4</th>
<th align="right">14.4.1</th>
<th align="right">13.3.1</th>
<th align="right">12.2.1</th>
<th align="right">10.6</th>
<th align="right">11.7.2</th>
<th align="right">11.1</th>
<th align="right">12.8</th>
<th align="right">14.4.2</th>
<th align="right">15.0</th>
<th align="right">13.9</th>
<th align="right">14.4.3</th>
<th align="right">13.9.1</th>
<th align="right">14.4.4</th>
<th align="right">13.9.2</th>
<th align="right">13.3.2</th>
<th align="right">11.7.3</th>
<th align="right">12.2.2</th>
<th align="right">11.1.1</th>
<th align="right">12.2.3</th>
<th align="right">13.3.3</th>
<th align="right">10.0.1</th>
<th align="right">10.6.1</th>
<th align="right">11.7.4</th>
<th align="right">8.3</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">1942</td>
<td align="right">8</td>
<td align="right">7.8</td>
<td align="right">5</td>
<td align="right">9.4</td>
<td align="right">12.8</td>
<td align="right">9.4</td>
<td align="right">9.4</td>
<td align="right">10</td>
<td align="right">10.6</td>
<td align="right">12.8</td>
<td align="right">10.6</td>
<td align="right">12.2</td>
<td align="right">12.2</td>
<td align="right">9.4</td>
<td align="right">15</td>
<td align="right">12.8</td>
<td align="right">11.7</td>
<td align="right">14.4</td>
<td align="right">14.4</td>
<td align="right">11.7</td>
<td align="right">8.3</td>
<td align="right">9.4</td>
<td align="right">7.8</td>
<td align="right">12.2</td>
<td align="right">8.9</td>
<td align="right">3.9</td>
<td align="right">7.2</td>
<td align="right">10.6</td>
<td align="right">11.1</td>
<td align="right">7.2</td>
<td align="right">5</td>
<td align="right">3.3</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">1942</td>
<td align="right">9</td>
<td align="right">3.9</td>
<td align="right">6.1</td>
<td align="right">6.1</td>
<td align="right">8.3</td>
<td align="right">9.4</td>
<td align="right">11.1</td>
<td align="right">11.1</td>
<td align="right">6.7</td>
<td align="right">6.1</td>
<td align="right">9.4</td>
<td align="right">5</td>
<td align="right">9.4</td>
<td align="right">7.2</td>
<td align="right">4.4</td>
<td align="right">5</td>
<td align="right">4.4</td>
<td align="right">3.3</td>
<td align="right">1.1</td>
<td align="right">2.2</td>
<td align="right">-0.6</td>
<td align="right">-2.2</td>
<td align="right">0</td>
<td align="right">-1.7</td>
<td align="right">1.1</td>
<td align="right">-4.4</td>
<td align="right">-0.6</td>
<td align="right">0</td>
<td align="right">-0.6</td>
<td align="right">1.7</td>
<td align="right">1.1</td>
<td align="right">-9999.9</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">1942</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">4.4</td>
<td align="right">1.7</td>
<td align="right">5</td>
<td align="right">3.3</td>
<td align="right">-1.1</td>
<td align="right">4.4</td>
<td align="right">2.2</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">5</td>
<td align="right">0.6</td>
<td align="right">-2.8</td>
<td align="right">-1.1</td>
<td align="right">2.8</td>
<td align="right">-1.1</td>
<td align="right">-1.1</td>
<td align="right">2.8</td>
<td align="right">0.6</td>
<td align="right">-2.8</td>
<td align="right">-2.8</td>
<td align="right">-6.7</td>
<td align="right">-10.6</td>
<td align="right">-11.1</td>
<td align="right">-7.2</td>
<td align="right">-2.2</td>
<td align="right">-1.7</td>
<td align="right">-1.1</td>
<td align="right">-3.9</td>
<td align="right">-5</td>
<td align="right">-8.3</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">1942</td>
<td align="right">11</td>
<td align="right">-11.7</td>
<td align="right">-13.9</td>
<td align="right">-13.3</td>
<td align="right">-12.8</td>
<td align="right">-12.8</td>
<td align="right">-12.8</td>
<td align="right">-12.2</td>
<td align="right">-17.8</td>
<td align="right">-12.2</td>
<td align="right">-21.1</td>
<td align="right">-16.1</td>
<td align="right">-16.1</td>
<td align="right">-17.8</td>
<td align="right">-11.1</td>
<td align="right">-22.2</td>
<td align="right">-25</td>
<td align="right">-25</td>
<td align="right">-22.8</td>
<td align="right">-17.8</td>
<td align="right">-23.9</td>
<td align="right">-26.7</td>
<td align="right">-13.9</td>
<td align="right">-18.3</td>
<td align="right">-26.7</td>
<td align="right">-32.2</td>
<td align="right">-31.1</td>
<td align="right">-34.4</td>
<td align="right">-26.7</td>
<td align="right">-30</td>
<td align="right">-27.2</td>
<td align="right">-9999.9</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">1942</td>
<td align="right">12</td>
<td align="right">-23.9</td>
<td align="right">-20.6</td>
<td align="right">-20.6</td>
<td align="right">-25</td>
<td align="right">-20.6</td>
<td align="right">-20.6</td>
<td align="right">-26.1</td>
<td align="right">-27.8</td>
<td align="right">-30</td>
<td align="right">-31.1</td>
<td align="right">-28.9</td>
<td align="right">-23.9</td>
<td align="right">-25</td>
<td align="right">-31.1</td>
<td align="right">-33.9</td>
<td align="right">-37.2</td>
<td align="right">-37.8</td>
<td align="right">-38.9</td>
<td align="right">-40.6</td>
<td align="right">-39.4</td>
<td align="right">-33.3</td>
<td align="right">-35</td>
<td align="right">-35.6</td>
<td align="right">-33.9</td>
<td align="right">-26.1</td>
<td align="right">-31.7</td>
<td align="right">-34.4</td>
<td align="right">-28.9</td>
<td align="right">-24.4</td>
<td align="right">-33.9</td>
<td align="right">-40.6</td>
</tr>
</tbody>
</table>
<p>That's better but we still have some missing values. We will also change column names.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df_station<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Year</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Month</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D1</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D2</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D3</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D4</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D5</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D6</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D7</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D8</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D9</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D10</span><span style="color:#e6db74">&#39;</span>,
                                  <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D11</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D12</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D13</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D14</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D15</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D16</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D17</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D18</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D19</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D20</span><span style="color:#e6db74">&#39;</span>,
                                  <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D21</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D22</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D23</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D24</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D25</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D26</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D27</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D28</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D29</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D30</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D31</span><span style="color:#e6db74">&#39;</span>]
     
os<span style="color:#f92672">.</span>remove(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">./tmp.txt</span><span style="color:#e6db74">&#34;</span>)
   
   <span style="color:#75715e"># nettoyage des valeurs manquantes </span>
<span style="color:#66d9ef">try</span>:  
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">E</span><span style="color:#e6db74">&#39;</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">try</span>: 
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">try</span>:     
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-9999.9</span><span style="color:#e6db74">&#39;</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
<span style="color:#66d9ef">try</span>:     
    df_station <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>replace({<span style="color:#f92672">-</span><span style="color:#ae81ff">9999.9</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>    
    
<span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span>  df_station<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">2</span>:]:
       df_station[col] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_numeric(df_station[col], errors<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">coerce</span><span style="color:#e6db74">&#39;</span>)      
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df_station<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Year</th>
<th align="right">Month</th>
<th align="right">D1</th>
<th align="right">D2</th>
<th align="right">D3</th>
<th align="right">D4</th>
<th align="right">D5</th>
<th align="right">D6</th>
<th align="right">D7</th>
<th align="right">D8</th>
<th align="right">D9</th>
<th align="right">D10</th>
<th align="right">D11</th>
<th align="right">D12</th>
<th align="right">D13</th>
<th align="right">D14</th>
<th align="right">D15</th>
<th align="right">D16</th>
<th align="right">D17</th>
<th align="right">D18</th>
<th align="right">D19</th>
<th align="right">D20</th>
<th align="right">D21</th>
<th align="right">D22</th>
<th align="right">D23</th>
<th align="right">D24</th>
<th align="right">D25</th>
<th align="right">D26</th>
<th align="right">D27</th>
<th align="right">D28</th>
<th align="right">D29</th>
<th align="right">D30</th>
<th align="right">D31</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">1942</td>
<td align="right">8</td>
<td align="right">7.8</td>
<td align="right">5</td>
<td align="right">9.4</td>
<td align="right">12.8</td>
<td align="right">9.4</td>
<td align="right">9.4</td>
<td align="right">10</td>
<td align="right">10.6</td>
<td align="right">12.8</td>
<td align="right">10.6</td>
<td align="right">12.2</td>
<td align="right">12.2</td>
<td align="right">9.4</td>
<td align="right">15</td>
<td align="right">12.8</td>
<td align="right">11.7</td>
<td align="right">14.4</td>
<td align="right">14.4</td>
<td align="right">11.7</td>
<td align="right">8.3</td>
<td align="right">9.4</td>
<td align="right">7.8</td>
<td align="right">12.2</td>
<td align="right">8.9</td>
<td align="right">3.9</td>
<td align="right">7.2</td>
<td align="right">10.6</td>
<td align="right">11.1</td>
<td align="right">7.2</td>
<td align="right">5</td>
<td align="right">3.3</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">1942</td>
<td align="right">9</td>
<td align="right">3.9</td>
<td align="right">6.1</td>
<td align="right">6.1</td>
<td align="right">8.3</td>
<td align="right">9.4</td>
<td align="right">11.1</td>
<td align="right">11.1</td>
<td align="right">6.7</td>
<td align="right">6.1</td>
<td align="right">9.4</td>
<td align="right">5</td>
<td align="right">9.4</td>
<td align="right">7.2</td>
<td align="right">4.4</td>
<td align="right">5</td>
<td align="right">4.4</td>
<td align="right">3.3</td>
<td align="right">1.1</td>
<td align="right">2.2</td>
<td align="right">-0.6</td>
<td align="right">-2.2</td>
<td align="right">0</td>
<td align="right">-1.7</td>
<td align="right">1.1</td>
<td align="right">-4.4</td>
<td align="right">-0.6</td>
<td align="right">0</td>
<td align="right">-0.6</td>
<td align="right">1.7</td>
<td align="right">1.1</td>
<td align="right">-9999.9</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">1942</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">4.4</td>
<td align="right">1.7</td>
<td align="right">5</td>
<td align="right">3.3</td>
<td align="right">-1.1</td>
<td align="right">4.4</td>
<td align="right">2.2</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">5</td>
<td align="right">0.6</td>
<td align="right">-2.8</td>
<td align="right">-1.1</td>
<td align="right">2.8</td>
<td align="right">-1.1</td>
<td align="right">-1.1</td>
<td align="right">2.8</td>
<td align="right">0.6</td>
<td align="right">-2.8</td>
<td align="right">-2.8</td>
<td align="right">-6.7</td>
<td align="right">-10.6</td>
<td align="right">-11.1</td>
<td align="right">-7.2</td>
<td align="right">-2.2</td>
<td align="right">-1.7</td>
<td align="right">-1.1</td>
<td align="right">-3.9</td>
<td align="right">-5</td>
<td align="right">-8.3</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">1942</td>
<td align="right">11</td>
<td align="right">-11.7</td>
<td align="right">-13.9</td>
<td align="right">-13.3</td>
<td align="right">-12.8</td>
<td align="right">-12.8</td>
<td align="right">-12.8</td>
<td align="right">-12.2</td>
<td align="right">-17.8</td>
<td align="right">-12.2</td>
<td align="right">-21.1</td>
<td align="right">-16.1</td>
<td align="right">-16.1</td>
<td align="right">-17.8</td>
<td align="right">-11.1</td>
<td align="right">-22.2</td>
<td align="right">-25</td>
<td align="right">-25</td>
<td align="right">-22.8</td>
<td align="right">-17.8</td>
<td align="right">-23.9</td>
<td align="right">-26.7</td>
<td align="right">-13.9</td>
<td align="right">-18.3</td>
<td align="right">-26.7</td>
<td align="right">-32.2</td>
<td align="right">-31.1</td>
<td align="right">-34.4</td>
<td align="right">-26.7</td>
<td align="right">-30</td>
<td align="right">-27.2</td>
<td align="right">-9999.9</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">1942</td>
<td align="right">12</td>
<td align="right">-23.9</td>
<td align="right">-20.6</td>
<td align="right">-20.6</td>
<td align="right">-25</td>
<td align="right">-20.6</td>
<td align="right">-20.6</td>
<td align="right">-26.1</td>
<td align="right">-27.8</td>
<td align="right">-30</td>
<td align="right">-31.1</td>
<td align="right">-28.9</td>
<td align="right">-23.9</td>
<td align="right">-25</td>
<td align="right">-31.1</td>
<td align="right">-33.9</td>
<td align="right">-37.2</td>
<td align="right">-37.8</td>
<td align="right">-38.9</td>
<td align="right">-40.6</td>
<td align="right">-39.4</td>
<td align="right">-33.3</td>
<td align="right">-35</td>
<td align="right">-35.6</td>
<td align="right">-33.9</td>
<td align="right">-26.1</td>
<td align="right">-31.7</td>
<td align="right">-34.4</td>
<td align="right">-28.9</td>
<td align="right">-24.4</td>
<td align="right">-33.9</td>
<td align="right">-40.6</td>
</tr>
</tbody>
</table>
<p>We can now detect the minimum and maximum recording years and write the daily data on a single column.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">yearmin <span style="color:#f92672">=</span> df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Year</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>min()                                  
yearmax <span style="color:#f92672">=</span> df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Year</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>max()                                   
m_start <span style="color:#f92672">=</span>  df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Month</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>loc[(df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Year</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">==</span> yearmin)]<span style="color:#f92672">.</span>min()
m_end   <span style="color:#f92672">=</span>  df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Month</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>loc[(df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Year</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">==</span> yearmax)]<span style="color:#f92672">.</span>max()
d_end <span style="color:#f92672">=</span> calendar<span style="color:#f92672">.</span>monthrange(yearmax, m_end)[<span style="color:#ae81ff">1</span>]                     

tmp_tmin <span style="color:#f92672">=</span> [ ] 
<span style="color:#66d9ef">for</span> year <span style="color:#f92672">in</span> range(yearmin,yearmax<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):    <span style="color:#75715e">### Loop over years</span>
    <span style="color:#66d9ef">for</span> month <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>):
        df <span style="color:#f92672">=</span> []
        last_day <span style="color:#f92672">=</span> calendar<span style="color:#f92672">.</span>monthrange(year, month)[<span style="color:#ae81ff">1</span>] 
        tmin <span style="color:#f92672">=</span> df_station<span style="color:#f92672">.</span>loc[(df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Year</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">==</span> year) <span style="color:#f92672">&amp;</span> (df_station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Month</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">==</span> month)]<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">2</span>:last_day<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>values
           
        <span style="color:#66d9ef">if</span> len(tmin) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty((calendar<span style="color:#f92672">.</span>monthrange(year,month)[<span style="color:#ae81ff">1</span>]))
            a[:] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
            df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(a)
        <span style="color:#66d9ef">else</span>:
            df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(tmin<span style="color:#f92672">.</span>T)
               
        start <span style="color:#f92672">=</span> date(year, month, <span style="color:#ae81ff">1</span>)
        end <span style="color:#f92672">=</span>   date(year, month, last_day)
        delta<span style="color:#f92672">=</span>(end<span style="color:#f92672">-</span>start) 
        nb_days <span style="color:#f92672">=</span> delta<span style="color:#f92672">.</span>days <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> 
        rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(start, periods<span style="color:#f92672">=</span>nb_days, freq<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D</span><span style="color:#e6db74">&#39;</span>)          
        df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> rng
        df<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>]
        tmp_tmin<span style="color:#f92672">.</span>append(df)
           
tmp_tmin <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(tmp_tmin) 
df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>: tmp_tmin[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>], <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Var</span><span style="color:#e6db74">&#39;</span>: tmp_tmin<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>]}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Tmin</span><span style="color:#e6db74">&#39;</span>]) 
df<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>]
tmp_tmin <span style="color:#f92672">=</span> tmp_tmin<span style="color:#f92672">.</span>drop([<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#34;</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
tmp_tmin<span style="color:#f92672">.</span>tail()
</code></pre></div><table>
<thead>
<tr>
<th align="left">datetime</th>
<th align="right">0</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">2018-12-27 00:00:00</td>
<td align="right">-32.6</td>
</tr>
<tr>
<td align="left">2018-12-28 00:00:00</td>
<td align="right">-33.3</td>
</tr>
<tr>
<td align="left">2018-12-29 00:00:00</td>
<td align="right">-27.7</td>
</tr>
<tr>
<td align="left">2018-12-30 00:00:00</td>
<td align="right">-35.2</td>
</tr>
<tr>
<td align="left">2018-12-31 00:00:00</td>
<td align="right">-33.8</td>
</tr>
</tbody>
</table>
<h3 id="visualization">Visualization:</h3>
<p>Quick visualization of the monthly average temperatures for the month of January.
We will group the data by month and calculate the average.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pylab <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> datetime
month_tmin <span style="color:#f92672">=</span> tmp_tmin<span style="color:#f92672">.</span>resample(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>mean()
month_tmin<span style="color:#f92672">.</span>tail()
</code></pre></div><table>
<thead>
<tr>
<th align="left">datetime</th>
<th align="right">0</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">2018-08-31 00:00:00</td>
<td align="right">8.9871</td>
</tr>
<tr>
<td align="left">2018-09-30 00:00:00</td>
<td align="right">-0.673333</td>
</tr>
<tr>
<td align="left">2018-10-31 00:00:00</td>
<td align="right">-4.99032</td>
</tr>
<tr>
<td align="left">2018-11-30 00:00:00</td>
<td align="right">-15.5233</td>
</tr>
<tr>
<td align="left">2018-12-31 00:00:00</td>
<td align="right">-21.8129</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tmin_janvier <span style="color:#f92672">=</span> month_tmin[month_tmin<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>]
tmin_janvier<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="left">datetime</th>
<th align="right">0</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1942-01-31 00:00:00</td>
<td align="right">nan</td>
</tr>
<tr>
<td align="left">1943-01-31 00:00:00</td>
<td align="right">-32.6871</td>
</tr>
<tr>
<td align="left">1944-01-31 00:00:00</td>
<td align="right">-25.471</td>
</tr>
<tr>
<td align="left">1945-01-31 00:00:00</td>
<td align="right">-28.6355</td>
</tr>
<tr>
<td align="left">1946-01-31 00:00:00</td>
<td align="right">-33.4032</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">figure.figsize</span><span style="color:#e6db74">&#34;</span>]<span style="color:#f92672">=</span>[<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>]        
plt<span style="color:#f92672">.</span>plot(tmin_janvier<span style="color:#f92672">.</span>index, tmin_janvier[:],  label<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Tmin Station</span><span style="color:#e6db74">&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, c<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Monthly mean of daily minimum temperature: January from </span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>date(yearmin, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%</span><span style="color:#e6db74">Y</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> et </span><span style="color:#e6db74">&#39;</span>  <span style="color:#f92672">+</span> datetime<span style="color:#f92672">.</span>date(yearmax, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%</span><span style="color:#e6db74">Y</span><span style="color:#e6db74">&#39;</span>), fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Year</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">°C</span><span style="color:#e6db74">&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">black</span><span style="color:#e6db74">&#39;</span>, weight<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">semibold</span><span style="color:#e6db74">&#39;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="output_20_0.png" alt="png"></p>
<h2 id="final-code">Final code</h2>
<p>The following code retrieves all stations for a specific province but for a common period.</p>
<p>For example, we wish to extract all daily temperature data for the province of the Northwest Territories but only for the common period 1989-2018.</p>
<p>We wish to have one file per station.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> os
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> date
<span style="color:#f92672">import</span> calendar
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pathlib

<span style="color:#75715e">################################################                                                            #</span>
varin <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dn</span><span style="color:#e6db74">&#39;</span>                                                                  
path <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Homog_daily_min_temp_v2018</span><span style="color:#e6db74">&#39;</span>                                           
varout <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Tasmoy</span><span style="color:#e6db74">&#39;</span>
province <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">NWT</span><span style="color:#e6db74">&#39;</span>  
yearmin <span style="color:#f92672">=</span> <span style="color:#ae81ff">1989</span> 
yearmax <span style="color:#f92672">=</span> <span style="color:#ae81ff">2018</span>
<span style="color:#75715e">###############################################################################</span>

dataframe <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">./Temperature_Stations.xls</span><span style="color:#e6db74">&#34;</span>, skiprows <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>))

globals()[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dataframe_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province] <span style="color:#f92672">=</span> dataframe<span style="color:#f92672">.</span>loc[(dataframe[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Prov</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">==</span> province) <span style="color:#f92672">&amp;</span> (dataframe[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">année déb.</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> yearmin) <span style="color:#f92672">&amp;</span> (dataframe[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">année fin.</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">&gt;</span><span style="color:#f92672">=</span> yearmax),:]

names <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> globals()[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dataframe_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province]<span style="color:#f92672">.</span>iterrows():
   stnid <span style="color:#f92672">=</span> row[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">stnid</span><span style="color:#e6db74">&#39;</span>]   
   f1 <span style="color:#f92672">=</span> open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>path<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>str(varin)<span style="color:#f92672">+</span>str(stnid)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.txt</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;</span>)
   f2 <span style="color:#f92672">=</span> open(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./tmp.txt</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">w</span><span style="color:#e6db74">&#39;</span>)

   <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f1:
        <span style="color:#66d9ef">for</span> word <span style="color:#f92672">in</span> line:
            <span style="color:#66d9ef">if</span> word <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>:
                f2<span style="color:#f92672">.</span>write(word<span style="color:#f92672">.</span>replace(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#39;</span>))
            <span style="color:#66d9ef">elif</span> word <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span>:
                f2<span style="color:#f92672">.</span>write(word<span style="color:#f92672">.</span>replace(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#39;</span>))                    
            <span style="color:#66d9ef">else</span>:
                f2<span style="color:#f92672">.</span>write(word)
   f1<span style="color:#f92672">.</span>close()
   f2<span style="color:#f92672">.</span>close()
          
   station <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./tmp.txt</span><span style="color:#e6db74">&#39;</span>, delim_whitespace<span style="color:#f92672">=</span>True, skiprows <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>))
   
   station<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annee</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Mois</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D1</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D2</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D3</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D4</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D5</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D6</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D7</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D8</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D9</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D10</span><span style="color:#e6db74">&#39;</span>,
                                  <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D11</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D12</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D13</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D14</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D15</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D16</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D17</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D18</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D19</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D20</span><span style="color:#e6db74">&#39;</span>,
                                  <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D21</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D22</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D23</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D24</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D25</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D26</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D27</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D28</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D29</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D30</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D31</span><span style="color:#e6db74">&#39;</span>]
     
   os<span style="color:#f92672">.</span>remove(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">./tmp.txt</span><span style="color:#e6db74">&#34;</span>)
 
   <span style="color:#66d9ef">try</span>:  
       station <span style="color:#f92672">=</span> station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">E</span><span style="color:#e6db74">&#39;</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
   <span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
   <span style="color:#66d9ef">try</span>: 
       station <span style="color:#f92672">=</span> station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
   <span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
   <span style="color:#66d9ef">try</span>:     
       station <span style="color:#f92672">=</span> station<span style="color:#f92672">.</span>replace({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-9999.9</span><span style="color:#e6db74">&#39;</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
   <span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>
   <span style="color:#66d9ef">try</span>:     
       station <span style="color:#f92672">=</span> station<span style="color:#f92672">.</span>replace({<span style="color:#f92672">-</span><span style="color:#ae81ff">9999.9</span>:<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>}, regex<span style="color:#f92672">=</span>True)
   <span style="color:#66d9ef">except</span>:
       <span style="color:#66d9ef">pass</span>    
       
   <span style="color:#66d9ef">for</span> col <span style="color:#f92672">in</span>  station<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">2</span>:]:
       station[col] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_numeric(station[col], errors<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">coerce</span><span style="color:#e6db74">&#39;</span>)
        
   m_start <span style="color:#f92672">=</span>  station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Mois</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>loc[(station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annee</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">==</span> yearmin)]<span style="color:#f92672">.</span>min()
   m_end   <span style="color:#f92672">=</span>  station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Mois</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>loc[(station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Annee</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">==</span> yearmax)]<span style="color:#f92672">.</span>max()
   
   d_end <span style="color:#f92672">=</span> calendar<span style="color:#f92672">.</span>monthrange(yearmax, m_end)[<span style="color:#ae81ff">1</span>]
     
   tmp_tmin <span style="color:#f92672">=</span> [ ] 
   <span style="color:#66d9ef">for</span> year <span style="color:#f92672">in</span> range(yearmin,yearmax<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):    <span style="color:#75715e">### Boucle sur les annees</span>
       <span style="color:#66d9ef">for</span> month <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>):
           df <span style="color:#f92672">=</span> []
           last_day <span style="color:#f92672">=</span> calendar<span style="color:#f92672">.</span>monthrange(year, month)[<span style="color:#ae81ff">1</span>] 
           tmin <span style="color:#f92672">=</span> station<span style="color:#f92672">.</span>loc[(station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Annee</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">==</span> year) <span style="color:#f92672">&amp;</span> (station[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Mois</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">==</span> month)]<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">2</span>:last_day<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>values
           
           <span style="color:#66d9ef">if</span> len(tmin) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
               a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty((calendar<span style="color:#f92672">.</span>monthrange(year,month)[<span style="color:#ae81ff">1</span>]))
               a[:] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
               df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(a)
           <span style="color:#66d9ef">else</span>:
               df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(tmin<span style="color:#f92672">.</span>T)
               
           start <span style="color:#f92672">=</span> date(year, month, <span style="color:#ae81ff">1</span>)
           end <span style="color:#f92672">=</span>   date(year, month, last_day)
           delta<span style="color:#f92672">=</span>(end<span style="color:#f92672">-</span>start) 
           nb_days <span style="color:#f92672">=</span> delta<span style="color:#f92672">.</span>days <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> 
           rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(start, periods<span style="color:#f92672">=</span>nb_days, freq<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D</span><span style="color:#e6db74">&#39;</span>)          
           df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> rng
           df<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>]
           tmp_tmin<span style="color:#f92672">.</span>append(df)
           
   tmp_tmin <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat(tmp_tmin) 
   df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>: tmp_tmin[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>], <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Var</span><span style="color:#e6db74">&#39;</span>: tmp_tmin<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>]}, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Tmin</span><span style="color:#e6db74">&#39;</span>]) 
   df<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> df[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#39;</span>]
   tmp_tmin <span style="color:#f92672">=</span> tmp_tmin<span style="color:#f92672">.</span>drop([<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">datetime</span><span style="color:#e6db74">&#34;</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
      
   name <span style="color:#f92672">=</span> row[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Nom de station</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>replace(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> </span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_</span><span style="color:#e6db74">&#39;</span>)
   name <span style="color:#f92672">=</span> name<span style="color:#f92672">.</span>replace(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#34;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span>)
   names<span style="color:#f92672">.</span>append(name)
   mypath<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./Daily_data_by_Province/</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>varout<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/</span><span style="color:#e6db74">&#39;</span>
   pathlib<span style="color:#f92672">.</span>Path(mypath)<span style="color:#f92672">.</span>mkdir(parents<span style="color:#f92672">=</span>True, exist_ok<span style="color:#f92672">=</span>True)
   
   tmp_tmin<span style="color:#f92672">.</span>to_csv(mypath<span style="color:#f92672">+</span>name<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_daily_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>varout<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>str(yearmin)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">-</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>str(yearmax)<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.csv</span><span style="color:#e6db74">&#39;</span>)
         
latlon <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Latitude</span><span style="color:#e6db74">&#39;</span>: globals()[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dataframe_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province][<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">lat (deg)</span><span style="color:#e6db74">&#34;</span>], <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Longitude</span><span style="color:#e6db74">&#39;</span>: globals()[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dataframe_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province][<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">long (deg)</span><span style="color:#e6db74">&#34;</span>] }, columns <span style="color:#f92672">=</span> [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Latitude</span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Longitude</span><span style="color:#e6db74">&#39;</span>]) 
latlon<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./Daily_data_by_Province/stations_latlon_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.csv</span><span style="color:#e6db74">&#39;</span>)
names <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(names)
names<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./Daily_data_by_Province/stations_noms_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.csv</span><span style="color:#e6db74">&#39;</span>)

base_filename <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./Daily_data_by_Province/stations_noms_</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">+</span>province<span style="color:#f92672">+</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.txt</span><span style="color:#e6db74">&#39;</span>
names[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>to_csv(base_filename, sep<span style="color:#f92672">=</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span>, index <span style="color:#f92672">=</span> False) 
</code></pre></div>
    </div>

    







<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/eccc_temp/&amp;text=ECCC%20homogenized%20dataset" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/eccc_temp/&amp;t=ECCC%20homogenized%20dataset" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=ECCC%20homogenized%20dataset&amp;body=/post/eccc_temp/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/eccc_temp/&amp;title=ECCC%20homogenized%20dataset" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=ECCC%20homogenized%20dataset%20/post/eccc_temp/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/eccc_temp/&amp;title=ECCC%20homogenized%20dataset" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hued2496a182fbb6fc8c711157078d29a6_5348924_250x250_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Guillaume Dueymes</a></h5>
      <h6 class="card-subtitle">Data Scientist and Research Assistant</h6>
      <p class="card-text">My research interests include data science, data management and climate science.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.researchgate.net/profile/Guillaume_Dueymes" target="_blank" rel="noopener">
        <i class="fab fa-researchgate"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/guimeto" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  



  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
