<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Guillaume Dueymes">

  
  
  
    
  
  <meta name="description" content="Pandas is a library specialized in data manipulation. This library contains a set of optimized functions for handling large datasets. It allows to create and export tables of data from text files (separators, .csv, fixed format, compressed), binary (HDF5 with Pytable), HTML, XML, JSON, MongoDB, SQL &hellip;
A new data structure is used with this library: the DataFrame. There are two types of data with pandas: series and dataframes.">

  
  <link rel="alternate" hreflang="en-us" href="/courses/tutorial_python/7-pandas_library/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/courses/tutorial_python/7-pandas_library/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="GDueymes">
  <meta property="og:url" content="/courses/tutorial_python/7-pandas_library/">
  <meta property="og:title" content="7 Pandas library | GDueymes">
  <meta property="og:description" content="Pandas is a library specialized in data manipulation. This library contains a set of optimized functions for handling large datasets. It allows to create and export tables of data from text files (separators, .csv, fixed format, compressed), binary (HDF5 with Pytable), HTML, XML, JSON, MongoDB, SQL &hellip;
A new data structure is used with this library: the DataFrame. There are two types of data with pandas: series and dataframes."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-05T00:00:00&#43;01:00">
    
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  

  



  


  


  





  <title>7 Pandas library | GDueymes</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">GDueymes</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Guillaume_Dueymes2019.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/tutorial_python/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/tutorial_python/1-python_basics/">Python tutorial</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/tutorial_python/1-python_basics/">1 Python basics</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/2-lists_in_python/">2 List in Python</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/3-flow_control/">3 Flow control</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/4-functions/">4 Functions</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/5-dictionaries/">5 Dictionaries</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/6-numpy_library/">6 Numpy library</a>
      </li>
      
      <li class="active">
        <a href="/courses/tutorial_python/7-pandas_library/">7 Pandas library</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/8-matplotlib_library/">8 Matplotlib library</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/project1-eccc_temperature/">Project 1 ECCC temperature data</a>
      </li>
      
      <li >
        <a href="/courses/tutorial_python/project2-eccc_precipitation/">Project 2 ECCC precipitation data</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#7-1-series-introduction">7.1 Series introduction  -</a></li>
<li><a href="#7-2-pandas-dataframes">7.2 Pandas Dataframes</a>
<ul>
<li><a href="#7-2-1-create-a-dataframe">7.2.1  Create a  Dataframe</a></li>
<li><a href="#b-create-dataframe-loading-csv-file-b-read-table-b-or-b-read-csv-b-function">- b) Create Dataframe loading csv file: <b>read_table()</b> or <b>read_csv()</b> function</a></li>
<li><a href="#b-c-b-create-dataframe-loading-ascii-file"><b>- c)</b> Create Dataframe loading ascii file:</a></li>
<li><a href="#b-d-b-create-dataframe-loading-excell-xls-file-b-read-excel-b-function"><b>- d)</b> Create Dataframe loading excell (.xls) file: <b>read_excel()</b> function</a></li>
<li><a href="#7-2-2-access-data-from-dataframes">7.2.2  Access data from DataFrames</a></li>
<li><a href="#7-2-3-change-a-dataframe">7.2.3  Change a Dataframe</a>
<ul>
<li><a href="#a-create-a-new-variable">a- Create a new variable</a></li>
<li><a href="#b-row-addition">b-  Row Addition</a></li>
<li><a href="#c-row-deletion">c-  Row Deletion</a></li>
</ul></li>
<li><a href="#7-2-3-3-merging-joining-dataframe">7.2.3.3 Merging/Joining Dataframe-</a>
<ul>
<li><a href="#a-merge-two-dataframes-on-a-key">a-  Merge Two DataFrames on a Key</a></li>
<li><a href="#b-merge-two-dataframes-on-a-key">b-  Merge Two DataFrames on a Key</a></li>
<li><a href="#c-merge-two-dataframes-using-how-argument">c-  Merge Two DataFrames Using &lsquo;How&rsquo; argument</a></li>
</ul></li>
<li><a href="#7-2-3-4-dataframe-concatenation">7.2.3.4  Dataframe Concatenation-</a>
<ul>
<li><a href="#concatenating-using-append">Concatenating Using append</a></li>
</ul></li>
<li><a href="#7-2-4-basic-functionality-on-dataframe">7.2.4  Basic Functionality on DataFrame</a></li>
<li><a href="#7-2-5-dataframe-function-application">7.2.5  DataFrame Function Application</a></li>
<li><a href="#7-2-6-dataframe-groupby-method">7.2.6  DataFrame GroupBY method</a>
<ul>
<li><a href="#split-data-into-groups">Split Data into Groups:</a></li>
</ul></li>
<li><a href="#iterating-through-groups">Iterating through Groups:</a>
<ul>
<li><a href="#select-a-group">Select a group:</a></li>
<li><a href="#aggregations">Aggregations</a></li>
<li><a href="#applying-multiple-aggregation-functions-at-once">Applying Multiple Aggregation Functions at Once</a></li>
<li><a href="#transformations">Transformations</a></li>
<li><a href="#filtration">Filtration</a></li>
</ul></li>
<li><a href="#7-2-7-save-a-dataframe">7.2.7  Save a DataFrame:</a></li>
<li><a href="#7-3-date-functionality">7.3 Date Functionality:</a></li>
<li><a href="#7-4-format-dates-with-the-datetime-module">7.4 Format dates with the Datetime module:</a>
<ul>
<li><a href="#1-the-b-datetime-b-class-of-the-datetime-module">1-  The <b> datetime </b> class of the datetime module</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>7 Pandas library</h1>

          <div class="article-style">
            

<p><img src="/img/pandas.png" alt="image0" /></p>

<p>Pandas is a library specialized in data manipulation. This library contains a set of optimized functions for handling large datasets. It allows to create and export tables of data from text files (separators, .csv, fixed format, compressed), binary (HDF5 with Pytable), HTML, XML, JSON, MongoDB, SQL &hellip;</p>

<p>A new data structure is used with this library: the DataFrame. There are two types of data with pandas: <b>series</b> and <b>dataframes</b>.</p>

<ul>
<li>a dataframe is an array that is created with dictionaries or lists</li>
<li>they are based on Numpy or ndarray tables</li>
<li>they can have column and line names</li>

<li><p>they have the particularity of being able to mix the types of data: str, float, Nan, Int &hellip;</p></li>

<li><p>they can be viewed as an excel sheet but with a larger number of data volumes and a larger number of functions and attributes.</p></li>
</ul>

<h2 id="7-1-series-introduction">7.1 Series introduction  -</h2>

<p>Series is a one-dimensional labeled array capable of holding data of any type (integer, string, float, python objects, etc.). The axis labels are collectively called index.</p>

<pre><code class="language-python"># first, we must import Pandas library
import pandas as pd      # aliasing as pd
import warnings; warnings.filterwarnings(action='ignore')
</code></pre>

<p>A pandas Series can be created using the following constructor:</p>

<pre><code class="language-python">serie = pd.Series([11,15,12,13,14])
print(serie)
</code></pre>

<pre><code>0    11
1    15
2    12
3    13
4    14
dtype: int64
</code></pre>

<p>We have in series, indexes and values. These indexes can be replaced by text with the index option. Be careful, the number of indexes must correspond to the number of values.</p>

<pre><code class="language-python">serie = pd.Series([11,15,12,13,14], index=[&quot;Montreal&quot;, &quot;Ottawa&quot;, &quot;Toronto&quot;, &quot;Gatineau&quot;, &quot;Quebec&quot;])
</code></pre>

<pre><code class="language-python">print(serie)
</code></pre>

<pre><code>Montreal    11
Ottawa      15
Toronto     12
Gatineau    13
Quebec      14
dtype: int64
</code></pre>

<p>The describe() method computes a summary of statistic</p>

<pre><code class="language-python">serie.describe()
</code></pre>

<pre><code>count     5.000000
mean     13.000000
std       1.581139
min      11.000000
25%      12.000000
50%      13.000000
75%      14.000000
max      15.000000
dtype: float64
</code></pre>

<p>We can use index to access to an element.</p>

<pre><code class="language-python">serie[&quot;Montreal&quot;]
</code></pre>

<pre><code>11
</code></pre>

<p>We can use index number.</p>

<pre><code class="language-python">serie[3]
</code></pre>

<pre><code>13
</code></pre>

<p>We can use several indexes.</p>

<pre><code class="language-python">serie[[&quot;Montreal&quot;, &quot;Quebec&quot;, &quot;Toronto&quot;]]
</code></pre>

<pre><code>Montreal    11
Quebec      14
Toronto     12
dtype: int64
</code></pre>

<p>There are large number of methods collectively compute descriptive statistics such as min(), max(), sum() &hellip;</p>

<pre><code class="language-python">serie.min()
</code></pre>

<pre><code>11
</code></pre>

<pre><code class="language-python">serie.max()
</code></pre>

<pre><code>15
</code></pre>

<p>We can apply comparison operators.</p>

<pre><code class="language-python">serie[serie&gt;12]
</code></pre>

<pre><code>Ottawa      15
Gatineau    13
Québec      14
dtype: int64
</code></pre>

<pre><code class="language-python">serie&gt;12 
</code></pre>

<pre><code>Montréal    False
Ottawa       True
Toronto     False
Gatineau     True
Québec       True
dtype: bool
</code></pre>

<h2 id="7-2-pandas-dataframes">7.2 Pandas Dataframes</h2>

<p>Pandas DataFrame is two-dimensional size-mutable, potentially heterogeneous tabular data structure with labeled axes (rows and columns). A Data frame is a two-dimensional data structure, i.e., data is aligned in a tabular fashion in rows and columns. Pandas DataFrame consists of three principal components, the data, rows, and columns.</p>

<h3 id="7-2-1-create-a-dataframe">7.2.1  Create a  Dataframe</h3>

<p>In the real world, a Pandas DataFrame will be created by loading the datasets from existing storage, storage can be SQL Database, CSV file, and Excel file. Pandas DataFrame can be created from the lists, dictionary, and from a list of dictionary etc. Dataframe can be created in different ways here are some ways by which we create a dataframe:</p>

<p>### - a) Using a Numpy array</p>

<pre><code class="language-python">import numpy as np  
stations = np.genfromtxt(&quot;./DATA/DATA_Barrage_1963_2017_5.csv&quot;, delimiter=&quot;,&quot;, dtype='float')   
stations
</code></pre>

<pre><code>array([[  39.7       ,   39.09      ,   39.55645161,   23.23      ,
          22.5       ,   22.85903226, 2390.52612903, 3164.97      ,
        1673.8       ],
       [  41.16      ,   40.96      ,   41.08806452,   23.22      ,
          22.43      ,   22.7583871 , 2227.28290323, 3008.18      ,
        1697.87      ],
       [  41.15      ,   41.05      ,   41.11322581,   23.35      ,
          22.87      ,   23.15548387, 2851.27419355, 3231.8       ,
        2367.85      ],
       [  41.09      ,   40.61      ,   40.9683871 ,   23.78      ,
          22.7       ,   23.03258065, 2635.03774194, 3967.33      ,
        2069.65      ],
       [  41.09      ,   39.6       ,   40.26967742,   24.24      ,
          22.87      ,   23.64580645, 3924.23451613, 5407.32      ,
        2417.89      ]])
</code></pre>

<p>To create the dataframe, we use the Pandas <b> DataFrame () </b> function. It is at this stage that we define the names of our columns. In input we put the table Numpy.</p>

<pre><code class="language-python">dataframe = pd.DataFrame(stations, columns=[&quot;Amont Max&quot;, &quot;Amont Min&quot;, &quot;Amont Mean&quot;, &quot;Aval Max&quot;, &quot;Aval Max&quot;, &quot;Aval Mean&quot;, &quot;Debit Mean&quot;, &quot;Debit Max&quot;,&quot;Debit Min&quot;])
dataframe
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Amont Max</th>
<th align="right">Amont Min</th>
<th align="right">Amont Mean</th>
<th align="right">Aval Max</th>
<th align="right">Aval Max</th>
<th align="right">Aval Mean</th>
<th align="right">Debit Mean</th>
<th align="right">Debit Max</th>
<th align="right">Debit Min</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">39.7</td>
<td align="right">39.09</td>
<td align="right">39.5565</td>
<td align="right">23.23</td>
<td align="right">22.5</td>
<td align="right">22.859</td>
<td align="right">2390.53</td>
<td align="right">3164.97</td>
<td align="right">1673.8</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">41.16</td>
<td align="right">40.96</td>
<td align="right">41.0881</td>
<td align="right">23.22</td>
<td align="right">22.43</td>
<td align="right">22.7584</td>
<td align="right">2227.28</td>
<td align="right">3008.18</td>
<td align="right">1697.87</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">41.15</td>
<td align="right">41.05</td>
<td align="right">41.1132</td>
<td align="right">23.35</td>
<td align="right">22.87</td>
<td align="right">23.1555</td>
<td align="right">2851.27</td>
<td align="right">3231.8</td>
<td align="right">2367.85</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">41.09</td>
<td align="right">40.61</td>
<td align="right">40.9684</td>
<td align="right">23.78</td>
<td align="right">22.7</td>
<td align="right">23.0326</td>
<td align="right">2635.04</td>
<td align="right">3967.33</td>
<td align="right">2069.65</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">41.09</td>
<td align="right">39.6</td>
<td align="right">40.2697</td>
<td align="right">24.24</td>
<td align="right">22.87</td>
<td align="right">23.6458</td>
<td align="right">3924.23</td>
<td align="right">5407.32</td>
<td align="right">2417.89</td>
</tr>
</tbody>
</table>

<h3 id="b-create-dataframe-loading-csv-file-b-read-table-b-or-b-read-csv-b-function">- b) Create Dataframe loading csv file: <b>read_table()</b> or <b>read_csv()</b> function</h3>

<ul>
<li><b> read_table () </b> and <b> read_csv () </b> are the most useful functions under Pandas for reading text files and generating a DataFrame.</li>
</ul>

<p>We will work with a dataset from a hydraulic dam.
Our csv file has 9 variables, the first line gives us the names of the variables (or labels).</p>

<p>A csv document can be read with the <b> read_table () </b> function, with the separator attribute &ldquo;,&rdquo;.</p>

<pre><code class="language-python">barrage = pd.read_table(&quot;./DATA/DATA_EXTREME_Carillon_1963_2017_5.csv&quot;, sep=&quot;,&quot;)
barrage.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Amont_max</th>
<th align="right">Amont_min</th>
<th align="right">Amont_moyen</th>
<th align="right">Aval_max</th>
<th align="right">Aval_min</th>
<th align="right">Aval_moyen</th>
<th align="right">Debit_Moyen</th>
<th align="right">Debit_max</th>
<th align="right">Debit_min</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">39.7</td>
<td align="right">39.09</td>
<td align="right">39.5565</td>
<td align="right">23.23</td>
<td align="right">22.5</td>
<td align="right">22.859</td>
<td align="right">2390.53</td>
<td align="right">3164.97</td>
<td align="right">1673.8</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">41.16</td>
<td align="right">40.96</td>
<td align="right">41.0881</td>
<td align="right">23.22</td>
<td align="right">22.43</td>
<td align="right">22.7584</td>
<td align="right">2227.28</td>
<td align="right">3008.18</td>
<td align="right">1697.87</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">41.15</td>
<td align="right">41.05</td>
<td align="right">41.1132</td>
<td align="right">23.35</td>
<td align="right">22.87</td>
<td align="right">23.1555</td>
<td align="right">2851.27</td>
<td align="right">3231.8</td>
<td align="right">2367.85</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">41.09</td>
<td align="right">40.61</td>
<td align="right">40.9684</td>
<td align="right">23.78</td>
<td align="right">22.7</td>
<td align="right">23.0326</td>
<td align="right">2635.04</td>
<td align="right">3967.33</td>
<td align="right">2069.65</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">41.09</td>
<td align="right">39.6</td>
<td align="right">40.2697</td>
<td align="right">24.24</td>
<td align="right">22.87</td>
<td align="right">23.6458</td>
<td align="right">3924.23</td>
<td align="right">5407.32</td>
<td align="right">2417.89</td>
</tr>
</tbody>
</table>

<p>However, if we know that our file to read is a csv, we can use a simpler function of Pandas which is <b> read_csv () </b>.</p>

<p>No need to use sep=&rdquo; option. He will find the separator by default.</p>

<pre><code class="language-python">help(pd.read_csv)
</code></pre>

<p>Several options are available to the read_csv () function. It is important to know the list of possibilities and options offered by this simple command.</p>

<p>|  |  |
|&ndash;|&ndash;|
| <b>path</b> | Path to our file |
| <b>sep</b>| Delimiter like , ; \t or \s+ for a variable number of spaces |
| <b>header</b>| default 0, the first line contains the name of the variables; if None the names are generated or defined later |
| <b>index_col</b>| Names or numbers of columns defining the indexes of lines, indexes which can be hierarchized |
| <b>names</b>| If header = None, list of variable names |
| <b>nrows</b>| Useful for testing and limiting the number of lines to read |
| <b>skiprow</b>| List of lines to jump in reading |
| <b>skip_footer</b>| Number of lines to jump at the end of file |
| <b>na_values</b>| Definition of the code or codes signaling missing values. They can be defined in a dictionary to associate variables and codes specific missing values |
| <b>usecols</b>| Selects a list of variables to read to avoid reading large or unnecessary fields or variables |
| <b>skip_blank_lines</b>| If <b> True </b>, we skip the white lines |
| <b>thousand</b>| Separator: &ldquo;.&rdquo; or &ldquo;,&rdquo; |</p>

<pre><code class="language-python"># Using example

file1 = &quot;./DATA/DATA_EXTREME_Carillon_1963_2017_5.csv&quot;
col_names = ['Variable1', 'Variable2', 'Variable3']
df2 = pd.read_csv(file1, skiprows=1, usecols=[0, 1, 3], names=col_names)
</code></pre>

<pre><code class="language-python">df2.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Variable1</th>
<th align="right">Variable2</th>
<th align="right">Variable3</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">39.7</td>
<td align="right">39.09</td>
<td align="right">23.23</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">41.16</td>
<td align="right">40.96</td>
<td align="right">23.22</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">41.15</td>
<td align="right">41.05</td>
<td align="right">23.35</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">41.09</td>
<td align="right">40.61</td>
<td align="right">23.78</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">41.09</td>
<td align="right">39.6</td>
<td align="right">24.24</td>
</tr>
</tbody>
</table>

<h3 id="b-c-b-create-dataframe-loading-ascii-file"><b>- c)</b> Create Dataframe loading ascii file:</h3>

<pre><code class="language-python">with open('./DATA/Daily_Precipitation_1963-2017.txt', 'r') as file:
        rows = file.read() 
</code></pre>

<pre><code class="language-python">with open('./DATA/Daily_Precipitation_1963-2017.txt', 'r') as file:
        rows = file.read()      
dataset = [float(row) for row in rows.split()]   
df3 = pd.DataFrame({&quot;Precipitation&quot; : dataset})
</code></pre>

<pre><code class="language-python">df3.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Precipitation</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">5</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">6</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">7</td>
<td align="right">0</td>
</tr>

<tr>
<td align="right">8</td>
<td align="right">1.3</td>
</tr>
</tbody>
</table>

<h3 id="b-d-b-create-dataframe-loading-excell-xls-file-b-read-excel-b-function"><b>- d)</b> Create Dataframe loading excell (.xls) file: <b>read_excel()</b> function</h3>

<p>We will open here an excel file (.xls extension). This file is a database containing information on all homogenized Environmental and Climate Change Canada temperature stations.</p>

<p>This database has 11 columns with data starting at the 4 th line.</p>

<p>We will define the &ldquo;Province&rdquo; column as index of our DataFrame.</p>

<pre><code class="language-python">df4 = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, index_col=0,skiprows = range(0, 3))
df4.head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<h3 id="7-2-2-access-data-from-dataframes">7.2.2  Access data from DataFrames</h3>

<p>The first thing to do when opening a new dataset is print out a few rows. We accomplish this with <b>.head()</b> method:</p>

<pre><code class="language-python">dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3))
dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<p>To see the last five rows use  <b>.tail()</b> method. tail() also accepts a number, and in this case we printing the bottom two rows.:</p>

<pre><code class="language-python">dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3))
dataframe.tail()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">332</td>
<td align="left">NL</td>
<td align="left">PLUM POINT</td>
<td align="left">8402958</td>
<td align="right">1972</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">6</td>
<td align="right">51.07</td>
<td align="right">-56.88</td>
<td align="right">6</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">333</td>
<td align="left">NL</td>
<td align="left">PORT AUXBASQUES</td>
<td align="left">8402975</td>
<td align="right">1909</td>
<td align="right">2</td>
<td align="right">2017</td>
<td align="right">9</td>
<td align="right">47.58</td>
<td align="right">-58.97</td>
<td align="right">40</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">334</td>
<td align="left">NL</td>
<td align="left">ST ANTHONY</td>
<td align="left">8403389</td>
<td align="right">1946</td>
<td align="right">6</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">51.37</td>
<td align="right">-55.6</td>
<td align="right">33</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="right">335</td>
<td align="left">NL</td>
<td align="left">ST JOHN&rsquo;S</td>
<td align="left">8403505</td>
<td align="right">1874</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">47.62</td>
<td align="right">-52.75</td>
<td align="right">141</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="right">336</td>
<td align="left">NL</td>
<td align="left">STEPHENVILLE</td>
<td align="left">8403801</td>
<td align="right">1895</td>
<td align="right">6</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">48.53</td>
<td align="right">-58.55</td>
<td align="right">26</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="right">337</td>
<td align="left">NL</td>
<td align="left">WABUSH LAKE</td>
<td align="left">8504177</td>
<td align="right">1960</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">52.93</td>
<td align="right">-66.87</td>
<td align="right">551</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<p>Before exploring a Dataframe, you can modify the index to make it easier to analyze the dataset. For this, we use the <b> .set_index () </b> function. We must create a new object.</p>

<pre><code class="language-python">dataframe_Prov_index = dataframe.set_index(&quot;Prov&quot;)
</code></pre>

<pre><code class="language-python">dataframe_Prov_index.head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<p>We can directly select a column from a Dataframe:</p>

<pre><code class="language-python">dataframe_Prov_index['Nom de station'].head()
</code></pre>

<pre><code>Prov
BC        AGASSIZ
BC          ATLIN
BC    BARKERVILLE
BC     BEAVERDELL
BC    BELLA COOLA
Name: Nom de station, dtype: object
</code></pre>

<p>Pandas supports Multi-axes indexing to get the subset of pandas object.
Then, to access an element in a dataframe, there are two methods:</p>

<ul>
<li><p>the <b> iloc () </b> method to access data from index numbers</p></li>

<li><p>the <b> loc () </b> method to access data from labels</p></li>
</ul>

<p>#### a- <b> iloc () </b> method:</p>

<p>We can access data from Dataframe using index integer. Like numpy, this method is 0-based indexing.</p>

<pre><code class="language-python"># Example1: select specific row and specific column
dataframe_Prov_index.iloc[0,0]
</code></pre>

<pre><code>'AGASSIZ'
</code></pre>

<pre><code class="language-python"># Example2: iloc: # select first 4 rows f and all columns
dataframe_Prov_index.iloc[0:4,:]
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Example3: iloc: # select all rows and 4 specific columns 
dataframe_Prov_index.iloc[:,0:4].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Example4: iloc:# Slicing through list of values
print(dataframe_Prov_index.iloc[[1, 3, 5], [1, 3]])
print(dataframe_Prov_index.iloc[1:3, :])
dataframe_Prov_index.iloc[:,1:3].head()
</code></pre>

<pre><code>        stnid  mois déb.
Prov                    
BC    1200560          8
BC    1130771          1
BC    1021480          7
     Nom de station    stnid  année déb.  mois déb.  année fin.  mois fin.  \
Prov                                                                         
BC            ATLIN  1200560        1905          8        2017         12   
BC      BARKERVILLE  1090660        1888          2        2015          3   

      lat (deg)  long (deg)  élév (m) stns jointes  
Prov                                                
BC        59.57     -133.70       674            N  
BC        53.07     -121.52      1265            N  
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">1100120</td>
<td align="right">1893</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">1200560</td>
<td align="right">1905</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">1090660</td>
<td align="right">1888</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">1130771</td>
<td align="right">1939</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">1060841</td>
<td align="right">1895</td>
</tr>
</tbody>
</table>

<p>#### b- La méthode loc():</p>

<p>This method has purely label based indexing.</p>

<p>.loc() has multiple access methods like −</p>

<pre><code>    -single scalar label

    -list of labels

    -slice object

    -Boolean array
</code></pre>

<p>.loc takes two single/list/range operator separated by &lsquo;,&rsquo;. The first one indicates the row and the second one indicates columns.</p>

<pre><code class="language-python"># Example1: loc: select all rows for a specific column
dataframe_Prov_index.loc[:,&quot;Nom de station&quot;].head()
</code></pre>

<pre><code>Prov
BC        AGASSIZ
BC          ATLIN
BC    BARKERVILLE
BC     BEAVERDELL
BC    BELLA COOLA
Name: Nom de station, dtype: object
</code></pre>

<pre><code class="language-python"># Example2: loc: select all rows for a specific index name
dataframe_Prov_index.loc[&quot;QC&quot;,:].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">QC</td>
<td align="left">AMOS</td>
<td align="left">709CEE9</td>
<td align="right">1913</td>
<td align="right">6</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">48.57</td>
<td align="right">-78.13</td>
<td align="right">305</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">BAGOTVILLE</td>
<td align="left">7060400</td>
<td align="right">1880</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">48.33</td>
<td align="right">-71</td>
<td align="right">159</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">BAIE COMEAU</td>
<td align="left">704S001</td>
<td align="right">1965</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.13</td>
<td align="right">-68.2</td>
<td align="right">130</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">BEAUCEVILLE</td>
<td align="left">7027283</td>
<td align="right">1913</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">46.15</td>
<td align="right">-70.7</td>
<td align="right">168</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">BELLETERRE</td>
<td align="left">7080600</td>
<td align="right">1951</td>
<td align="right">9</td>
<td align="right">2004</td>
<td align="right">4</td>
<td align="right">47.38</td>
<td align="right">-78.7</td>
<td align="right">322</td>
<td align="left">N</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Example3: Select all rows for multiple columns, say list[]

dataframe_Prov_index.loc[:,[&quot;Nom de station&quot;, &quot;année déb.&quot;, &quot;année fin.&quot;]].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">année déb.</th>
<th align="right">année fin.</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1893</td>
<td align="right">2017</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1905</td>
<td align="right">2017</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1888</td>
<td align="right">2015</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1939</td>
<td align="right">2006</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="right">1895</td>
<td align="right">2017</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Example4: Select few rows for multiple columns, say list[]
dataframe_Prov_index.loc[['BC','QC'],[&quot;Nom de station&quot;, &quot;année déb.&quot;, &quot;année fin.&quot;]].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">année déb.</th>
<th align="right">année fin.</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1893</td>
<td align="right">2017</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1905</td>
<td align="right">2017</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1888</td>
<td align="right">2015</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1939</td>
<td align="right">2006</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="right">1895</td>
<td align="right">2017</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Example 5: # for getting values with a boolean array

(dataframe_Prov_index.loc['BC',[&quot;année déb.&quot;]]&gt;1900).head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="right">année déb.</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="right">False</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="right">True</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="right">False</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="right">True</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="right">False</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Example 6: # for getting values with a boolean array
dataframe_Prov_index.loc[dataframe_Prov_index[&quot;année fin.&quot;]&gt;2015,:].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BLIND CHANNEL</td>
<td align="left">1021480</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">2</td>
<td align="right">50.42</td>
<td align="right">-125.5</td>
<td align="right">23</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BLUE RIVER</td>
<td align="left">1160899</td>
<td align="right">1946</td>
<td align="right">9</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">52.13</td>
<td align="right">-119.28</td>
<td align="right">683</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Example 7: # for getting values with a boolean array
df2 = dataframe_Prov_index.loc[&quot;QC&quot;,:]
df2.loc[df2[&quot;année fin.&quot;]==2017,:].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">QC</td>
<td align="left">AMOS</td>
<td align="left">709CEE9</td>
<td align="right">1913</td>
<td align="right">6</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">48.57</td>
<td align="right">-78.13</td>
<td align="right">305</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">BAGOTVILLE</td>
<td align="left">7060400</td>
<td align="right">1880</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">48.33</td>
<td align="right">-71</td>
<td align="right">159</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">BAIE COMEAU</td>
<td align="left">704S001</td>
<td align="right">1965</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.13</td>
<td align="right">-68.2</td>
<td align="right">130</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">BEAUCEVILLE</td>
<td align="left">7027283</td>
<td align="right">1913</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">46.15</td>
<td align="right">-70.7</td>
<td align="right">168</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">CAUSAPSCAL</td>
<td align="left">7051200</td>
<td align="right">1913</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">48.37</td>
<td align="right">-67.23</td>
<td align="right">168</td>
<td align="left">N</td>
</tr>
</tbody>
</table>

<h3 id="7-2-3-change-a-dataframe">7.2.3  Change a Dataframe</h3>

<p>### 7.2.3.1 Column Selection/Addition/Deletion-</p>

<p>We will use here our previous Dataframe.</p>

<pre><code class="language-python">dataframe_Prov_index.head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<h4 id="a-create-a-new-variable">a- Create a new variable</h4>

<p>We can select columns from our Dataframe to create a new one. In this example, we will calculate the number of recording years for each station.</p>

<pre><code class="language-python">delta_year = (dataframe_Prov_index[&quot;année fin.&quot;] - dataframe_Prov_index[&quot;année déb.&quot;]) + 1
</code></pre>

<pre><code class="language-python">delta_year.head()
</code></pre>

<pre><code>Prov
BC    125
BC    113
BC    128
BC     68
BC    123
dtype: int64
</code></pre>

<p>#### b- Column Addition in  a DataFrame</p>

<pre><code class="language-python">dataframe_Prov_index[&quot;total année&quot;] = delta_year
</code></pre>

<pre><code class="language-python">dataframe_Prov_index.head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">total année</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
<td align="right">125</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
<td align="right">113</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
<td align="right">128</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
<td align="right">68</td>
</tr>
</tbody>
</table>

<p>#### c- Column Deletion in a DataFrame</p>

<p>Columns from a Dataframe can be deleted or popped; let us take an example to understand how.</p>

<pre><code class="language-python">dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3))
</code></pre>

<pre><code class="language-python"># using del function
print (&quot;Deleting 'stns jointes' column using DEL function:&quot;)
del dataframe['stns jointes']
dataframe.head()
</code></pre>

<pre><code>Deleting 'stns jointes' column using DEL function:
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
</tr>

<tr>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
</tr>

<tr>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
</tr>

<tr>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
</tr>

<tr>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># using pop function
print (&quot;Deleting 'stnid' column using POP function:&quot;)
dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3))
dataframe.pop('stnid')
dataframe.head()
</code></pre>

<pre><code>Deleting 'stnid' column using POP function:
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># using drop method
dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3))
dataframe.drop([&quot;stns jointes&quot;], axis=1).head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
</tr>

<tr>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
</tr>

<tr>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
</tr>

<tr>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
</tr>

<tr>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
</tr>
</tbody>
</table>

<p>### 7.2.3.2  Row Selection/Addition/Deletion-</p>

<p>We will now understand row selection, addition and deletion through examples. Let us begin with the concept of selection.</p>

<p>#### a-  Row Selection</p>

<p>Selection by Label
Rows can be selected by passing row label to a loc function.</p>

<pre><code class="language-python">dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3)).set_index(&quot;Prov&quot;)
dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="left">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="left">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="left">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="left">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="left">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">dataframe.loc['BC'].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="right">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<p>Rows can be selected by passing integer location to an iloc function.</p>

<pre><code class="language-python">dataframe.iloc[0]
</code></pre>

<pre><code>Nom de station    AGASSIZ
stnid             1100120
année déb.           1893
mois déb.               1
année fin.           2017
mois fin.              12
lat (deg)           49.25
long (deg)        -121.77
élév (m)               15
stns jointes            N
Name: BC, dtype: object
</code></pre>

<p>Multiple rows can be selected using ‘ : ’ operator.</p>

<pre><code class="language-python">dataframe[2:4]
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<h4 id="b-row-addition">b-  Row Addition</h4>

<p>Add new rows to a DataFrame using function <b>append()</b> function. This function will append the rows at the end.</p>

<pre><code class="language-python">dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3)).set_index(&quot;Prov&quot;)
</code></pre>

<pre><code class="language-python">df_new = pd.DataFrame({'Nom de station': ['station1', 'station2'], 'stnid': [8888, 9999], 'Prov': ['BC', 'QC']}).set_index(&quot;Prov&quot;)
df_new
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">station1</td>
<td align="right">8888</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">station2</td>
<td align="right">9999</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">dataframe = dataframe.append(df_new)
dataframe.tail()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">année déb.</th>
<th align="right">année fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">mois déb.</th>
<th align="right">mois fin.</th>
<th align="right">stnid</th>
<th align="left">stns jointes</th>
<th align="right">élév (m)</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">NL</td>
<td align="left">ST JOHN&rsquo;S</td>
<td align="right">1874</td>
<td align="right">2017</td>
<td align="right">47.62</td>
<td align="right">-52.75</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="right">8403505</td>
<td align="left">Y</td>
<td align="right">141</td>
</tr>

<tr>
<td align="left">NL</td>
<td align="left">STEPHENVILLE</td>
<td align="right">1895</td>
<td align="right">2017</td>
<td align="right">48.53</td>
<td align="right">-58.55</td>
<td align="right">6</td>
<td align="right">12</td>
<td align="right">8403801</td>
<td align="left">Y</td>
<td align="right">26</td>
</tr>

<tr>
<td align="left">NL</td>
<td align="left">WABUSH LAKE</td>
<td align="right">1960</td>
<td align="right">2017</td>
<td align="right">52.93</td>
<td align="right">-66.87</td>
<td align="right">11</td>
<td align="right">12</td>
<td align="right">8504177</td>
<td align="left">Y</td>
<td align="right">551</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">station1</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">8888</td>
<td align="left">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="left">station2</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">9999</td>
<td align="left">nan</td>
<td align="right">nan</td>
</tr>
</tbody>
</table>

<h4 id="c-row-deletion">c-  Row Deletion</h4>

<p>Use index label to delete or drop rows from a DataFrame. If label is duplicated, then multiple rows will be dropped.</p>

<pre><code class="language-python">dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3)).set_index(&quot;Prov&quot;)
dataframe.head()

</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="left">BELLA COOLA</td>
<td align="right">1060841</td>
<td align="right">1895</td>
<td align="right">5</td>
<td align="right">2017</td>
<td align="right">11</td>
<td align="right">52.37</td>
<td align="right">-126.68</td>
<td align="right">18</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># Drop rows with label 'BC'
dataframe = dataframe.drop('BC')
dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">YT</td>
<td align="left">BURWASH</td>
<td align="left">2100181</td>
<td align="right">1966</td>
<td align="right">10</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">61.37</td>
<td align="right">-139.05</td>
<td align="right">807</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">YT</td>
<td align="left">DAWSON</td>
<td align="left">2100LRP</td>
<td align="right">1901</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">64.05</td>
<td align="right">-139.13</td>
<td align="right">370</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">N   YT</td>
<td align="left">HAINES JUNCTIO</td>
<td align="left">2100630</td>
<td align="right">1944</td>
<td align="right">10</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">60.75</td>
<td align="right">-137.5</td>
<td align="right">596</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">YT</td>
<td align="left">KOMAKUK BEACH</td>
<td align="left">2100682</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">69.62</td>
<td align="right">-140.2</td>
<td align="right">13</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">YT</td>
<td align="left">MAYO</td>
<td align="left">2100701</td>
<td align="right">1924</td>
<td align="right">10</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">63.62</td>
<td align="right">-135.87</td>
<td align="right">504</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">dataframe = pd.read_excel(&quot;./DATA/Homog_Temperature_Stations.xls&quot;, skiprows = range(0, 3)).set_index(&quot;Prov&quot;)
dataframe.loc['ON'].head()
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">ON</td>
<td align="left">ATIKOKAN</td>
<td align="left">6020LPQ</td>
<td align="right">1917</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">48.8</td>
<td align="right">-91.58</td>
<td align="right">442</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">ON</td>
<td align="left">BEATRICE</td>
<td align="left">6110607</td>
<td align="right">1878</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">45.13</td>
<td align="right">-79.4</td>
<td align="right">297</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">ON</td>
<td align="left">BELLEVILLE</td>
<td align="left">6150689</td>
<td align="right">1921</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">44.15</td>
<td align="right">-77.4</td>
<td align="right">76</td>
<td align="left">N</td>
</tr>

<tr>
<td align="left">ON</td>
<td align="left">BIG TROUT LAKE</td>
<td align="left">6010735</td>
<td align="right">1939</td>
<td align="right">2</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">53.83</td>
<td align="right">-89.87</td>
<td align="right">224</td>
<td align="left">Y</td>
</tr>

<tr>
<td align="left">ON</td>
<td align="left">BROCKVILLE</td>
<td align="left">6100971</td>
<td align="right">1915</td>
<td align="right">7</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">44.6</td>
<td align="right">-75.67</td>
<td align="right">96</td>
<td align="left">Y</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">
</code></pre>

<h3 id="7-2-3-3-merging-joining-dataframe">7.2.3.3 Merging/Joining Dataframe-</h3>

<p>Pandas has full-featured, high performance in-memory join operations idiomatically very similar to relational databases like SQL.</p>

<pre><code class="language-python">pd.merge(left, right, how='inner', on=None, left_on=None, right_on=None,left_index=False, right_index=False, sort=True)
</code></pre>

<p>|  |  |
|&ndash;|&ndash;|
| <b>left</b> | DataFrame object |
| <b>right</b> | Another DataFrame object |
| <b>on</b> | Columns (names) to join on. Must be found in both the left and right DataFrame objects |
| <b>left_on</b> |Columns from the left DataFrame to use as keys. Can either be column names or arrays with length equal to the length of the DataFrame |
| <b>right_on</b> |Columns from the right DataFrame to use as keys. Can either be column names or arrays with length equal to the length of the DataFrame |
| <b>left_index</b> |If True, use the index (row labels) from the left DataFrame as its join key(s). In case of a DataFrame with a MultiIndex (hierarchical), the number of levels must match the number of join keys from the right DataFrame |
| <b>right_index</b> |Same usage as left_index for the right DataFrame |
| <b>how</b> |One of &lsquo;left&rsquo;, &lsquo;right&rsquo;, &lsquo;outer&rsquo;, &lsquo;inner&rsquo;. Defaults to inner. Each method has been described below |
| <b>sort</b> |Sort the result DataFrame by the join keys in lexicographical order. Defaults to True, setting to False will improve the performance substantially in many cases |</p>

<p>Let us now create two different DataFrames and perform the merging operations on it.</p>

<pre><code class="language-python">left_dataframe = pd.DataFrame({
   'id':[1,2,3,4],
   'Nom de station': ['MONTREAL TAVISH', 'QUEBEC', 'TADOUSSAC','OKA'],
   'variable':['var1','var2','var6','var5']})

right_dataframe = pd.DataFrame(
   {'id':[1,2,3,4],
   'Nom de station': ['TORONTO', 'OTTAWA', 'KINGSTON','CHAPLEAU'],
   'variable':['var3','var1','var6','var5']})
left_dataframe
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">right_dataframe
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
<td align="left">var3</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<h4 id="a-merge-two-dataframes-on-a-key">a-  Merge Two DataFrames on a Key</h4>

<pre><code class="language-python">pd.merge(left_dataframe,right_dataframe,on='id')
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station_x</th>
<th align="left">variable_x</th>
<th align="left">Nom de station_y</th>
<th align="left">variable_y</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
<td align="left">TORONTO</td>
<td align="left">var3</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
<td align="left">OTTAWA</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
<td align="left">KINGSTON</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
<td align="left">CHAPLEAU</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<h4 id="b-merge-two-dataframes-on-a-key">b-  Merge Two DataFrames on a Key</h4>

<pre><code class="language-python">pd.merge(left_dataframe,right_dataframe,on=['id','variable'])
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station_x</th>
<th align="left">variable</th>
<th align="left">Nom de station_y</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
<td align="left">KINGSTON</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
<td align="left">CHAPLEAU</td>
</tr>
</tbody>
</table>

<h4 id="c-merge-two-dataframes-using-how-argument">c-  Merge Two DataFrames Using &lsquo;How&rsquo; argument</h4>

<p>The how argument to merge specifies how to determine which keys are to be included in the resulting table. If a key combination does not appear in either the left or the right tables, the values in the joined table will be NA.</p>

<pre><code class="language-python"># Left Join
pd.merge(left_dataframe, right_dataframe, on='variable', how='left')
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id_x</th>
<th align="left">Nom de station_x</th>
<th align="left">variable</th>
<th align="right">id_y</th>
<th align="left">Nom de station_y</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
<td align="right">nan</td>
<td align="left">nan</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># right Join
pd.merge(left_dataframe, right_dataframe, on='variable', how='right')
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id_x</th>
<th align="left">Nom de station_x</th>
<th align="left">variable</th>
<th align="right">id_y</th>
<th align="left">Nom de station_y</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">nan</td>
<td align="left">nan</td>
<td align="left">var3</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># outer Join
pd.merge(left_dataframe, right_dataframe, on='variable', how='outer')
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id_x</th>
<th align="left">Nom de station_x</th>
<th align="left">variable</th>
<th align="right">id_y</th>
<th align="left">Nom de station_y</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
<td align="right">nan</td>
<td align="left">nan</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">nan</td>
<td align="left">nan</td>
<td align="left">var3</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># inner Join
pd.merge(left_dataframe, right_dataframe, on='variable', how='inner')
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id_x</th>
<th align="left">Nom de station_x</th>
<th align="left">variable</th>
<th align="right">id_y</th>
<th align="left">Nom de station_y</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
</tr>
</tbody>
</table>

<h3 id="7-2-3-4-dataframe-concatenation">7.2.3.4  Dataframe Concatenation-</h3>

<p>Pandas provides various facilities for easily combining together DataFrame objects.</p>

<pre><code>pd.concat(objs,axis=0,join='outer',join_axes=None,ignore_index=False)
</code></pre>

<p>|  |  |
|&ndash;|&ndash;|
| <b>objs</b> | This is a sequence or mapping of Series, DataFrame objects |
| <b>axis</b> |  {0, 1, &hellip;}, default 0. This is the axis to concatenate along |
| <b>join</b> |  {‘inner’, ‘outer’}, default ‘outer’. How to handle indexes on other axis(es). Outer for union and inner for intersection |
| <b>ignore_index</b> |boolean, default False. If True, do not use the index values on the concatenation axis. The resulting axis will be labeled 0, &hellip;, n - 1 |
| <b>join_axes</b> |This is the list of Index objects. Specific indexes to use for the other (n-1) axes instead of performing inner/outer set logic |</p>

<pre><code class="language-python">dataframe1 = pd.DataFrame({
   'id':[1,2,3,4],
   'Nom de station': ['MONTREAL TAVISH', 'QUEBEC', 'TADOUSSAC','OKA'],
   'variable':['var1','var2','var6','var5']})

dataframe2 = pd.DataFrame(
   {'id':[1,2,3,4],
   'Nom de station': ['TORONTO', 'OTTAWA', 'KINGSTON','CHAPLEAU'],
   'variable':['var3','var1','var6','var5']})

pd.concat([dataframe1,dataframe2])
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
</tr>

<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
<td align="left">var3</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<p>Suppose we wanted to associate specific keys with each of the pieces of the chopped up DataFrame. We can do this by using the keys argument −</p>

<pre><code class="language-python">pd.concat([dataframe1,dataframe2],keys=['QC','ON'])
</code></pre>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">(&lsquo;QC&rsquo;, 0)</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="left">(&lsquo;QC&rsquo;, 1)</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
</tr>

<tr>
<td align="left">(&lsquo;QC&rsquo;, 2)</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="left">(&lsquo;QC&rsquo;, 3)</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
</tr>

<tr>
<td align="left">(&lsquo;ON&rsquo;, 0)</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
<td align="left">var3</td>
</tr>

<tr>
<td align="left">(&lsquo;ON&rsquo;, 1)</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="left">(&lsquo;ON&rsquo;, 2)</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="left">(&lsquo;ON&rsquo;, 3)</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<p>If we don&rsquo;t want the index being duplicated, set ignore_index to True.</p>

<pre><code class="language-python">pd.concat([dataframe1,dataframe2],keys=['QC','ON'],ignore_index=True)
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
<td align="left">var3</td>
</tr>

<tr>
<td align="right">5</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">6</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">7</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<p>If the two Dataframes need to be added along axis=1, then the new columns will be appended.</p>

<pre><code class="language-python">pd.concat([dataframe1,dataframe2],axis=1)
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
<td align="left">var3</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<h4 id="concatenating-using-append">Concatenating Using append</h4>

<p>A useful shortcut to concat are the append instance methods on DataFrame. They concatenate along axis=0, namely the index</p>

<pre><code class="language-python">dataframe1.append(dataframe2)
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">id</th>
<th align="left">Nom de station</th>
<th align="left">variable</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">MONTREAL TAVISH</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">QUEBEC</td>
<td align="left">var2</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">TADOUSSAC</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">OKA</td>
<td align="left">var5</td>
</tr>

<tr>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TORONTO</td>
<td align="left">var3</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">OTTAWA</td>
<td align="left">var1</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">KINGSTON</td>
<td align="left">var6</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">CHAPLEAU</td>
<td align="left">var5</td>
</tr>
</tbody>
</table>

<h3 id="7-2-4-basic-functionality-on-dataframe">7.2.4  Basic Functionality on DataFrame</h3>

<p>There are many built-in functions and methods:</p>

<p><a href="https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.DataFrame.html" target="_blank">https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.DataFrame.html</a></p>

<p>We will present some useful functions with exploring a dataset.</p>

<pre><code class="language-python">dataframe = pd.read_csv(&quot;./DATA/Climato_Stations_ECCC_1981_2010_YEAR.csv&quot;, encoding='latin-1')
dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
<td align="right">5.63043</td>
<td align="right">18.9033</td>
<td align="right">-3.46052</td>
<td align="right">-19.235</td>
<td align="right">860.083</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
<td align="right">12.628</td>
<td align="right">23.6417</td>
<td align="right">4.01748</td>
<td align="right">-3.646</td>
<td align="right">1798.09</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BLIND CHANNEL</td>
<td align="right">1021480</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">2</td>
<td align="right">50.42</td>
<td align="right">-125.5</td>
<td align="right">23</td>
<td align="left">N</td>
<td align="right">12.1556</td>
<td align="right">20.2007</td>
<td align="right">6.77689</td>
<td align="right">1.09467</td>
<td align="right">2518.68</td>
</tr>
</tbody>
</table>

<ul>
<li><b>.shape</b> method:</li>
</ul>

<p>Returns a tuple representing the dimensionality of the DataFrame. Tuple (a,b), where a represents the number of rows and b represents the number of columns.</p>

<pre><code class="language-python">dataframe.shape 
</code></pre>

<pre><code>(289, 17)
</code></pre>

<ul>
<li><b>.columns</b> method:</li>
</ul>

<p>Returns names of the columns in our Dataframe.</p>

<pre><code class="language-python">dataframe.columns
</code></pre>

<pre><code>Index(['Unnamed: 0', 'Prov', 'Nom de station', 'stnid', 'année déb.',
       'mois déb.', 'année fin.', 'mois fin.', 'lat (deg)', 'long (deg)',
       'élév (m)', 'stns jointes', 'Tmax', 'Tmax90p', 'Tmin', 'Tmin10p',
       'DG0'],
      dtype='object')
</code></pre>

<ul>
<li><b>.empty</b> method:</li>
</ul>

<p>Returns the Boolean value saying whether the Object is empty or not; True indicates that the object is empty.</p>

<pre><code class="language-python">dataframe.empty
</code></pre>

<pre><code>False
</code></pre>

<ul>
<li><b>.isnull</b> method:
<br /></li>
</ul>

<p>To detect missing values easier (and across different array dtypes), Pandas provides the isnull() and notnull() functions.</p>

<pre><code class="language-python">dataframe['Tmax'].isnull().head()
</code></pre>

<pre><code>0     True
1    False
2     True
3    False
4    False
Name: Tmax, dtype: bool
</code></pre>

<p>We combine this method with .sum() to know the number of missing values.</p>

<pre><code class="language-python">dataframe['Tmax'].isnull().sum() 
</code></pre>

<pre><code>117
</code></pre>

<ul>
<li><b>.dropna</b> method:
<br /></li>
</ul>

<p>If you want to exclude the missing values, then use the dropna function along with the axis argument. By default, axis=0, i.e., along row, which means that if any value within a row is NA then the whole row is excluded.</p>

<pre><code class="language-python">dataframe_sans_NaN = dataframe.dropna() 
</code></pre>

<pre><code class="language-python">dataframe_sans_NaN['Tmax'].isnull().sum() 
</code></pre>

<pre><code>0
</code></pre>

<pre><code class="language-python">dataframe_sans_NaN.shape # nouvelle dimension de notre tableau 
</code></pre>

<pre><code>(169, 17)
</code></pre>

<ul>
<li><b>sort_values</b> method:</li>
</ul>

<p>sort_values() is the method for sorting by values. It accepts a &lsquo;by&rsquo; argument which will use the column name of the DataFrame with which the values are to be sorted.</p>

<pre><code class="language-python">dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
<td align="right">5.63043</td>
<td align="right">18.9033</td>
<td align="right">-3.46052</td>
<td align="right">-19.235</td>
<td align="right">860.083</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
<td align="right">12.628</td>
<td align="right">23.6417</td>
<td align="right">4.01748</td>
<td align="right">-3.646</td>
<td align="right">1798.09</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BLIND CHANNEL</td>
<td align="right">1021480</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">2</td>
<td align="right">50.42</td>
<td align="right">-125.5</td>
<td align="right">23</td>
<td align="left">N</td>
<td align="right">12.1556</td>
<td align="right">20.2007</td>
<td align="right">6.77689</td>
<td align="right">1.09467</td>
<td align="right">2518.68</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">df_label_sorted = dataframe.sort_values(by=&quot;Prov&quot;)
df_label_sorted.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">127</td>
<td align="right">127</td>
<td align="left">AB</td>
<td align="left">SLAVE LAKE</td>
<td align="right">3065995</td>
<td align="right">1922</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">55.3</td>
<td align="right">-114.78</td>
<td align="right">583</td>
<td align="left">Y</td>
<td align="right">7.48137</td>
<td align="right">22.4643</td>
<td align="right">-3.42227</td>
<td align="right">-20.3803</td>
<td align="right">1131.03</td>
</tr>

<tr>
<td align="right">106</td>
<td align="right">106</td>
<td align="left">AB</td>
<td align="left">EDMONTON</td>
<td align="right">3012216</td>
<td align="right">1880</td>
<td align="right">7</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">53.57</td>
<td align="right">-113.52</td>
<td align="right">723</td>
<td align="left">Y</td>
<td align="right">8.98212</td>
<td align="right">24.328</td>
<td align="right">-3.11709</td>
<td align="right">-19.1907</td>
<td align="right">1095.93</td>
</tr>

<tr>
<td align="right">104</td>
<td align="right">104</td>
<td align="left">AB</td>
<td align="left">COLD LAKE</td>
<td align="right">3081680</td>
<td align="right">1925</td>
<td align="right">7</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">54.42</td>
<td align="right">-110.28</td>
<td align="right">541</td>
<td align="left">Y</td>
<td align="right">7.72448</td>
<td align="right">24.2737</td>
<td align="right">-3.03759</td>
<td align="right">-21.2037</td>
<td align="right">1303.95</td>
</tr>

<tr>
<td align="right">103</td>
<td align="right">103</td>
<td align="left">AB</td>
<td align="left">CARWAY</td>
<td align="right">3031402</td>
<td align="right">1914</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49</td>
<td align="right">-113.37</td>
<td align="right">1354</td>
<td align="left">Y</td>
<td align="right">11.1397</td>
<td align="right">24.925</td>
<td align="right">-1.61886</td>
<td align="right">-13.98</td>
<td align="right">956.837</td>
</tr>

<tr>
<td align="right">102</td>
<td align="right">102</td>
<td align="left">AB</td>
<td align="left">CAMROSE</td>
<td align="right">3011240</td>
<td align="right">1946</td>
<td align="right">3</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">53.03</td>
<td align="right">-112.82</td>
<td align="right">739</td>
<td align="left">N</td>
<td align="right">8.96497</td>
<td align="right">24.1757</td>
<td align="right">-3.71442</td>
<td align="right">-20.588</td>
<td align="right">1048.13</td>
</tr>
</tbody>
</table>

<p>The argument could takes a list of column values.</p>

<pre><code class="language-python">df_label_sorted = dataframe.sort_values(by=['Prov','année déb.'])
df_label_sorted.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">106</td>
<td align="right">106</td>
<td align="left">AB</td>
<td align="left">EDMONTON</td>
<td align="right">3012216</td>
<td align="right">1880</td>
<td align="right">7</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">53.57</td>
<td align="right">-113.52</td>
<td align="right">723</td>
<td align="left">Y</td>
<td align="right">8.98212</td>
<td align="right">24.328</td>
<td align="right">-3.11709</td>
<td align="right">-19.1907</td>
<td align="right">1095.93</td>
</tr>

<tr>
<td align="right">110</td>
<td align="right">110</td>
<td align="left">AB</td>
<td align="left">FORT CHIPEWYAN</td>
<td align="right">3072655</td>
<td align="right">1883</td>
<td align="right">10</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">58.77</td>
<td align="right">-111.12</td>
<td align="right">238</td>
<td align="left">Y</td>
<td align="right">4.28219</td>
<td align="right">23.566</td>
<td align="right">-6.54421</td>
<td align="right">-28.6297</td>
<td align="right">1135.11</td>
</tr>

<tr>
<td align="right">121</td>
<td align="right">121</td>
<td align="left">AB</td>
<td align="left">MEDICINE HAT</td>
<td align="right">3034485</td>
<td align="right">1883</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">50.02</td>
<td align="right">-110.72</td>
<td align="right">717</td>
<td align="left">Y</td>
<td align="right">12.6489</td>
<td align="right">28.4973</td>
<td align="right">-0.1559</td>
<td align="right">-15.7833</td>
<td align="right">1563.87</td>
</tr>

<tr>
<td align="right">99</td>
<td align="right">99</td>
<td align="left">AB</td>
<td align="left">CALGARY</td>
<td align="right">3031092</td>
<td align="right">1885</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">51.12</td>
<td align="right">-114.02</td>
<td align="right">1084</td>
<td align="left">Y</td>
<td align="right">10.835</td>
<td align="right">24.4673</td>
<td align="right">-1.44461</td>
<td align="right">-15.235</td>
<td align="right">1172.05</td>
</tr>

<tr>
<td align="right">97</td>
<td align="right">97</td>
<td align="left">AB</td>
<td align="left">BANFF</td>
<td align="right">3050519</td>
<td align="right">1887</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">51.2</td>
<td align="right">-115.55</td>
<td align="right">1397</td>
<td align="left">Y</td>
<td align="right">8.90652</td>
<td align="right">23.132</td>
<td align="right">-3.08488</td>
<td align="right">-15.8583</td>
<td align="right">750.37</td>
</tr>
</tbody>
</table>

<ul>
<li><b>sort_index()</b> method:</li>
</ul>

<p>Using the sort_index() method, by passing the axis arguments and the order of sorting, DataFrame can be sorted. By default, sorting is done on row labels in ascending order.</p>

<pre><code class="language-python">df_label_sorted.sort_index().head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
<td align="right">5.63043</td>
<td align="right">18.9033</td>
<td align="right">-3.46052</td>
<td align="right">-19.235</td>
<td align="right">860.083</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
<td align="right">12.628</td>
<td align="right">23.6417</td>
<td align="right">4.01748</td>
<td align="right">-3.646</td>
<td align="right">1798.09</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BLIND CHANNEL</td>
<td align="right">1021480</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">2</td>
<td align="right">50.42</td>
<td align="right">-125.5</td>
<td align="right">23</td>
<td align="left">N</td>
<td align="right">12.1556</td>
<td align="right">20.2007</td>
<td align="right">6.77689</td>
<td align="right">1.09467</td>
<td align="right">2518.68</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">df_label_sorted.sort_index(ascending=False).head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">288</td>
<td align="right">288</td>
<td align="left">NL</td>
<td align="left">WABUSH LAKE</td>
<td align="right">8504177</td>
<td align="right">1960</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">52.93</td>
<td align="right">-66.87</td>
<td align="right">551</td>
<td align="left">Y</td>
<td align="right">2.33974</td>
<td align="right">19.6937</td>
<td align="right">-8.02478</td>
<td align="right">-29.4537</td>
<td align="right">792.913</td>
</tr>

<tr>
<td align="right">287</td>
<td align="right">287</td>
<td align="left">NL</td>
<td align="left">STEPHENVILLE</td>
<td align="right">8403801</td>
<td align="right">1895</td>
<td align="right">6</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">48.53</td>
<td align="right">-58.55</td>
<td align="right">26</td>
<td align="left">Y</td>
<td align="right">8.80653</td>
<td align="right">20.614</td>
<td align="right">1.81275</td>
<td align="right">-10.582</td>
<td align="right">1710.17</td>
</tr>

<tr>
<td align="right">286</td>
<td align="right">286</td>
<td align="left">NL</td>
<td align="left">ST JOHN&rsquo;S</td>
<td align="right">8403505</td>
<td align="right">1874</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">47.62</td>
<td align="right">-52.75</td>
<td align="right">141</td>
<td align="left">Y</td>
<td align="right">9.07367</td>
<td align="right">21.6237</td>
<td align="right">1.54977</td>
<td align="right">-8.919</td>
<td align="right">1474.82</td>
</tr>

<tr>
<td align="right">285</td>
<td align="right">285</td>
<td align="left">NL</td>
<td align="left">ST ANTHONY</td>
<td align="right">8403389</td>
<td align="right">1946</td>
<td align="right">6</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">51.37</td>
<td align="right">-55.6</td>
<td align="right">33</td>
<td align="left">Y</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">284</td>
<td align="right">284</td>
<td align="left">NL</td>
<td align="left">PORT AUXBASQUES</td>
<td align="right">8402975</td>
<td align="right">1909</td>
<td align="right">2</td>
<td align="right">2017</td>
<td align="right">9</td>
<td align="right">47.58</td>
<td align="right">-58.97</td>
<td align="right">40</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">df_label_sorted.sort_index(axis=1).head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">DG0</th>
<th align="left">Nom de station</th>
<th align="left">Prov</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">Unnamed: 0</th>
<th align="right">année déb.</th>
<th align="right">année fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">mois déb.</th>
<th align="right">mois fin.</th>
<th align="right">stnid</th>
<th align="left">stns jointes</th>
<th align="right">élév (m)</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">106</td>
<td align="right">1095.93</td>
<td align="left">EDMONTON</td>
<td align="left">AB</td>
<td align="right">8.98212</td>
<td align="right">24.328</td>
<td align="right">-3.11709</td>
<td align="right">-19.1907</td>
<td align="right">106</td>
<td align="right">1880</td>
<td align="right">2017</td>
<td align="right">53.57</td>
<td align="right">-113.52</td>
<td align="right">7</td>
<td align="right">12</td>
<td align="right">3012216</td>
<td align="left">Y</td>
<td align="right">723</td>
</tr>

<tr>
<td align="right">110</td>
<td align="right">1135.11</td>
<td align="left">FORT CHIPEWYAN</td>
<td align="left">AB</td>
<td align="right">4.28219</td>
<td align="right">23.566</td>
<td align="right">-6.54421</td>
<td align="right">-28.6297</td>
<td align="right">110</td>
<td align="right">1883</td>
<td align="right">2017</td>
<td align="right">58.77</td>
<td align="right">-111.12</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">3072655</td>
<td align="left">Y</td>
<td align="right">238</td>
</tr>

<tr>
<td align="right">121</td>
<td align="right">1563.87</td>
<td align="left">MEDICINE HAT</td>
<td align="left">AB</td>
<td align="right">12.6489</td>
<td align="right">28.4973</td>
<td align="right">-0.1559</td>
<td align="right">-15.7833</td>
<td align="right">121</td>
<td align="right">1883</td>
<td align="right">2017</td>
<td align="right">50.02</td>
<td align="right">-110.72</td>
<td align="right">8</td>
<td align="right">12</td>
<td align="right">3034485</td>
<td align="left">Y</td>
<td align="right">717</td>
</tr>

<tr>
<td align="right">99</td>
<td align="right">1172.05</td>
<td align="left">CALGARY</td>
<td align="left">AB</td>
<td align="right">10.835</td>
<td align="right">24.4673</td>
<td align="right">-1.44461</td>
<td align="right">-15.235</td>
<td align="right">99</td>
<td align="right">1885</td>
<td align="right">2017</td>
<td align="right">51.12</td>
<td align="right">-114.02</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="right">3031092</td>
<td align="left">Y</td>
<td align="right">1084</td>
</tr>

<tr>
<td align="right">97</td>
<td align="right">750.37</td>
<td align="left">BANFF</td>
<td align="left">AB</td>
<td align="right">8.90652</td>
<td align="right">23.132</td>
<td align="right">-3.08488</td>
<td align="right">-15.8583</td>
<td align="right">97</td>
<td align="right">1887</td>
<td align="right">2017</td>
<td align="right">51.2</td>
<td align="right">-115.55</td>
<td align="right">11</td>
<td align="right">12</td>
<td align="right">3050519</td>
<td align="left">Y</td>
<td align="right">1397</td>
</tr>
</tbody>
</table>

<ul>
<li><b>.describe()</b> method:<br /></li>
</ul>

<p>Generates descriptive statistics that summarize the central tendency, dispersion and shape of a dataset’s distribution, excluding NaN values.</p>

<pre><code class="language-python">dataframe['Tmax'].describe()
</code></pre>

<pre><code>count    172.000000
mean       7.916314
std        5.524630
min      -15.366463
25%        7.364646
50%        8.988052
75%       11.018241
max       16.105511
Name: Tmax, dtype: float64
</code></pre>

<ul>
<li><b>.dtypes()</b> method:<br /></li>
</ul>

<p>Returns the dtypes in this object.</p>

<pre><code class="language-python">dataframe.dtypes
</code></pre>

<pre><code>Unnamed: 0          int64
Prov               object
Nom de station     object
stnid              object
année déb.          int64
mois déb.           int64
année fin.          int64
mois fin.           int64
lat (deg)         float64
long (deg)        float64
élév (m)            int64
stns jointes       object
Tmax              float64
Tmax90p           float64
Tmin              float64
Tmin10p           float64
DG0               float64
dtype: object
</code></pre>

<h3 id="7-2-5-dataframe-function-application">7.2.5  DataFrame Function Application</h3>

<p>To apply your own or another library’s functions to Pandas objects, you should be aware of the three important methods. The methods have been discussed below. The appropriate method to use depends on whether your function expects to operate on an entire DataFrame, row- or column-wise, or element wise.</p>

<ul>
<li><p>Table wise Function Application: <b>.pipe()</b></p></li>

<li><p>Row or Column Wise Function Application: <b>.apply()</b></p></li>

<li><p>Element wise Function Application: <b>.applymap()</b></p></li>

<li><p><b>.apply()</b> method:</p></li>
</ul>

<p>Arbitrary functions can be applied along the axes of a DataFrame or Panel using the apply() method, which, like the descriptive statistics methods, takes an optional axis argument. By default, the operation performs column wise, taking each column as an array-like.</p>

<pre><code class="language-python">dataframe = pd.read_csv(&quot;./DATA/Climato_Stations_ECCC_1981_2010_YEAR.csv&quot;, encoding='latin-1')
</code></pre>

<pre><code class="language-python">dataframe = pd.read_csv(&quot;./DATA/Climato_Stations_ECCC_1981_2010_YEAR.csv&quot;, encoding='latin-1')
dataframe[&quot;stns jointes&quot;]=dataframe[&quot;stns jointes&quot;].apply(lambda x: x.replace(&quot;N&quot;, &quot;NaN&quot;))
dataframe[&quot;stns jointes&quot;]=dataframe[&quot;stns jointes&quot;].apply(lambda x: x.replace(&quot;Y&quot;, &quot;1&quot;))
dataframe = dataframe.dropna() 
dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="right">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="right">nan</td>
<td align="right">5.63043</td>
<td align="right">18.9033</td>
<td align="right">-3.46052</td>
<td align="right">-19.235</td>
<td align="right">860.083</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="right">1</td>
<td align="right">12.628</td>
<td align="right">23.6417</td>
<td align="right">4.01748</td>
<td align="right">-3.646</td>
<td align="right">1798.09</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BLIND CHANNEL</td>
<td align="right">1021480</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">2</td>
<td align="right">50.42</td>
<td align="right">-125.5</td>
<td align="right">23</td>
<td align="right">nan</td>
<td align="right">12.1556</td>
<td align="right">20.2007</td>
<td align="right">6.77689</td>
<td align="right">1.09467</td>
<td align="right">2518.68</td>
</tr>

<tr>
<td align="right">5</td>
<td align="right">5</td>
<td align="left">BC</td>
<td align="left">BLUE RIVER</td>
<td align="right">1160899</td>
<td align="right">1946</td>
<td align="right">9</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">52.13</td>
<td align="right">-119.28</td>
<td align="right">683</td>
<td align="right">1</td>
<td align="right">10.4408</td>
<td align="right">25.9917</td>
<td align="right">-1.12501</td>
<td align="right">-12.5823</td>
<td align="right">987.363</td>
</tr>

<tr>
<td align="right">9</td>
<td align="right">9</td>
<td align="left">BC</td>
<td align="left">COMOX</td>
<td align="right">1021830</td>
<td align="right">1935</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.72</td>
<td align="right">-124.9</td>
<td align="right">26</td>
<td align="right">1</td>
<td align="right">13.7376</td>
<td align="right">23.1023</td>
<td align="right">6.42485</td>
<td align="right">-0.526</td>
<td align="right">2444.39</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">dataframe[&quot;Tmin&quot;]=dataframe[&quot;Tmin&quot;].apply(lambda x: round(x,2))
dataframe[&quot;Tmax&quot;]=dataframe[&quot;Tmax&quot;].apply(lambda x: int(x))
dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="right">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="right">nan</td>
<td align="right">5</td>
<td align="right">18.9033</td>
<td align="right">-3.46</td>
<td align="right">-19.235</td>
<td align="right">860.083</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="right">23.6417</td>
<td align="right">4.02</td>
<td align="right">-3.646</td>
<td align="right">1798.09</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BLIND CHANNEL</td>
<td align="right">1021480</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">2</td>
<td align="right">50.42</td>
<td align="right">-125.5</td>
<td align="right">23</td>
<td align="right">nan</td>
<td align="right">12</td>
<td align="right">20.2007</td>
<td align="right">6.78</td>
<td align="right">1.09467</td>
<td align="right">2518.68</td>
</tr>

<tr>
<td align="right">5</td>
<td align="right">5</td>
<td align="left">BC</td>
<td align="left">BLUE RIVER</td>
<td align="right">1160899</td>
<td align="right">1946</td>
<td align="right">9</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">52.13</td>
<td align="right">-119.28</td>
<td align="right">683</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">25.9917</td>
<td align="right">-1.13</td>
<td align="right">-12.5823</td>
<td align="right">987.363</td>
</tr>

<tr>
<td align="right">9</td>
<td align="right">9</td>
<td align="left">BC</td>
<td align="left">COMOX</td>
<td align="right">1021830</td>
<td align="right">1935</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.72</td>
<td align="right">-124.9</td>
<td align="right">26</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">23.1023</td>
<td align="right">6.42</td>
<td align="right">-0.526</td>
<td align="right">2444.39</td>
</tr>
</tbody>
</table>

<h3 id="7-2-6-dataframe-groupby-method">7.2.6  DataFrame GroupBY method</h3>

<p>Any groupby operation involves one of the following operations on the original object. They are −</p>

<ul>
<li>Splitting the Object</li>
<li>Applying a function</li>
<li>Combining the results</li>
</ul>

<p>In many situations, we split the data into sets and we apply some functionality on each subset. In the apply functionality, we can perform the following operations −</p>

<ul>
<li>Aggregation − computing a summary statistic</li>
<li>Transformation − perform some group-specific operation</li>
<li>Filtration − discarding the data with some condition</li>
</ul>

<p>Let us now create a DataFrame object and perform all the operations on it −</p>

<pre><code class="language-python">dataframe = pd.read_csv(&quot;./DATA/Climato_Stations_ECCC_1981_2010_YEAR.csv&quot;, encoding='latin-1')
dataframe.head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">BC</td>
<td align="left">AGASSIZ</td>
<td align="right">1100120</td>
<td align="right">1893</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">49.25</td>
<td align="right">-121.77</td>
<td align="right">15</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">BC</td>
<td align="left">ATLIN</td>
<td align="right">1200560</td>
<td align="right">1905</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">59.57</td>
<td align="right">-133.7</td>
<td align="right">674</td>
<td align="left">N</td>
<td align="right">5.63043</td>
<td align="right">18.9033</td>
<td align="right">-3.46052</td>
<td align="right">-19.235</td>
<td align="right">860.083</td>
</tr>

<tr>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">BC</td>
<td align="left">BARKERVILLE</td>
<td align="right">1090660</td>
<td align="right">1888</td>
<td align="right">2</td>
<td align="right">2015</td>
<td align="right">3</td>
<td align="right">53.07</td>
<td align="right">-121.52</td>
<td align="right">1265</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">3</td>
<td align="right">3</td>
<td align="left">BC</td>
<td align="left">BEAVERDELL</td>
<td align="right">1130771</td>
<td align="right">1939</td>
<td align="right">1</td>
<td align="right">2006</td>
<td align="right">9</td>
<td align="right">49.48</td>
<td align="right">-119.05</td>
<td align="right">838</td>
<td align="left">Y</td>
<td align="right">12.628</td>
<td align="right">23.6417</td>
<td align="right">4.01748</td>
<td align="right">-3.646</td>
<td align="right">1798.09</td>
</tr>

<tr>
<td align="right">4</td>
<td align="right">4</td>
<td align="left">BC</td>
<td align="left">BLIND CHANNEL</td>
<td align="right">1021480</td>
<td align="right">1958</td>
<td align="right">7</td>
<td align="right">2016</td>
<td align="right">2</td>
<td align="right">50.42</td>
<td align="right">-125.5</td>
<td align="right">23</td>
<td align="left">N</td>
<td align="right">12.1556</td>
<td align="right">20.2007</td>
<td align="right">6.77689</td>
<td align="right">1.09467</td>
<td align="right">2518.68</td>
</tr>
</tbody>
</table>

<p>Looking at the DataFrame above, we see that there are at least 3 variables that we can use to group our dataset. For example, we can group our data by province (Prov), by year of beginning of recording or year of end of recording.</p>

<p>We will use the Pandas groupby module to group our data.</p>

<ul>
<li><b>.unique()</b> method :</li>
</ul>

<p>Returns the unique values of a column.</p>

<pre><code class="language-python">dataframe[&quot;Prov&quot;].unique() 
</code></pre>

<pre><code>array(['BC', 'YT', 'N   YT', 'NT', 'NU', 'AB', 'SK', 'MB', 'ON', 'QC',
       'NB', 'NS', 'PE', 'NL'], dtype=object)
</code></pre>

<h4 id="split-data-into-groups">Split Data into Groups:</h4>

<pre><code class="language-python">dataframe.groupby('Prov')
</code></pre>

<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x0000000008D35860&gt;
</code></pre>

<ul>
<li><p>To view groups:</p>

<pre><code class="language-python">dataframe.groupby('Prov').groups
</code></pre>

<p>{&lsquo;AB&rsquo;: Int64Index([ 96,  97,  98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108,
             109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121,
             122, 123, 124, 125, 126, 127, 128, 129, 130],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;BC&rsquo;: Int64Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
             17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
             34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49,
             50],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;MB&rsquo;: Int64Index([156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168,
             169, 170, 171, 172, 173, 174, 175],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;N   YT&rsquo;: Int64Index([52], dtype=&lsquo;int64&rsquo;),
 &lsquo;NB&rsquo;: Int64Index([254, 255, 256, 257, 258, 259, 260, 261], dtype=&lsquo;int64&rsquo;),
 &lsquo;NL&rsquo;: Int64Index([275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287,
             288],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;NS&rsquo;: Int64Index([262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273], dtype=&lsquo;int64&rsquo;),
 &lsquo;NT&rsquo;: Int64Index([61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73], dtype=&lsquo;int64&rsquo;),
 &lsquo;NU&rsquo;: Int64Index([74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90,
             91, 92, 93, 94, 95],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;ON&rsquo;: Int64Index([176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188,
             189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201,
             202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214,
             215],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;PE&rsquo;: Int64Index([274], dtype=&lsquo;int64&rsquo;),
 &lsquo;QC&rsquo;: Int64Index([216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228,
             229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241,
             242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;SK&rsquo;: Int64Index([131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143,
             144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155],
            dtype=&lsquo;int64&rsquo;),
 &lsquo;YT&rsquo;: Int64Index([51, 53, 54, 55, 56, 57, 58, 59, 60], dtype=&lsquo;int64&rsquo;)}</p></li>

<li><p>Group by with multiple columns:</p>

<pre><code class="language-python">dataframe.groupby(['Prov','année fin.']).groups
</code></pre>

<p>{(&lsquo;AB&rsquo;, 2011): Int64Index([116], dtype=&lsquo;int64&rsquo;),
 (&lsquo;AB&rsquo;, 2013): Int64Index([101], dtype=&lsquo;int64&rsquo;),
 (&lsquo;AB&rsquo;, 2016): Int64Index([100, 130], dtype=&lsquo;int64&rsquo;),
 (&lsquo;AB&rsquo;,
  2017): Int64Index([ 96,  97,  98,  99, 102, 103, 104, 105, 106, 107, 108, 109, 110,
             111, 112, 113, 114, 115, 117, 118, 119, 120, 121, 122, 123, 124,
             125, 126, 127, 128, 129],
            dtype=&lsquo;int64&rsquo;),
 (&lsquo;BC&rsquo;, 2006): Int64Index([3], dtype=&lsquo;int64&rsquo;),
 (&lsquo;BC&rsquo;, 2013): Int64Index([20], dtype=&lsquo;int64&rsquo;),
 (&lsquo;BC&rsquo;, 2014): Int64Index([21, 25], dtype=&lsquo;int64&rsquo;),
 (&lsquo;BC&rsquo;, 2015): Int64Index([2, 8, 11, 16], dtype=&lsquo;int64&rsquo;),
 (&lsquo;BC&rsquo;, 2016): Int64Index([4, 6, 41], dtype=&lsquo;int64&rsquo;),
 (&lsquo;BC&rsquo;,
  2017): Int64Index([ 0,  1,  5,  7,  9, 10, 12, 13, 14, 15, 17, 18, 19, 22, 23, 24, 26,
             27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 42, 43, 44,
             45, 46, 47, 48, 49, 50],
            dtype=&lsquo;int64&rsquo;),
 (&lsquo;MB&rsquo;, 2016): Int64Index([156], dtype=&lsquo;int64&rsquo;),
 (&lsquo;MB&rsquo;,
  2017): Int64Index([157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169,
             170, 171, 172, 173, 174, 175],
            dtype=&lsquo;int64&rsquo;),
 (&lsquo;N   YT&rsquo;, 2017): Int64Index([52], dtype=&lsquo;int64&rsquo;),
 (&lsquo;NB&rsquo;,
  2017): Int64Index([254, 255, 256, 257, 258, 259, 260, 261], dtype=&lsquo;int64&rsquo;),
 (&lsquo;NL&rsquo;, 2011): Int64Index([282], dtype=&lsquo;int64&rsquo;),
 (&lsquo;NL&rsquo;, 2015): Int64Index([276], dtype=&lsquo;int64&rsquo;)}</p></li>
</ul>

<h3 id="iterating-through-groups">Iterating through Groups:</h3>

<pre><code class="language-python">grouped = dataframe.groupby('Prov')

for name,group in grouped:
   print(name)
   print(group)
</code></pre>

<pre><code>AB
     Unnamed: 0 Prov   Nom de station    stnid  année déb.  mois déb.  \
96           96   AB        ATHABASCA  3060L20        1918          6   
97           97   AB            BANFF  3050519        1887         11   
98           98   AB      BEAVERLODGE  3070600        1913          4   
99           99   AB          CALGARY  3031092        1885          1   


     année fin.  mois fin.  lat (deg)  long (deg)  élév (m) stns jointes  \
96         2017         12      54.82     -113.53       626            Y   
97         2017         12      51.20     -115.55      1397            Y   
98         2017         12      55.20     -119.40       745            Y   
99         2017         12      51.12     -114.02      1084            Y   
</code></pre>

<h4 id="select-a-group">Select a group:</h4>

<ul>
<li><b>.get_group()</b> method:</li>
</ul>

<p>We can select a single group.</p>

<pre><code class="language-python">grouped.get_group('QC').head()
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="left">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">216</td>
<td align="right">216</td>
<td align="left">QC</td>
<td align="left">AMOS</td>
<td align="left">709CEE9</td>
<td align="right">1913</td>
<td align="right">6</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">48.57</td>
<td align="right">-78.13</td>
<td align="right">305</td>
<td align="left">Y</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">217</td>
<td align="right">217</td>
<td align="left">QC</td>
<td align="left">BAGOTVILLE</td>
<td align="left">7060400</td>
<td align="right">1880</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">48.33</td>
<td align="right">-71</td>
<td align="right">159</td>
<td align="left">Y</td>
<td align="right">8.28139</td>
<td align="right">25.2973</td>
<td align="right">-1.83359</td>
<td align="right">-20.8117</td>
<td align="right">1528.41</td>
</tr>

<tr>
<td align="right">218</td>
<td align="right">218</td>
<td align="left">QC</td>
<td align="left">BEAUCEVILLE</td>
<td align="left">7027283</td>
<td align="right">1913</td>
<td align="right">8</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">46.15</td>
<td align="right">-70.7</td>
<td align="right">168</td>
<td align="left">Y</td>
<td align="right">10.5515</td>
<td align="right">26.0783</td>
<td align="right">-1.37634</td>
<td align="right">-19.6283</td>
<td align="right">1509.36</td>
</tr>

<tr>
<td align="right">219</td>
<td align="right">219</td>
<td align="left">QC</td>
<td align="left">BROME</td>
<td align="left">7020840</td>
<td align="right">1890</td>
<td align="right">9</td>
<td align="right">2014</td>
<td align="right">7</td>
<td align="right">45.18</td>
<td align="right">-72.57</td>
<td align="right">206</td>
<td align="left">N</td>
<td align="right">11.1409</td>
<td align="right">26.1767</td>
<td align="right">-0.294151</td>
<td align="right">-17.56</td>
<td align="right">1676.23</td>
</tr>

<tr>
<td align="right">220</td>
<td align="right">220</td>
<td align="left">QC</td>
<td align="left">CAUSAPSCAL</td>
<td align="left">7051200</td>
<td align="right">1913</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">8</td>
<td align="right">48.37</td>
<td align="right">-67.23</td>
<td align="right">168</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>
</tbody>
</table>

<h4 id="aggregations">Aggregations</h4>

<p>An aggregated function returns a single aggregated value for each group. Once the group by object is created, several aggregation operations can be performed on the grouped data.</p>

<p>An obvious one is aggregation via the aggregate or equivalent agg method −</p>

<pre><code class="language-python">dataframe = pd.read_csv(&quot;./DATA/Climato_Stations_ECCC_1981_2010_YEAR.csv&quot;, encoding='latin-1')
grouped = dataframe.groupby('Prov')
</code></pre>

<pre><code class="language-python">grouped['Tmin'].agg(np.mean)
</code></pre>

<pre><code>Prov
AB        -3.050928
BC         1.578024
MB        -4.493900
N   YT          NaN
NB         0.341750
NL        -1.324334
NS         2.542629
NT        -8.518655
NU       -16.522658
ON         0.031970
PE         1.986827
QC        -1.992695
SK        -3.208984
YT        -8.995421
Name: Tmin, dtype: float64
</code></pre>

<h4 id="applying-multiple-aggregation-functions-at-once">Applying Multiple Aggregation Functions at Once</h4>

<p>With grouped Series, you can also pass a list or dict of functions to do aggregation with, and generate DataFrame as output −</p>

<pre><code class="language-python">grouped['Tmin'].agg([np.min, np.mean, np.max, np.std])
</code></pre>

<table>
<thead>
<tr>
<th align="left">Prov</th>
<th align="right">amin</th>
<th align="right">mean</th>
<th align="right">amax</th>
<th align="right">std</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">AB</td>
<td align="right">-6.54421</td>
<td align="right">-3.05093</td>
<td align="right">-0.1559</td>
<td align="right">1.40133</td>
</tr>

<tr>
<td align="left">BC</td>
<td align="right">-6.06858</td>
<td align="right">1.57802</td>
<td align="right">7.01629</td>
<td align="right">3.89638</td>
</tr>

<tr>
<td align="left">MB</td>
<td align="right">-10.0943</td>
<td align="right">-4.4939</td>
<td align="right">-1.98027</td>
<td align="right">2.61835</td>
</tr>

<tr>
<td align="left">N   YT</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="left">NB</td>
<td align="right">-0.491043</td>
<td align="right">0.34175</td>
<td align="right">0.840796</td>
<td align="right">0.598429</td>
</tr>

<tr>
<td align="left">NL</td>
<td align="right">-8.02478</td>
<td align="right">-1.32433</td>
<td align="right">1.81275</td>
<td align="right">3.42585</td>
</tr>

<tr>
<td align="left">NS</td>
<td align="right">1.21413</td>
<td align="right">2.54263</td>
<td align="right">3.75946</td>
<td align="right">0.982653</td>
</tr>

<tr>
<td align="left">NT</td>
<td align="right">-12.4518</td>
<td align="right">-8.51865</td>
<td align="right">-6.68323</td>
<td align="right">2.16937</td>
</tr>

<tr>
<td align="left">NU</td>
<td align="right">-21.9351</td>
<td align="right">-16.5227</td>
<td align="right">-12.2332</td>
<td align="right">3.0491</td>
</tr>

<tr>
<td align="left">ON</td>
<td align="right">-7.48484</td>
<td align="right">0.0319696</td>
<td align="right">5.91872</td>
<td align="right">3.64788</td>
</tr>

<tr>
<td align="left">PE</td>
<td align="right">1.98683</td>
<td align="right">1.98683</td>
<td align="right">1.98683</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="left">QC</td>
<td align="right">-8.76805</td>
<td align="right">-1.99269</td>
<td align="right">1.62212</td>
<td align="right">2.70668</td>
</tr>

<tr>
<td align="left">SK</td>
<td align="right">-5.01656</td>
<td align="right">-3.20898</td>
<td align="right">-1.42885</td>
<td align="right">1.03055</td>
</tr>

<tr>
<td align="left">YT</td>
<td align="right">-10.2177</td>
<td align="right">-8.99542</td>
<td align="right">-7.77313</td>
<td align="right">1.72858</td>
</tr>
</tbody>
</table>

<h4 id="transformations">Transformations</h4>

<p>Transformation on a group or a column returns an object that is indexed the same size of that is being grouped. Thus, the transform should return a result that is the same size as that of a group chunk.</p>

<pre><code class="language-python">grouped = dataframe.groupby('Prov')
and_stand = lambda x: (x - x.mean()) / x.std()
grouped['Tmin'].transform(and_stand).head()
</code></pre>

<pre><code>0         NaN
1   -1.293133
2         NaN
3    0.626082
4    1.334280
Name: Tmin, dtype: float64
</code></pre>

<h4 id="filtration">Filtration</h4>

<p>Filtration filters the data on a defined criteria and returns the subset of data. The filter() function is used to filter the data.</p>

<pre><code class="language-python">dataframe.groupby('Prov').filter(lambda x: len(x) == 1)
</code></pre>

<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">Unnamed: 0</th>
<th align="left">Prov</th>
<th align="left">Nom de station</th>
<th align="right">stnid</th>
<th align="right">année déb.</th>
<th align="right">mois déb.</th>
<th align="right">année fin.</th>
<th align="right">mois fin.</th>
<th align="right">lat (deg)</th>
<th align="right">long (deg)</th>
<th align="right">élév (m)</th>
<th align="left">stns jointes</th>
<th align="right">Tmax</th>
<th align="right">Tmax90p</th>
<th align="right">Tmin</th>
<th align="right">Tmin10p</th>
<th align="right">DG0</th>
</tr>
</thead>

<tbody>
<tr>
<td align="right">52</td>
<td align="right">52</td>
<td align="left">N   YT</td>
<td align="left">HAINES JUNCTIO</td>
<td align="right">2100630</td>
<td align="right">1944</td>
<td align="right">10</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">60.75</td>
<td align="right">-137.5</td>
<td align="right">596</td>
<td align="left">N</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
<td align="right">nan</td>
</tr>

<tr>
<td align="right">274</td>
<td align="right">274</td>
<td align="left">PE</td>
<td align="left">CHARLOTTETOWN</td>
<td align="right">8300301</td>
<td align="right">1872</td>
<td align="right">11</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">46.28</td>
<td align="right">-63.13</td>
<td align="right">49</td>
<td align="left">Y</td>
<td align="right">10.0063</td>
<td align="right">23.7683</td>
<td align="right">1.98683</td>
<td align="right">-12.0367</td>
<td align="right">1912.16</td>
</tr>
</tbody>
</table>

<p>In the above filter condition, we are asking to return the Provinces which have only one station.</p>

<pre><code class="language-python">
</code></pre>

<h3 id="7-2-7-save-a-dataframe">7.2.7  Save a DataFrame:</h3>

<p>For writing a DataFrame, use the <b> .to_csv </b> or <b> _table </b> functions with similar options as read_csv () seen previously.</p>

<pre><code class="language-python">dataframe.to_csv(&quot;./DATA/My_new_DataFrame.csv&quot;, index = False, header = True, sep = ',')
</code></pre>

<h3 id="7-3-date-functionality">7.3 Date Functionality:</h3>

<p>Using the <b>date.range()</b> function by specifying the periods and the frequency, we can create the date series. By default, the frequency of range is Days.</p>

<pre><code class="language-python">pd.date_range('1/1/2011', periods=5)
</code></pre>

<pre><code>DatetimeIndex(['2011-01-01', '2011-01-02', '2011-01-03', '2011-01-04',
               '2011-01-05'],
              dtype='datetime64[ns]', freq='D')
</code></pre>

<p>We can change the date frequency:</p>

<pre><code class="language-python">pd.date_range('1/1/2011', periods=5,freq='M')
</code></pre>

<pre><code>DatetimeIndex(['2011-01-31', '2011-02-28', '2011-03-31', '2011-04-30',
               '2011-05-31'],
              dtype='datetime64[ns]', freq='M')
</code></pre>

<p><b>bdate_range()</b> stands for business date ranges. Unlike date_range(), it excludes Saturday and Sunday.</p>

<pre><code class="language-python">pd.bdate_range('1/1/2011', periods=10)
</code></pre>

<pre><code>DatetimeIndex(['2011-01-03', '2011-01-04', '2011-01-05', '2011-01-06',
               '2011-01-07', '2011-01-10', '2011-01-11', '2011-01-12',
               '2011-01-13', '2011-01-14'],
              dtype='datetime64[ns]', freq='B')
</code></pre>

<p>Convenience functions like date_range and bdate_range utilize a variety of frequency aliases. The default frequency for date_range is a calendar day while the default for bdate_range is a business day.</p>

<pre><code class="language-python">start = pd.datetime(2011, 1, 1)
end = pd.datetime(2011, 1, 5)
pd.date_range(start, end)
</code></pre>

<pre><code>DatetimeIndex(['2011-01-01', '2011-01-02', '2011-01-03', '2011-01-04',
               '2011-01-05'],
              dtype='datetime64[ns]', freq='D')
</code></pre>

<h3 id="7-4-format-dates-with-the-datetime-module">7.4 Format dates with the Datetime module:</h3>

<p>Python provides many features to work with dates and time.</p>

<p>Datetime is a module that allows you to manipulate dates and times as objects. The idea is simple: you manipulate the object to do all your calculations, and when you need to display it, you format the object into a string.</p>

<p><a href="https://docs.python.org/2/library/datetime.html" target="_blank">https://docs.python.org/2/library/datetime.html</a></p>

<p>You can artificially create a datetime object with the following parameters:</p>

<pre><code>    datetime (year, month, day, hour, minute, second, microsecond, timezone)
</code></pre>

<p>The parameters &ldquo;year&rdquo;, &ldquo;month&rdquo; and &ldquo;day&rdquo; are mandatory.</p>

<p>The datetime module provides the following classes:</p>

<p>| Class | Description |
|&ndash;|&ndash;|
| <b>datetime.date</b> | A date instance represents a date |
| <b>datetime.datetime</b> |  An instance of datetime represents a date and time according to the Gregorian calendar |
| <b>datetime.time</b> |  An instance of time represents the time, except for the date |
| <b>datetime.timedelta</b> |The timedelta class is used to keep the differences between two temporal or dated objects |
| <b>datetime.tzinfo</b> |The tzinfo class is used to implement time zone support for time and datetime objects |</p>

<p>We will see some examples of using DateTime and its classe.</p>

<h4 id="1-the-b-datetime-b-class-of-the-datetime-module">1-  The <b> datetime </b> class of the datetime module</h4>

<p><b>-a Creating a datetime object</b></p>

<pre><code class="language-python">from datetime import datetime
datetime(2019, 3, 1)       # instance of datetime
</code></pre>

<pre><code>datetime.datetime(2019, 3, 1, 0, 0)
</code></pre>

<pre><code class="language-python">now = datetime.now()
now
</code></pre>

<pre><code>datetime.datetime(2019, 10, 24, 14, 8, 0, 512783)
</code></pre>

<pre><code class="language-python">now = now.today()
now
</code></pre>

<pre><code>datetime.datetime(2019, 10, 24, 14, 8, 0, 531785)
</code></pre>

<pre><code class="language-python">now = datetime.utcnow()
now
</code></pre>

<pre><code>datetime.datetime(2019, 10, 24, 18, 8, 0, 546785)
</code></pre>

<p>When opening a csv or text file, we have information about the date and time of the measurements but in the form of strings: &ldquo;2018-11-01 15:20&rdquo; or &ldquo;2017/12/1 16:35:22 &ldquo;&hellip;</p>

<p>It is possible during the reading to convert these strings into a datetime object.</p>

<pre><code class="language-python">dt = datetime.strptime(&quot;2018/11/01 15:20&quot;, &quot;%Y/%m/%d %H:%M&quot;)
dt
</code></pre>

<pre><code>datetime.datetime(2018, 11, 1, 15, 20)
</code></pre>

<pre><code class="language-python">dt = datetime.strptime(&quot;2017/12/1 16:35:22&quot;, &quot;%Y/%m/%d %H:%M:%S&quot;)
dt
</code></pre>

<pre><code>datetime.datetime(2017, 12, 1, 16, 35, 22)
</code></pre>

<pre><code class="language-python">dt = datetime.strptime(&quot;01/11/19 10-35:22&quot;, &quot;%d/%m/%y %H-%M:%S&quot;)
dt

</code></pre>

<pre><code>datetime.datetime(2019, 11, 1, 10, 35, 22)
</code></pre>

<pre><code class="language-python">dt = datetime.strptime(&quot;1Mar 2019 à 09h35&quot;, &quot;%d%b %Y à %Hh%M&quot;)
dt
</code></pre>

<pre><code>datetime.datetime(2019, 3, 1, 9, 35)
</code></pre>

<p><b>b- Manipulate datetime object</b></p>

<p>From an object or instance of datetime, you can retrieve the time and date.</p>

<pre><code class="language-python">#now.year
#now.month
#now.day
#maintenant.hour
now.minute
#now.second
#now.microsecond
#now
</code></pre>

<pre><code>8
</code></pre>

<p>We can change datetime instance:</p>

<pre><code class="language-python">now.replace(year=1995) 
</code></pre>

<pre><code>datetime.datetime(1995, 10, 24, 18, 8, 0, 546785)
</code></pre>

<pre><code class="language-python">now.replace(month=1)
</code></pre>

<pre><code>datetime.datetime(2019, 1, 24, 18, 8, 0, 546785)
</code></pre>

<p>We can then convert datetime instance to string:</p>

<pre><code class="language-python">d = datetime.now(); print(d)
d
</code></pre>

<pre><code>2019-10-24 14:08:00.720795





datetime.datetime(2019, 10, 24, 14, 8, 0, 720795)
</code></pre>

<pre><code class="language-python">d.strftime(&quot;%H:%M&quot;), d.strftime(&quot;%Hh%Mmin&quot;)
</code></pre>

<pre><code>('14:08', '14h08min')
</code></pre>

<pre><code class="language-python">d.strftime(&quot;%Y-%m %H:%M&quot;)
</code></pre>

<pre><code>'2019-10 14:08'
</code></pre>

<pre><code class="language-python">'The day today is {0:%d} {0:%B} and it s  {0:%Hh%Mmin} '.format(d, &quot;day&quot;, &quot;month&quot;, &quot;time&quot;)
</code></pre>

<pre><code>'The day today is 24 October and it s  14h08min '
</code></pre>

<ul>
<li><b>date</b> et <b>time</b> class</li>
</ul>

<p>These two classes can be used to create a datetime instance.</p>

<pre><code class="language-python">from datetime import datetime, date, time
d = date(2005, 7, 14)
t = time(12, 30)
t
</code></pre>

<pre><code>datetime.time(12, 30)
</code></pre>

<pre><code class="language-python">datetime.combine(d, t)
</code></pre>

<pre><code>datetime.datetime(2005, 7, 14, 12, 30)
</code></pre>

<pre><code class="language-python">now = datetime.utcnow()
now.date()
now.time()

</code></pre>

<pre><code>datetime.time(18, 8, 0, 855803)
</code></pre>

<ul>
<li><p>The <b> timedelta </b> class of the datetime module</p>

<pre><code class="language-python">from datetime import timedelta
delta = timedelta(days=3, seconds=100)    # we create our own timedelta
</code></pre>

<pre><code class="language-python">datetime.now()
</code></pre>

<p>datetime.datetime(2019, 10, 24, 14, 8, 0, 899806)</p>

<pre><code class="language-python">datetime.now() + delta
</code></pre>

<p>datetime.datetime(2019, 10, 27, 14, 9, 40, 935808)</p>

<pre><code class="language-python">datetime.now() + timedelta(days=2, hours=4, minutes=3, seconds=12)
</code></pre>

<p>datetime.datetime(2019, 10, 26, 18, 11, 12, 966809)</p>

<pre><code class="language-python">time_range = datetime(2010, 12, 31) - datetime(1981, 12, 31)
time_range
</code></pre>

<p>datetime.timedelta(days=10592)</p></li>

<li><p>Example1: Calculate the year of birth from a given age</p>

<pre><code class="language-python">from datetime import datetime
 
old = 25
month = 10
 
actual_year = datetime.today().year
actual_month = datetime.today().month
 
result = actual_year - old - (1 if month &gt; actual_month else 0)
print(result)
</code></pre>

<p>1994</p></li>

<li><p>Example2: Calculate the year of birth from a given age</p></li>
</ul>

<p>We can  generate dates for time series with an arbitrary time step:</p>

<pre><code class="language-python">from datetime import timedelta
dt = timedelta(days = 5, hours = 6, minutes = 25)
d0 = datetime(2000, 2, 21)
[str(d0 + i * dt) for i in range(10)]
</code></pre>

<pre><code>['2000-02-21 00:00:00',
 '2000-02-26 06:25:00',
 '2000-03-02 12:50:00',
 '2000-03-07 19:15:00',
 '2000-03-13 01:40:00',
 '2000-03-18 08:05:00',
 '2000-03-23 14:30:00',
 '2000-03-28 20:55:00',
 '2000-04-03 03:20:00',
 '2000-04-08 09:45:00']
</code></pre>

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/tutorial_python/6-numpy_library/" rel="next">6 Numpy library</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/tutorial_python/8-matplotlib_library/" rel="prev">8 Matplotlib library</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on May 5, 2019</p>

          





  
  

<p class="edit-page">
  <a href="https://github.com/gcushen/hugo-academic/edit/master/content/courses/Tutorial_Python/7-Pandas_Library.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          

        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
