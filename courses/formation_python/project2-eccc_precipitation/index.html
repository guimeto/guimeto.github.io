<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.6.2">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Guillaume Dueymes">

  
  
  
    
  
  <meta name="description" content="Objectifs Projet 2: Données de précipitation d&rsquo;Environnement et Changement Climatique Canada Nous continuerons de découvrir la fonctionnalité de ces bibliothèques dans un cas pratique en analysant maintenant les données de précipitations quotidiennes enregistrées par les stations ECCC situées à l&rsquo;aéroport de Montréal Trudeau entre la période 1961 et 2010.
Nous utiliserons le fichier &lsquo;MONTREAL_preacc_1961_2010.dat&rsquo; dans le répertoire .data /.
1- Ouverture et lecture de nos séries de données import numpy as np import pandas as pd import datetime from datetime import date import numpy as np import warnings warnings.">

  
  <link rel="alternate" hreflang="en-us" href="/courses/formation_python/project2-eccc_precipitation/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/courses/formation_python/project2-eccc_precipitation/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="GDueymes">
  <meta property="og:url" content="/courses/formation_python/project2-eccc_precipitation/">
  <meta property="og:title" content="9.2- Projet sur les données de précipitations ECCC | GDueymes">
  <meta property="og:description" content="Objectifs Projet 2: Données de précipitation d&rsquo;Environnement et Changement Climatique Canada Nous continuerons de découvrir la fonctionnalité de ces bibliothèques dans un cas pratique en analysant maintenant les données de précipitations quotidiennes enregistrées par les stations ECCC situées à l&rsquo;aéroport de Montréal Trudeau entre la période 1961 et 2010.
Nous utiliserons le fichier &lsquo;MONTREAL_preacc_1961_2010.dat&rsquo; dans le répertoire .data /.
1- Ouverture et lecture de nos séries de données import numpy as np import pandas as pd import datetime from datetime import date import numpy as np import warnings warnings."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-05T00:00:00&#43;01:00">
    
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  

  



  


  


  





  <title>9.2- Projet sur les données de précipitations ECCC | GDueymes</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    
    
      <a class="navbar-brand" href="/">GDueymes</a>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publications"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Guillaume_Dueymes2019.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/formation_python/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/formation_python/1-introduction/">Formation en Python</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/formation_python/1-introduction/">1- Introduction</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/2-les_bases/">2- Les bases du language Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/2-les_bases-exercice/">2- Les bases du language Python - Exercices</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/3-les_listes/">3- Les listes en Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/3-les_listes-exercice/">3- Les listes en Python - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/4-les_dictionnaires/">4- Les dictionnaires en Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/4-les_dictionnaires-exercice/">4- Les dictionnaires en Python - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/5-les_boucles/">5- Les boucles en Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/5-les_boucles-exercice/">5- Les boucles en Python - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/6-les_fonctions/">6- Les fonctions en Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/6-les_fonctions-exercice/">6- Les fonctions en Python - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/7-numpy/">7- La librairie Numpy - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/7-numpy-exercice/">7- La librairie Numpy - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/8-pandas/">8- La lirairie Pandas - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/8-pandas-exercice/">8- La librairie Pandas - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/9-visualisation/">9- La visualisation graphique avec Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/9-visualisation-exercice/">9- La visualisation graphique avec Python - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/project1-eccc_temperature/">9.1- Projet sur les données de températures ECCC</a>
      </li>
      
      <li class="active">
        <a href="/courses/formation_python/project2-eccc_precipitation/">9.2- Projet sur les données de précipitations ECCC</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/10-api-cours/">10- Travailler avec des API sous Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/10-api-exercices/">10- Travailler avec des API sous Python - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/11-web-scraping-cours/">11- Web Scrapping - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/11-web-scraping-exercices/">11- Web scrapping - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/12-requeter-une-base-sql-cours/">12- SQL et Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/12-requeter-une-base-sql-exercices/">12- SQL et Python - Exercice</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/13-regex-cours/">13- Regex et Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/14-statistique-descriptive-cours/">14- La statistique descriptive - Rappels</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/15.1-netcdf_tutorial/">15-1- Le format Netcdf sous Python - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/15.2-cartopy_library/">15-2- La librairie Cartopy - Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/15.3-xarray_library/">15-3 La librairie Xarray- Cours</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/16-1-niveau_facile/">16.1- Exercices Python - Niveau facile</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/16-2-niveau_intermediaire/">16.2- Exercices Python - Niveau intermédiaire</a>
      </li>
      
      <li >
        <a href="/courses/formation_python/16-3-niveau-difficile/">16.3- Exercices Python - Niveau difficile</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#objectifs">Objectifs</a></li>
    <li><a href="#projet-2-données-de-précipitation-denvironnement-et-changement-climatique-canada">Projet 2: Données de précipitation d&rsquo;Environnement et Changement Climatique Canada</a></li>
    <li><a href="#1--ouverture-et-lecture-de-nos-séries-de-données">1- Ouverture et lecture de nos séries de données</a></li>
    <li><a href="#2--application-des-indices-de-précipitations">2- Application des indices de précipitations:</a></li>
    <li><a href="#3--filtrer-les-données-directement-sur-notre-dataframe">3- Filtrer les données directement sur notre DataFrame</a></li>
    <li><a href="#4--mise-à-jour-de-notre-dataframe-initial">4- Mise à jour de notre DataFrame initial</a></li>
    <li><a href="#4--visualisation-des-résultats">4- Visualisation des résultats</a>
      <ul>
        <li><a href="#bonus-ajoutez-des-indices-de-corrélation-avec-la-bibliothèque-scipy">Bonus: ajoutez des indices de corrélation avec la bibliothèque scipy</a></li>
      </ul>
    </li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>9.2- Projet sur les données de précipitations ECCC</h1>

          <div class="article-style">
            <p><img src="/img/formation/pylogo.png" alt="image0"></p>
<h2 id="objectifs">Objectifs</h2>
<h2 id="projet-2-données-de-précipitation-denvironnement-et-changement-climatique-canada">Projet 2: Données de précipitation d&rsquo;Environnement et Changement Climatique Canada</h2>
<p>Nous continuerons de découvrir la fonctionnalité de ces bibliothèques dans un cas pratique en analysant maintenant les données de précipitations quotidiennes enregistrées par les stations ECCC situées à l&rsquo;aéroport de Montréal Trudeau entre la période 1961 et 2010.</p>
<p>Nous utiliserons le fichier &lsquo;MONTREAL_preacc_1961_2010.dat&rsquo; dans le répertoire .data /.</p>
<h2 id="1--ouverture-et-lecture-de-nos-séries-de-données">1- Ouverture et lecture de nos séries de données</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> datetime
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> date
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np 
<span style="color:#f92672">import</span> warnings
warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#34;ignore&#34;</span>)

df_Precipitation <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
<span style="color:#75715e"># Ouverture du fichier text  </span>
<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;./DATA/MONTREAL_preacc_1961_2010.dat&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> file:
     rows <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>read()
data_EC_Montreal <span style="color:#f92672">=</span> [float(row) <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> rows<span style="color:#f92672">.</span>split()]  

<span style="color:#75715e"># We know that the time series begins on January 1, 1961</span>
<span style="color:#75715e"># and ends on December 31, 2010</span>
<span style="color:#75715e"># We can rebuild the index of Dataframes</span>

start <span style="color:#f92672">=</span> date(<span style="color:#ae81ff">1961</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
end <span style="color:#f92672">=</span> date(<span style="color:#ae81ff">2010</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">31</span>)
delta<span style="color:#f92672">=</span>(end<span style="color:#f92672">-</span>start) 
nb_days <span style="color:#f92672">=</span> delta<span style="color:#f92672">.</span>days <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> 
rng <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>date_range(start, periods<span style="color:#f92672">=</span>nb_days, freq<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;D&#39;</span>)

<span style="color:#75715e"># Create a column from the datetime datatype</span>
df_Precipitation[<span style="color:#e6db74">&#39;datetime&#39;</span>] <span style="color:#f92672">=</span> rng
<span style="color:#75715e"># Set the datetime column as the index</span>
df_Precipitation<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> df_Precipitation[<span style="color:#e6db74">&#39;datetime&#39;</span>] 

<span style="color:#75715e"># Create a column from the numeric score variable</span>
df_Precipitation[<span style="color:#e6db74">&#39;Precipitation Montreal&#39;</span>] <span style="color:#f92672">=</span> data_EC_Montreal
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df_Precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(df_Precipitation<span style="color:#f92672">.</span>head(), headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            | datetime            |   Precipitation Montreal |
|:--------------------|:--------------------|-------------------------:|
| 1961-01-01 00:00:00 | 1961-01-01 00:00:00 |                    22.66 |
| 1961-01-02 00:00:00 | 1961-01-02 00:00:00 |                     1.05 |
| 1961-01-03 00:00:00 | 1961-01-03 00:00:00 |                     1.05 |
| 1961-01-04 00:00:00 | 1961-01-04 00:00:00 |                     0.66 |
| 1961-01-05 00:00:00 | 1961-01-05 00:00:00 |                     0    |
</code></pre>
<h2 id="2--application-des-indices-de-précipitations">2- Application des indices de précipitations:</h2>
<ul>
<li>CDD: calcul du nombre maximum de jours secs consécutifs (Précipitations &lt;1mm)</li>
<li>CWD: calcul du nombre maximum de jours de pluie consécutifs (Précipitations&gt; 1mm)</li>
<li>Prcp1: calcul du pourcentage de jours de précipitations (Précipitations&gt; 1mm)</li>
<li>SDII: calcul de l&rsquo;intensité moyenne des précipitations pour les jours de pluie (Précipitations&gt; 1mm</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># calculation of the maximum number of consecutive dry days (inf to 1mm) </span>
<span style="color:#75715e"># on the incoming signal (less than 20% of missing values) </span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">CDD</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     ind_CDD<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
     <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
         ind_CDD <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_CDD <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">else</span>:
         temp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
         ind_CDD <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> 
         j <span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
         <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> N2):
             <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> N2 ) <span style="color:#f92672">and</span> (S_no_nan[j] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1.0</span> ):
                 j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
                 temp <span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
             <span style="color:#66d9ef">if</span> ind_CDD <span style="color:#f92672">&lt;</span> temp:
                 ind_CDD <span style="color:#f92672">=</span> temp
             temp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
             j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> 
     <span style="color:#66d9ef">return</span> ind_CDD      
 
<span style="color:#75715e"># calculation of the maximum number of consecutive wet days (sup to 1mm) </span>
<span style="color:#75715e"># on the incoming signal (less than 20% of missing values) </span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">CWD</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     ind_CWD<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
     <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
         ind_CWD <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_CWD <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">else</span>:
         temp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
         ind_CWD <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> 
         j <span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
         <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> N2):
             <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> N2 ) <span style="color:#f92672">and</span> (S_no_nan[j] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1.0</span> ):
                 j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
                 temp <span style="color:#f92672">+=</span><span style="color:#ae81ff">1</span>
             <span style="color:#66d9ef">if</span> ind_CWD <span style="color:#f92672">&lt;</span> temp:
                 ind_CWD <span style="color:#f92672">=</span> temp
             temp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
             j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> 
     <span style="color:#66d9ef">return</span> ind_CWD  

<span style="color:#75715e"># Calculation of the percentage of precipitation days </span>
<span style="color:#75715e"># on the incoming signal (less than 20% of missing values)</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">Prcp1</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     ind_Prcp1<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
     <span style="color:#66d9ef">if</span> (N2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>):
         N2<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
         
     <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
         ind_Prcp1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_Prcp1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">else</span>:
         ind_Prcp1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
         <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> S_no_nan:
             <span style="color:#66d9ef">if</span> row <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1</span> :
                 ind_Prcp1 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span> 
                 
         ind_Prcp1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">*</span> (ind_Prcp1<span style="color:#f92672">/</span>N2)
     <span style="color:#66d9ef">return</span> ind_Prcp1     

<span style="color:#75715e"># average precipitation intensity for wet days (PR greater than 1mm) (less than 20% missing values)</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">SDII</span>(S):
     <span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
     ind_SDII<span style="color:#f92672">=</span>[]
     S_no_nan <span style="color:#f92672">=</span> S[<span style="color:#f92672">~</span>np<span style="color:#f92672">.</span>isnan(S)]
     N <span style="color:#f92672">=</span> len(S)
     N2 <span style="color:#f92672">=</span> len(S_no_nan)
     <span style="color:#66d9ef">if</span> ((N2<span style="color:#f92672">/</span>N) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.8</span>): 
         ind_SDII <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty(<span style="color:#ae81ff">1</span>)
         ind_SDII <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nan
     <span style="color:#66d9ef">else</span>:
         SS <span style="color:#f92672">=</span> S[S <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>]        
         ind_SDII <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nanmean(SS)
     <span style="color:#66d9ef">return</span> ind_SDII      
</code></pre></div><p>Les fonctions précédentes permettent de calculer des indices de précipitations sur un signal journalier. Nous voulons appliquer ces fonctions chaque mois.</p>
<p>Nous devons donc travailler avec un sous-ensemble de notre dataframe <!-- raw HTML omitted --> df_Precipitation <!-- raw HTML omitted --> groupé par mois.</p>
<p>De la même manière que la section précédente sur les températures, nous appliquerons la méthode <!-- raw HTML omitted --> .resample (&lsquo;M&rsquo;) <!-- raw HTML omitted -->: &ldquo;M&rdquo; pendant des mois (il est possible ici de travailler à l&rsquo;échelle de la semaine, de la saison ou de l&rsquo;année)
Pour rappel, à ce stade il n&rsquo;y a pas de calcul, les données sont simplement triées sur une base mensuelle.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df_Precipitation_resamp <span style="color:#f92672">=</span> df_Precipitation<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;M&#39;</span>)
df_Precipitation_resamp<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>head()            
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(df_Precipitation_resamp<span style="color:#f92672">.</span>count()<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   datetime |   Precipitation Montreal |
|:--------------------|-----------:|-------------------------:|
| 1961-01-31 00:00:00 |         31 |                       31 |
| 1961-02-28 00:00:00 |         28 |                       28 |
| 1961-03-31 00:00:00 |         31 |                       31 |
| 1961-04-30 00:00:00 |         30 |                       30 |
| 1961-05-31 00:00:00 |         31 |                       31 |
</code></pre>
<p>Nous pouvons maintenant appliquer nos fonctions définies précédemment pour chaque mois de notre DataFrame. Pour cela, nous utiliserons la méthode <!-- raw HTML omitted --> .agg () <!-- raw HTML omitted --> sur notre sous-ensemble groupé par mois.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation <span style="color:#f92672">=</span> df_Precipitation_resamp<span style="color:#f92672">.</span>agg([CDD, CWD, Prcp1, SDII, np<span style="color:#f92672">.</span>sum, np<span style="color:#f92672">.</span>mean])
indice_precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(indice_precipitation<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   ('Precipitation Montreal', 'CDD') |   ('Precipitation Montreal', 'CWD') |   ('Precipitation Montreal', 'Prcp1') |   ('Precipitation Montreal', 'SDII') |   ('Precipitation Montreal', 'sum') |   ('Precipitation Montreal', 'mean') |
|:--------------------|------------------------------------:|------------------------------------:|--------------------------------------:|-------------------------------------:|------------------------------------:|-------------------------------------:|
| 1961-01-31 00:00:00 |                                  14 |                                   3 |                               29.0323 |                              5.69111 |                               55.09 |                              1.7771  |
| 1961-02-28 00:00:00 |                                  12 |                                   3 |                               28.5714 |                              9.895   |                               80.87 |                              2.88821 |
| 1961-03-31 00:00:00 |                                  16 |                                   3 |                               25.8065 |                             11.8687  |                               97.59 |                              3.14806 |
| 1961-04-30 00:00:00 |                                   4 |                                   3 |                               50      |                              6.68333 |                              102.7  |                              3.42333 |
| 1961-05-31 00:00:00 |                                   5 |                                   3 |                               41.9355 |                              5.13    |                               70.22 |                              2.26516 |
</code></pre>
<h2 id="3--filtrer-les-données-directement-sur-notre-dataframe">3- Filtrer les données directement sur notre DataFrame</h2>
<ul>
<li>les données peuvent être filtrées selon une condition sur une colonne.</li>
</ul>
<p>On n&rsquo;extraira par exemple que les données de précipitations supérieures ou égales à 1 mm.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">SDII2<span style="color:#f92672">=</span>df_Precipitation[df_Precipitation[<span style="color:#e6db74">&#34;Precipitation Montreal&#34;</span>]<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">1.0</span>]
SDII2<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(SDII2<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            | datetime            |   Precipitation Montreal |
|:--------------------|:--------------------|-------------------------:|
| 1961-01-01 00:00:00 | 1961-01-01 00:00:00 |                    22.66 |
| 1961-01-02 00:00:00 | 1961-01-02 00:00:00 |                     1.05 |
| 1961-01-03 00:00:00 | 1961-01-03 00:00:00 |                     1.05 |
| 1961-01-06 00:00:00 | 1961-01-06 00:00:00 |                     8.65 |
| 1961-01-07 00:00:00 | 1961-01-07 00:00:00 |                     4.05 |
</code></pre>
<p>Nous avons d&rsquo;abord créé un masque de type booléen sur la colonne «Précipitation Montréal» qui a ensuite été appliqué à notre DataFrame.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">(df_Precipitation[<span style="color:#e6db74">&#34;Precipitation Montreal&#34;</span>]<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">1.0</span>)<span style="color:#f92672">.</span>head()
</code></pre></div><pre><code>datetime
1961-01-01     True
1961-01-02     True
1961-01-03     True
1961-01-04    False
1961-01-05    False
Name: Precipitation Montreal, dtype: bool
</code></pre>
<p>Nous regroupons ensuite notre DataFrame par mois et nous appliquons une fonction en appelant la méthode .agg ().</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">SDII2 <span style="color:#f92672">=</span> SDII2<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;M&#39;</span>)<span style="color:#f92672">.</span>agg({<span style="color:#e6db74">&#39;SDII2&#39;</span>: <span style="color:#66d9ef">lambda</span> x: x<span style="color:#f92672">.</span>mean()})
SDII2<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(SDII2<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   ('SDII2', 'Precipitation Montreal') |
|:--------------------|--------------------------------------:|
| 1961-01-31 00:00:00 |                               5.69111 |
| 1961-02-28 00:00:00 |                               9.895   |
| 1961-03-31 00:00:00 |                              11.8688  |
| 1961-04-30 00:00:00 |                               6.68333 |
| 1961-05-31 00:00:00 |                               5.13    |
</code></pre>
<h2 id="4--mise-à-jour-de-notre-dataframe-initial">4- Mise à jour de notre DataFrame initial</h2>
<p>Nous voulons ajouter à notre DataFrame initial la variable SDII2 précédemment créée.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation[<span style="color:#e6db74">&#34;SDII2&#34;</span>]<span style="color:#f92672">=</span>SDII2[:]<span style="color:#f92672">.</span>values
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(indice_precipitation<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   ('Precipitation Montreal', 'CDD') |   ('Precipitation Montreal', 'CWD') |   ('Precipitation Montreal', 'Prcp1') |   ('Precipitation Montreal', 'SDII') |   ('Precipitation Montreal', 'sum') |   ('Precipitation Montreal', 'mean') |   ('SDII2', '') |
|:--------------------|------------------------------------:|------------------------------------:|--------------------------------------:|-------------------------------------:|------------------------------------:|-------------------------------------:|----------------:|
| 1961-01-31 00:00:00 |                                  14 |                                   3 |                               29.0323 |                              5.69111 |                               55.09 |                              1.7771  |         5.69111 |
| 1961-02-28 00:00:00 |                                  12 |                                   3 |                               28.5714 |                              9.895   |                               80.87 |                              2.88821 |         9.895   |
| 1961-03-31 00:00:00 |                                  16 |                                   3 |                               25.8065 |                             11.8687  |                               97.59 |                              3.14806 |        11.8688  |
| 1961-04-30 00:00:00 |                                   4 |                                   3 |                               50      |                              6.68333 |                              102.7  |                              3.42333 |         6.68333 |
| 1961-05-31 00:00:00 |                                   5 |                                   3 |                               41.9355 |                              5.13    |                               70.22 |                              2.26516 |         5.13    |
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> indice_precipitation<span style="color:#f92672">.</span>columns<span style="color:#f92672">.</span>droplevel(<span style="color:#ae81ff">0</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(indice_precipitation<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   CDD |   CWD |   Prcp1 |     SDII |    sum |    mean |          |
|:--------------------|------:|------:|--------:|---------:|-------:|--------:|---------:|
| 1961-01-31 00:00:00 |    14 |     3 | 29.0323 |  5.69111 |  55.09 | 1.7771  |  5.69111 |
| 1961-02-28 00:00:00 |    12 |     3 | 28.5714 |  9.895   |  80.87 | 2.88821 |  9.895   |
| 1961-03-31 00:00:00 |    16 |     3 | 25.8065 | 11.8687  |  97.59 | 3.14806 | 11.8688  |
| 1961-04-30 00:00:00 |     4 |     3 | 50      |  6.68333 | 102.7  | 3.42333 |  6.68333 |
| 1961-05-31 00:00:00 |     5 |     3 | 41.9355 |  5.13    |  70.22 | 2.26516 |  5.13    |
</code></pre>
<p>En utilisant la colonne index datetime, nous voulons créer de nouvelles colonnes avec l&rsquo;année et le mois.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation[<span style="color:#e6db74">&#39;year&#39;</span>]  <span style="color:#f92672">=</span> indice_precipitation<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>year
indice_precipitation[<span style="color:#e6db74">&#39;month&#39;</span>]  <span style="color:#f92672">=</span> indice_precipitation<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>month
indice_precipitation[<span style="color:#e6db74">&#39;month&#39;</span>] <span style="color:#f92672">=</span> indice_precipitation<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%b&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(indice_precipitation<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   CDD |   CWD |   Prcp1 |     SDII |    sum |    mean |          |   year | month   |
|:--------------------|------:|------:|--------:|---------:|-------:|--------:|---------:|-------:|:--------|
| 1961-01-31 00:00:00 |    14 |     3 | 29.0323 |  5.69111 |  55.09 | 1.7771  |  5.69111 |   1961 | Jan     |
| 1961-02-28 00:00:00 |    12 |     3 | 28.5714 |  9.895   |  80.87 | 2.88821 |  9.895   |   1961 | Feb     |
| 1961-03-31 00:00:00 |    16 |     3 | 25.8065 | 11.8687  |  97.59 | 3.14806 | 11.8688  |   1961 | Mar     |
| 1961-04-30 00:00:00 |     4 |     3 | 50      |  6.68333 | 102.7  | 3.42333 |  6.68333 |   1961 | Apr     |
| 1961-05-31 00:00:00 |     5 |     3 | 41.9355 |  5.13    |  70.22 | 2.26516 |  5.13    |   1961 | May     |
</code></pre>
<p>Nous voulons sauvegarder notre Dataframe <!-- raw HTML omitted --> indice_precipitation <!-- raw HTML omitted -->.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#39;indice_precipitation.csv&#39;</span>)
</code></pre></div><h2 id="4--visualisation-des-résultats">4- Visualisation des résultats</h2>
<p>Nous allons visualiser notre dataframe final <!-- raw HTML omitted --> index_precipitation <!-- raw HTML omitted --> avec la bibliothèque Seaborn.</p>
<p><img src="/img/formation/seaborn.png" alt="image0"></p>
<p>Cependant, nous verrons quelques exemples avec des graphiques multidimensionnels.</p>
<ul>
<li>Boxplot: fonction <!-- raw HTML omitted --> boxplot () <!-- raw HTML omitted --></li>
</ul>
<p>Utilisons notre DataFrame de précipitations:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns 
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt 
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(indice_precipitation<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   CDD |   CWD |   Prcp1 |     SDII |    sum |    mean |          |   year | month   |
|:--------------------|------:|------:|--------:|---------:|-------:|--------:|---------:|-------:|:--------|
| 1961-01-31 00:00:00 |    14 |     3 | 29.0323 |  5.69111 |  55.09 | 1.7771  |  5.69111 |   1961 | Jan     |
| 1961-02-28 00:00:00 |    12 |     3 | 28.5714 |  9.895   |  80.87 | 2.88821 |  9.895   |   1961 | Feb     |
| 1961-03-31 00:00:00 |    16 |     3 | 25.8065 | 11.8687  |  97.59 | 3.14806 | 11.8688  |   1961 | Mar     |
| 1961-04-30 00:00:00 |     4 |     3 | 50      |  6.68333 | 102.7  | 3.42333 |  6.68333 |   1961 | Apr     |
| 1961-05-31 00:00:00 |     5 |     3 | 41.9355 |  5.13    |  70.22 | 2.26516 |  5.13    |   1961 | May     |
</code></pre>
<p>Nous voulons visualiser le nombre de jours avec des précipitations par mois. Nous allons ensuite tracer la variable Prcp1 à partir de notre DataFrame.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt 
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
sns<span style="color:#f92672">.</span>boxplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;month&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Prcp1&#34;</span>, data<span style="color:#f92672">=</span>indice_precipitation, palette<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Set1&#34;</span>) 

ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Number of days with precipitation in Montreal from 1948 to 2017&#39;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;%&#39;</span>)

figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>) 
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/img/formation/prec1.png" alt="image0"></p>
<ul>
<li>Histogramme: fonction <!-- raw HTML omitted --> barplot () <!-- raw HTML omitted --></li>
</ul>
<p>Pour cet exemple, nous allons tracer l&rsquo;accumulation moyenne de la pré-participation par mois, pour ce faire, nous devons utiliser la variable «sum».</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes()
sns<span style="color:#f92672">.</span>barplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;month&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sum&#34;</span>, data<span style="color:#f92672">=</span>indice_precipitation)
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Monthly mean of cumulated precipitation in Montréal from 1948 to 2017&#39;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;mm&#39;</span>)

figure <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>get_figure()    
figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>) 
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/img/formation/prec2.png" alt="image0"></p>
<ul>
<li>graphe bivarié: fonction <!-- raw HTML omitted --> jointplot () <!-- raw HTML omitted --></li>
</ul>
<p>Jointplot affiche une relation entre 2 variables (bivariée)</p>
<p><a href="https://seaborn.pydata.org/generated/seaborn.jointplot.html">https://seaborn.pydata.org/generated/seaborn.jointplot.html</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sns<span style="color:#f92672">.</span>jointplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Prcp1&#34;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sum&#34;</span>, data<span style="color:#f92672">=</span>indice_precipitation,kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;reg&#39;</span>,
                   space<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, height<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>, ratio<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)
plt<span style="color:#f92672">.</span>show()

<span style="color:#75715e"># kind = &#39;kde&#39; </span>
<span style="color:#75715e"># kind=&#34;hex&#34;</span>
<span style="color:#75715e"># kind=&#34;reg&#34;</span>
</code></pre></div><p><img src="/img/formation/prec3.png" alt="image0"></p>
<ul>
<li>graphe bivarié: fonction <!-- raw HTML omitted --> pairplot () <!-- raw HTML omitted -->
<a href="https://seaborn.pydata.org/generated/seaborn.pairplot.html">https://seaborn.pydata.org/generated/seaborn.pairplot.html</a></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Attributes of interest</span>
cols <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;CWD&#39;</span>, 
        <span style="color:#e6db74">&#39;SDII&#39;</span>, 
        <span style="color:#e6db74">&#39;sum&#39;</span>, 
        <span style="color:#e6db74">&#39;Prcp1&#39;</span>, 
        <span style="color:#e6db74">&#39;mean&#39;</span>]

pp <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>pairplot(indice_precipitation[cols], 
                  height<span style="color:#f92672">=</span><span style="color:#ae81ff">1.8</span>, aspect<span style="color:#f92672">=</span><span style="color:#ae81ff">1.2</span>, markers<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;+&#34;</span>,
                  plot_kws<span style="color:#f92672">=</span>dict(edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;k&#34;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>),
                  diag_kws<span style="color:#f92672">=</span>dict(shade<span style="color:#f92672">=</span>True), <span style="color:#75715e"># &#34;diag&#34; adjusts/tunes the diagonal plots</span>
                  diag_kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;kde&#34;</span>) <span style="color:#75715e"># use &#34;kde&#34; for diagonal plots</span>

fig <span style="color:#f92672">=</span> pp<span style="color:#f92672">.</span>fig 
fig<span style="color:#f92672">.</span>subplots_adjust(top<span style="color:#f92672">=</span><span style="color:#ae81ff">0.93</span>, wspace<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
fig<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#39;Indice de précipitation Pairwise Plots&#39;</span>, 
              fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)
plt<span style="color:#f92672">.</span>show()



</code></pre></div><p><img src="/img/formation/prec4.png" alt="image0"></p>
<ul>
<li>Matrice de corrélation:
La bibliothèque Pandas dispose d&rsquo;une méthode pour calculer les corrélations entre chaque colonne d&rsquo;un DataFrame.</li>
</ul>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.corr.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.corr.html</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(indice_precipitation<span style="color:#f92672">.</span>head() , headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>| datetime            |   CDD |   CWD |   Prcp1 |     SDII |    sum |    mean |          |   year | month   |
|:--------------------|------:|------:|--------:|---------:|-------:|--------:|---------:|-------:|:--------|
| 1961-01-31 00:00:00 |    14 |     3 | 29.0323 |  5.69111 |  55.09 | 1.7771  |  5.69111 |   1961 | Jan     |
| 1961-02-28 00:00:00 |    12 |     3 | 28.5714 |  9.895   |  80.87 | 2.88821 |  9.895   |   1961 | Feb     |
| 1961-03-31 00:00:00 |    16 |     3 | 25.8065 | 11.8687  |  97.59 | 3.14806 | 11.8688  |   1961 | Mar     |
| 1961-04-30 00:00:00 |     4 |     3 | 50      |  6.68333 | 102.7  | 3.42333 |  6.68333 |   1961 | Apr     |
| 1961-05-31 00:00:00 |     5 |     3 | 41.9355 |  5.13    |  70.22 | 2.26516 |  5.13    |   1961 | May     |
</code></pre>
<p>Nous supprimons d&rsquo;abord la colonne «année», puis appliquons la méthode .corr ().</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation2 <span style="color:#f92672">=</span> indice_precipitation<span style="color:#f92672">.</span>drop([<span style="color:#e6db74">&#34;year&#34;</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
corr_matrix <span style="color:#f92672">=</span> indice_precipitation2<span style="color:#f92672">.</span>corr()
corr_matrix
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tabulate <span style="color:#f92672">import</span> tabulate
<span style="color:#66d9ef">print</span>(tabulate(corr_matrix, headers<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;keys&#39;</span>, tablefmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pipe&#39;</span>))
</code></pre></div><pre><code>|       |        CDD |        CWD |      Prcp1 |       SDII |       sum |      mean |            |
|:------|-----------:|-----------:|-----------:|-----------:|----------:|----------:|-----------:|
| CDD   |  1         | -0.288579  | -0.687758  |  0.0253577 | -0.480416 | -0.481019 |  0.0251715 |
| CWD   | -0.288579  |  1         |  0.631665  | -0.0400715 |  0.41894  |  0.417954 | -0.0396542 |
| Prcp1 | -0.687758  |  0.631665  |  1         | -0.0645136 |  0.661685 |  0.663935 | -0.0645538 |
| SDII  |  0.0253577 | -0.0400715 | -0.0645136 |  1         |  0.659944 |  0.661113 |  0.999642  |
| sum   | -0.480416  |  0.41894   |  0.661685  |  0.659944  |  1        |  0.997694 |  0.660287  |
| mean  | -0.481019  |  0.417954  |  0.663935  |  0.661113  |  0.997694 |  1        |  0.661422  |
|       |  0.0251715 | -0.0396542 | -0.0645538 |  0.999642  |  0.660287 |  0.661422 |  1         |
</code></pre>
<p>Nous pouvons appeler la fonction <!-- raw HTML omitted --> .heatmap () <!-- raw HTML omitted --> pour visualiser notre matrice de corrélation et ainsi faciliter nos interprétations.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, (ax) <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">6</span>))
hm <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>heatmap(corr_matrix, 
                 ax<span style="color:#f92672">=</span>ax,           <span style="color:#75715e"># Axes in which to draw the plot, otherwise use the currently-active Axes.</span>
                 cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;coolwarm&#34;</span>, <span style="color:#75715e"># Color Map.</span>
                 <span style="color:#75715e">#square=True,    # If True, set the Axes aspect to “equal” so each cell will be square-shaped.</span>
                 annot<span style="color:#f92672">=</span>True, 
                 fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.2f&#39;</span>,       <span style="color:#75715e"># String formatting code to use when adding annotations.</span>
                 <span style="color:#75715e">#annot_kws={&#34;size&#34;: 14},</span>
                 linewidths<span style="color:#f92672">=.</span><span style="color:#ae81ff">05</span>)

fig<span style="color:#f92672">.</span>subplots_adjust(top<span style="color:#f92672">=</span><span style="color:#ae81ff">0.93</span>)
fig<span style="color:#f92672">.</span>suptitle(<span style="color:#e6db74">&#39;Correlation Matrix: Precipitation Indices Montreal Station&#39;</span>, 
              fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>, 
              fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/img/formation/prec5.png" alt="image0"></p>
<h3 id="bonus-ajoutez-des-indices-de-corrélation-avec-la-bibliothèque-scipy">Bonus: ajoutez des indices de corrélation avec la bibliothèque scipy</h3>
<p>Le module <!-- raw HTML omitted --> stats <!-- raw HTML omitted --> de la <!-- raw HTML omitted --> bibliothèque Scipy <!-- raw HTML omitted --> possède de nombreuses fonctions statistiques.
<a href="https://docs.scipy.org/doc/scipy/reference/stats.html">https://docs.scipy.org/doc/scipy/reference/stats.html</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">corr_pearson</span>(x, y, <span style="color:#f92672">**</span>kws):
    r, p <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>pearsonr(x, y)
    p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.05</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.01</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;**&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.001</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;***&#39;</span>
   <span style="color:#75715e"># r, _ = stats.spearmanr(x, y)</span>
    ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>gca()   
    pos <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>, <span style="color:#f92672">.</span><span style="color:#ae81ff">9</span>) 
    color2<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>                                                                   
    ax<span style="color:#f92672">.</span>annotate(<span style="color:#e6db74">&#34;Pearson = {:.2f}&#34;</span><span style="color:#f92672">.</span>format(r) <span style="color:#f92672">+</span> p_stars,
                xy<span style="color:#f92672">=</span>pos, xycoords<span style="color:#f92672">=</span>ax<span style="color:#f92672">.</span>transAxes, color<span style="color:#f92672">=</span>color2, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)
    

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">corr_spearman</span>(x, y, <span style="color:#f92672">**</span>kws):
    r, p <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>spearmanr(x, y)
    p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.05</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.01</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;**&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.001</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;***&#39;</span>
   <span style="color:#75715e"># r, _ = stats.spearmanr(x, y)</span>
    ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>gca()  
    pos <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>, <span style="color:#f92672">.</span><span style="color:#ae81ff">6</span>) 
    color2<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;darkgreen&#39;</span> 
    ax<span style="color:#f92672">.</span>annotate(<span style="color:#e6db74">&#34;Spearman = {:.2f}&#34;</span><span style="color:#f92672">.</span>format(r) <span style="color:#f92672">+</span> p_stars,
                xy<span style="color:#f92672">=</span>pos, xycoords<span style="color:#f92672">=</span>ax<span style="color:#f92672">.</span>transAxes, color<span style="color:#f92672">=</span>color2, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">corr_kendall</span>(x, y, <span style="color:#f92672">**</span>kws):
    r, p <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>kendalltau(x, y)
    p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.05</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.01</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;**&#39;</span>
    <span style="color:#66d9ef">if</span> p <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0.001</span>:
        p_stars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;***&#39;</span>
   <span style="color:#75715e"># r, _ = stats.spearmanr(x, y)</span>
    ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>gca()   
    pos <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>, <span style="color:#f92672">.</span><span style="color:#ae81ff">3</span>) 
    color2<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;darkorange&#39;</span> 
    ax<span style="color:#f92672">.</span>annotate(<span style="color:#e6db74">&#34;Kendall = {:.2f}&#34;</span><span style="color:#f92672">.</span>format(r) <span style="color:#f92672">+</span> p_stars,
                xy<span style="color:#f92672">=</span>pos, xycoords<span style="color:#f92672">=</span>ax<span style="color:#f92672">.</span>transAxes, color<span style="color:#f92672">=</span>color2, fontweight<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bold&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_precipitation<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">indice_month<span style="color:#f92672">=</span>indice_precipitation[[<span style="color:#e6db74">&#34;CWD&#34;</span>, <span style="color:#e6db74">&#34;SDII&#34;</span>, <span style="color:#e6db74">&#34;sum&#34;</span>, <span style="color:#e6db74">&#34;Prcp1&#34;</span>]]<span style="color:#f92672">.</span>loc[(indice_precipitation[<span style="color:#e6db74">&#34;month&#34;</span>]<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;Jan&#34;</span>)]
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> scipy <span style="color:#f92672">import</span> stats
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns; sns<span style="color:#f92672">.</span>set()

g <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>PairGrid(indice_month[[<span style="color:#e6db74">&#34;CWD&#34;</span>, <span style="color:#e6db74">&#34;SDII&#34;</span>, <span style="color:#e6db74">&#34;sum&#34;</span>, <span style="color:#e6db74">&#34;Prcp1&#34;</span>]]) 

g<span style="color:#f92672">.</span>map_upper(corr_pearson) 
g<span style="color:#f92672">.</span>map_upper(corr_spearman) 
g<span style="color:#f92672">.</span>map_upper(corr_kendall) 
g<span style="color:#f92672">.</span>map_lower(sns<span style="color:#f92672">.</span>regplot) 
g<span style="color:#f92672">.</span>map_diag(plt<span style="color:#f92672">.</span>hist) 
g<span style="color:#f92672">.</span>set(alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/img/formation/prec6.png" alt="image0"></p>

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/formation_python/project1-eccc_temperature/" rel="next">9.1- Projet sur les données de températures ECCC</a>
  </div>
  
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on May 5, 2019</p>

          





  
  

<p class="edit-page">
  <a href="https://github.com/gcushen/hugo-academic/edit/master/content/courses%5cFormation_Python%5cProject2-ECCC_Precipitation.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          

        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.bcfae8267aba63cc55af53a503896bd9.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
